---
complexity_score: 40.5
converted_at: '2025-08-13T06:59:17.434783Z'
file_type: html
format: html
image_processing_enhanced: true
images_extracted: 6
images_saved: 3
original_path: 66_22104-LZA7016017_1Uen.GN33B.html
pictures_extracted: 6
processing_method: docling_multimodal
quality_score: 9.0
source_file: 66_22104-LZA7016017_1Uen.GN33B.html
source_zip: en_lzn7931071_r38f.zip
tables_extracted: 63
zip_image_types:
- .svg
- .png
- .gif
- .jpg
- .bmp
zip_images_total: 2796
---

# 

NR Automated Neighbor Relations

Contents

![Image](../images/66_22104-LZA7016017_1Uen.GN33B/additional_3_CP.png)

![Image](../images/66_22104-LZA7016017_1Uen.GN33B/additional_3_CP.png)

- Overview
- Dependencies
- Feature Operation
    - Lightweight Neighbor Cell Relation Object Handling
        - Adding Lightweight Neighbor Cell Relation Objects
        - Removing Lightweight Neighbor Cell Relation Objects
        - Displaying Lightweight Neighbor Cell Relation Objects
        - Manual Promotion of Lightweight Neighbor Cell Relation Objects
        - Automatic Promotion of Lightweight Neighbor Cell Relation Objects
        - Automatic Demotion of Lightweight Neighbor Cell Relation Objects
    - Automatic Creation of Neighbor Relations in EN-DC Deployment
        - X2 TNL Address Discovery Procedure
        - Retrieval of NR Cell Information through EN-DC Configuration Update
        - NR Automated Neighbor Relations for NR Mobility for EN-DC
        - ANR-Specific Thresholds in EN-DC Deployment
    - Automatic Creation of Neighbor Relations in the NR Standalone Deployment
        - A3 Intra-Frequency Measurement Triggered ANR
        - A5 Inter-Frequency Measurement Triggered ANR
        - NCGI Measurement Report Handling
        - Automatic Creation of ExternalGNBCUCPFunction and TermPointToGNodeB MOs
        - Blocking Xn Connections
        - Removal of NR Neighbor Objects
        - Recovery of Lost Xn-C Connection
        - Automatic Creation of Lightweight EUtranCellRelation Objects based on ECGI Measurement
        - ANR-Specific Thresholds in NR Standalone Deployment
        - Automatic Removal of EUtranFrequency and EUtranFreqRelation MO Instances
        - PLMN-Specific gNodeB ID Length Support
- Network Impact
- Parameters
- Performance
- Activate Non-License-Controlled Features
- Engineering Guidelines
    - Change Global gNodeB ID
    - Configure Automatic Creation of Neighbor Relations for Service-Based IRAT Mobility
    - Configuring the Xn Blocklist
    - Configuring PLMN-Level Xn Blocklist Using ENM Bulk Configuration
    - Configure Support for PLMN-Specific gNodeB ID Lengths
- Appendix: Feature Change History
    - Appendix: 20.Q4: Retrieval of NR Cell Information through EN-DC Configuration Update
    - Appendix: 21.Q2: NR Automated Neighbor Relations for Intra-Frequency NR Mobility for EN-DC
    - Appendix: 21.Q2: NR Automated Neighbor Relations for Intra-Frequency NR Mobility for NR SA
    - Appendix: 21.Q2: Automatic Xn Setup and IP Address Retrieval
    - Appendix: 21.Q2: NR Automated Neighbor Relations for Inter-Frequency NR Mobility for NR SA
    - Appendix: 21.Q3: Automatic Removal of System-Created ExternalGNBCUCPFunction MO and Recovery Handling of Lost Xn-C Connection
    - Appendix: 21.Q3: Support for Automated Neighbor Relations for Inter-Frequency NR Mobility for EN-DC
    - Appendix: 21.Q4: EN-DC ANR Support for NR Cells Used in ESS with No SIB1
    - Appendix: 22.Q1: ANR for Coverage-Based IRAT Mobility
    - Appendix: 22.Q2: ANR for Service-Based IRAT Mobility
    - Appendix: 22.Q2: ANR Enhancement with MO Actions and Cell ID Change Handling
    - Appendix: 22.Q2: Automatic Xn Setup Improvements
    - Appendix: 22.Q3: ANR-Specific Thresholds to Create Neighbor Relation
    - Appendix: 23.Q3: Automatic Promotion and Demotion of Neighbor Cell Relation Objects
    - Appendix: 23.Q2: Automatic EN-DC X2 Setup Using X2 TNL Address Discovery to gNodeB with MORAN Configuration
    - Appendix: 24.Q1.0: ANR-Specific Threshold for Creating LTE-to-NR Neighbor Cell Relations
    - Appendix: 24.Q2.0: Dynamic Handling of NR Frequency Relations
    - Appendix: 25.Q1.0: Support for gNodeB Blocklist in gNodeB
    - Appendix: 25.Q2.0: PLMN-Specific gNodeB ID Length Support for NR Automated Neighbor Relations in NR Standalone

# 1 NR Automated Neighbor Relations Overview

The

feature enables the automatic creation of neighbor relations both in the EN-DC and the NR

Standalone deployment modes.

| Feature Name           | NR Automated Neighbor Relations                         |
|------------------------|---------------------------------------------------------|
| Feature Identity       | FAJ 121 5218                                            |
| Value Package Name     | NR Base Package                                         |
| Value Package Identity | FAJ 801 4002                                            |
| Node Type              | Baseband Radio Node                                     |
| Access Type            | NR                                                      |
| Licensing              | Non-license-controlled feature. No license is required. |

Summary

The NR Automated Neighbor Relations feature minimizes the need for manual configuration of

neighbor cell relations and optimization of mobility functions. This feature is

supported by Low-Band and Mid-Band.

The NR Automated Neighbor Relations feature has the following benefits:

- Automatically finds and creates NR-to-NR cell relations in the gNodeB when the UE reports an unknown PCI detected in the A3 or A5 measurement report for NR mobility.
- Automatically finds and creates NR-to-LTE cell relations in the gNodeB when the UE reports an unknown PCI detected in the B2 or B1 measurement report for IRAT mobility.
- Automatically sets up EN-DC X2 connections for unknown gNodeB by using X2 TNL Address Discovery procedure.
- Automatically prevents the setup of Xn connection to gNodeBs that are on the gNodeB blocklist
- Automatically removes NR neighbor objects.
- Automatically removes E-UTRAN neighbor objects.

Additional Information

More information about this feature and related topics can be found in the following

documentation:

- 3GPP TS 38.331; NR; Radio Resource Control (RRC); Protocol specification
- 3GPP TS 38.473; NG-RAN; F1 Application Protocol (F1AP)
- 3GPP TS 38.423; NG-RAN; Xn Application Protocol (XnAP)
- 3GPP TS 36.423; LTE; Evolved Universal Terrestrial Radio Access Network (E-UTRAN); X2 Application Protocol (X2AP)

# 2 Dependencies of NR Automated Neighbor Relations

The feature is related to other features, allowing neighbor cell creation and SIB1

transmission, and limiting handover.

Table 1   Feature Dependencies

![Image](../images/66_22104-LZA7016017_1Uen.GN33B/additional_3_CP.png)

![Image](../images/66_22104-LZA7016017_1Uen.GN33B/additional_3_CP.png)

![Image](../images/66_22104-LZA7016017_1Uen.GN33B/additional_3_CP.png)

![Image](../images/66_22104-LZA7016017_1Uen.GN33B/additional_3_CP.png)

(1)

Setting the NRCellDU.secondaryCellOnly

attribute to false does not activate the NR

Standalone feature if the gNodeB is configured in the EN-DC

deployment.

Hardware

No limitations.

Limitations

- The feature does not support the Inter-MME X2 TNL Address Discovery procedure.
- The feature supports up to nine different Configured TAC on the gNodeB.
- Automated NR-to-NR cell relations are supported on High-Band if NR cell relations in the eNodeB are created on High-Band by the Automated Neighbor Relations feature or by the operator.
- NCGI or ECGI measurement procedure is not supported towards a cell on High-Band.
- The feature assumes that the gNodeB ID length of a specific PLMN is the same in the same network for the automated creation of NR-to-NR neighbor relations. The current feature does not support different gNodeB ID lengths in a specific PLMN. If the gNodeB ID length is configured for a specific PLMN in the AnrPLMNTable MO, the AnrPLMNTable.gNBIdLength is used by the source gNodeB to extract the ID of a neighbor gNodeB from the NCGI measurement report and set the value of the AnrPLMNTable.gNBIdLength attribute to the length of the neighbor gNodeB. Otherwise, the GNBCUCPFunction.gNBIdLength attribute is used by the source gNodeB to extract the ID of a neighbor gNodeB from the NCGI measurement report and set the value of the GNBCUCPFunction.gNBId attribute. If a lightweight NRCellRelation object referring to an orphan lightweight ExternalNRCellCU object is promoted, the value of the ExternalGNBCUCPFunction.gNBIdLength attribute is set to the value of the GNBCUCPFunction.gNBIdLength or the AnrPLMNTable.gNBIdLength attribute. This is used by the gNodeB ID length when a lightweight NRCellRelation is created. If two neighbor nodes have different gNodeB IDs for the same PLMN, mobility KPIs can be degraded because of the incorrect RAN node ID.
- If the ExternalGNBCUCPFunction MO is created through automatic promotion, the ExternalNRCellCU.primaryPLMNId attribute is used to find the parent ExternalGNBCUCPFunction MO. In the case of MOCN or MORAN cells, it is possible that an incorrect parent MO is found. This is because the PLMN that constitutes the Global RAN Node ID and the PLMN that constitutes the NCGI can be different. After establishing an Xn connection, the correct parent MO can be found.
- The feature does not support maintaining the NR TAC of neighbor cells configured with NR Standalone deployment through the EN-DC X2 SETUP REQUEST or the EN-DC CONFIGURATION UPDATE messages over the X2 interface in the following cases: A cell configured with NR Standalone deployment is changed to EN-DC deployment. An NR Standalone deployment operates normally and then it stops broadcasting the NR TAC in the SIB1 message. Handover can be triggered towards EN-DC neighbor cells and cells with disturbed NR Standalone deployment.Note: Handover initiated towards target NR cell with incorrect NR TAC information fails.
- If there is no NR TAC in the received NCGI measurement, it can be inferred that the neighbor NR Cell cannot support NR Standalone deployment. In this case, the feature does not support keeping the NR TAC of existing neighbor NR cells with NR Standalone deployment up to date through NCGI measurements.Note: Handover initiated towards target NR cell with incorrect NR TAC information fails.
- If the feature works with RAN Compute group 5a, the number of the following MOs can be limited for memory optimization: EUtranCellRelation EUtranFreqRelation ExternalEUtranCell ExternalNRCellCU NRCellRelation NRFreqRelation In this case, the limited number of MO creations might affect KPIs related to handover success rate if external cell relations cannot be created properly. The pmNeighborObjFootprint PM counters of the corresponding MOs indicate the current level of neighbor object creations for cell relations and external cells in relations to the system limit of the neighbor objects.

Network Requirements

The following capabilities are required for UEs:

- EN-DC-capable UE for ANR functionality on EN-DC deployment
- Reading and reporting NCGI of NR cells, using long DRX cycle
- Reading and reporting ECGI of LTE cells, using long DRX cycle.

# 3 Feature Operation of NR Automated Neighbor Relations

This feature enables the automatic management of neighbor objects in EN-DC and NR

Standalone deployments.

Objects created by the NR Automated Neighbor Relations feature are categorized as

follows:

| MOCName MO                 |    | Instance of Managed Object Class (MOC) (for example, NRCellRelation MO)                                                                                                                                                           |
|----------------------------|----|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                            |    |                                                                                                                                                                                                                                   |
| Lightweight MOCName object |    | The neighbor objects created by ANR in the internal persistent memory, which                         are not visible to the operator unlike regular MOs (for example.,                         lightweight NRCellRelation object) |
|                            |    |                                                                                                                                                                                                                                   |
| MOCName objects            |    | Refers to both the MO and Lightweight object (for example, NRCellRelation                         objects)                                                                                                                        |

The following cell relation types are possible in EN-DC and NR Standalone

deployments:

| LTE-to-NR   |    | LTE-to-NR cell relations can be created automatically based on the NCGI                         measurement received from the UE.                                                                                                                                                                                           |
|-------------|----|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|             |    |                                                                                                                                                                                                                                                                                                                             |
| NR-to-NR    |    | NR-to-NR cell relations can be created automatically in NR Standalone                         deployments based on the NCGI measurement report received from the UE.  This feature can also create NR-to-NR cell relations, based on the NR                             Neighbor Information IE propagated from the eNodeB. |
|             |    |                                                                                                                                                                                                                                                                                                                             |
| NR-to-LTE   |    | NR-to-LTE cell relations can be created automatically in NR Standalone                         deployments based on the ECGI measurement report received from the UE.                                                                                                                                                       |

## 3.1 Lightweight Neighbor Cell Relation Object Handling

Lightweight neighbor cell relation objects represent MO instances.

The following lightweight neighbor cell relation objects exist:

- ExternalNRCellCU
- ExternalEUtranCell
- NRCellRelation
- EUtranCellRelation
- ExternalBroadcastPLMNInfo

For more information on lightweight neighbor cell relation object handling in EN-DC, see

Automatic Creation of Neighbor Relations in EN-DC Deployment.

Related concepts

Feature Operation of NR Automated Neighbor Relations

### 3.1.1 Adding Lightweight Neighbor Cell Relation Objects

Automatic creation of lightweight neighbor cell relation objects starts when a

measurement report containing the PCI of an unknown LTE or NR cell is processed.

If the preconditions for an NCGI or an ECGI measurement are met, the gNodeB instructs the

UE to start the NCGI or the ECGI measurement. These NCGI or ECGI measurements are then

used to create lightweight neighbor cell relation objects.

If the PLMN of the received NCGI is configured in

the AnrPLMNTable MO instance, the configured gNodeB ID length is

used to create lightweight neighbor cell relation objects. Otherwise, the

GNBCUCPFunction.gNBIdLength attribute is used to create

lightweight neighbor cell relation objects.

If the preconditions are not met,

the measurement report is ignored and no lightweight

objects are created.

If there are two or more target cells with the same PCI on the same frequency, only one

lightweight NRCellRelation object is created.

If a lightweight NRCellRelation object is created,

and there are no corresponding external cell MO instances, the following lightweight

objects are created:

- ExternalBroadcastPLMNInfo
- ExternalNRCellCU

If a lightweight EUtranCellRelation object is

created, and there is no corresponding external cell MO instance, a lightweight

ExternalEUtranCell object is created.

The

AnrFunction.lwCellRelationRatio attribute can be used to monitor

if the number of lightweight neighbor cell relations reaches the maximum number of

lightweight neighbor cell relations. If the value of the

AnrFunction.lwCellRelationRatio attribute reaches

100%, which means that the maximum number of lightweight neighbor

cell relations is reached, the automatic creation of lightweight neighbor cell relation

objects is blocked.

Related concepts

Lightweight Neighbor Cell Relation Object Handling

### 3.1.2 Removing Lightweight Neighbor Cell Relation Objects

The NR Automated Neighbor Relations feature automatically removes unused lightweight

neighbor cell relation objects if the time set in the AnrFunction.removeNrelTime attribute

elapses.

The NR Automated Neighbor Relations feature automatically

removes all lightweight neighbor cell relation objects if the following conditions are

met:

- The value of the AnrFunction.lwCellRelationRatio attribute reaches 100%, which means that the maximum number of lightweight neighbor cell relations is reached.
- The value of the AnrFunctionNRUeCfg.offsetAdjustAnrRsrpThreshold attribute is not 0.

Related concepts

Lightweight Neighbor Cell Relation Object Handling

ANR-Specific Thresholds in EN-DC Deployment

ANR-Specific Thresholds in NR Standalone Deployment

### 3.1.3 Displaying Lightweight Neighbor Cell Relation Objects

The NRCellCU.displayNRCellRelation MO action can be used to list

lightweight NR cell neighbor relations based on user input.

The NRCellCU.displayEUtranCellRelation MO action can be used to list

lightweight E-UTRAN neighbor cell relations based on user input.

Related concepts

Lightweight Neighbor Cell Relation Object Handling

### 3.1.4 Manual Promotion of Lightweight Neighbor Cell Relation Objects

The NRCellCU.promoteLwEUtranCellRelation MO attribute can be used to

promote a lightweight EUtranCellRelation object to a visible MO.

Based on the user input, the lightweight EUtranCellRelation object

is promoted to an EUTranCellRelation MO instance with the existing

RDN.

The NRCellCU.promoteLwNRCellRelation MO attribute can be used to

promote a lightweight NRCellRelation object to a visible MO. Based

on the user input, the lightweight NRCellRelation object is

promoted to an NRCellRelation MO instance.

The newly promoted MO instances have the same RDN as the lightweight neighbor cell

relation object that they were promoted from.

If a lightweight NRCellRelation object is manually promoted with an

incorrect PLMN ID input, the ExternalNRCell MO instance can be

created under an incorrect parent ExternalGNBCUCPFunction MO.

If the ExternalNRCellCU MO instance is created under the wrong parent

MO during manual promotion, it is deleted and created again under the correct parent MO

along with the related NRCellRelation and

ExternalBroadcastPLMNInfo MO instances by the Xn Setup or NG-RAN

Configuration Update procedures. Mobility attempts to the cell can fail because of the

short absence of the cell relation object during recreation.

Related concepts

Lightweight Neighbor Cell Relation Object Handling

Automatic Demotion of Lightweight Neighbor Cell Relation Objects

### 3.1.5 Automatic Promotion of Lightweight Neighbor Cell Relation Objects

The automatic promotion of lightweight neighbor cell relation objects can be configured

using the AnrFunction.promoteCellRelMobAttThresh attribute. If the

attribute is empty, automatic promotion is disabled.

If a lightweight EUtranCellRelation object is promoted to an MO

instance, and there is no corresponding ExternalEUtranCell MO

instance, the lightweight ExternalEUtranCell object is also

promoted to an MO instance with the existing RDN.

If a lightweight NRCellRelation object is promoted to an MO

instance, and there is no corresponding ExternalNRCellCU MO instance,

the following lightweight objects are also promoted to MO instances with the existing

RDN:

- ExternalNRCellCU
- ExternalBroadcastPLMNInfo

Automatic promotion is based on the average number of mobility attempts to a relation in

a day, considering both successful and unsuccessful attempts. If the average number of

mobility attempts is larger than or equal to the value of the

AnrFunction.promoteCellRelMobAttThresh attribute, the lightweight

neighbor cell relation object is automatically promoted.

To avoid problems caused by a high number of visible cell relation MOs, the

GNBCUCPFunction.cellRelationMOThresh attribute can be used to set

the maximum number of NRCellRelation and

EUtranCellRelation MO instances under one

GNBCUCPFunction MO.

Related concepts

Lightweight Neighbor Cell Relation Object Handling

### 3.1.6 Automatic Demotion of Lightweight Neighbor Cell Relation Objects

A high number of neighbor cell relation MOs can have a negative impact on the network

elements, such as long restart times and memory errors. Keeping the number of neighbor

cell relation MOs low can help to avoid these issues. This is done through the automatic

demotion of unused neighbor cell relation MOs to lightweight neighbor cell relation

objects.

For a relation object to be considered for demotion, it has to have all attributes set to

the default values, except for the NRCellRelation.isRemoveAllowed

attribute, which has to be set to true.

Related concepts

Lightweight Neighbor Cell Relation Object Handling

#### 3.1.6.1 Threshold-Based Automatic Demotion

Threshold-based automatic demotion can be configured using the

AnrFunction.demoteCellRelMobAttThresh attribute. The function

periodically checks the average number of mobility attempts in the last seven days, and

if it is equal to or lower than the configured threshold value, automatic demotion is

triggered. Since the function uses a seven day average, demotions only happen seven days

after a node restart or the creation of

the

neighbor cell relation

MO

object.

If the AnrFunction.demoteCellRelMobAttThresh attribute is empty,

threshold-based automatic demotion is disabled. To be demoted, a cell relation MO has to

be a candidate for demotion. An MO can be a candidate for demotion if the related

attributes are set to the default values, except for the

EUtranCellRelation.isRemoveAllowed or the

NRCellRelation.isRemoveAllowed attribute, which must be set to

true.

#### 3.1.6.2 Ranking-Based Automatic Demotion

For ranking-based automatic demotion, the cell relation MOs are ranked based on the

average mobility attempts at least 48 hours after the creation of the relation object.

The MO with fewer average mobility attempts will receive the lower rank. If two cell

relation MOs have the same average, the one with the latest mobility attempt gets the

higher rank.

Ranking-based automatic demotion can be triggered by the following conditions:

- Automatic promotion is triggered, but cannot proceed, because the threshold configured in the GNBCUCPFunction.cellRelationMOThresh attribute or the maximum number of cell relation MOs under the NrCellCU MO is reached. A cell relation MO with a lower ranking is demoted, unless no MO with a lower ranking can be found, in this case no automatic demotion is performed.
- Every hour, if the number of cell relations is higher than the threshold configured in the GNBCUCPFunction.cellRelationMOThresh attribute. MOs are demoted until the number of MOs is no longer higher than the threshold.

To be demoted, a cell relation MO has to be a candidate for demotion. An MO can be a

candidate for demotion if the related attributes are set to the default values, except

for the EUtranCellRelation.isRemoveAllowed or the

NRCellRelation.isRemoveAllowed attribute, which must be set to

true.

## 3.2 Automatic Creation of Neighbor Relations in EN-DC Deployment

The feature sets up EN-DC X2 connection by using X2 TNL Address Discovery

procedure.

The setup of the X2 connection for an unknown gNodeB proceeds by using IP address lookup

through the MME.

Figure 1 shows the operation of the feature.

Figure 1   Sequence of Automatic Creation of Neighbor Relations in EN-DC Deployment

LTE-to-NR cell relations are automatically created in an EN-DC deployment according to

the following sequence:

1. The UE sends a B1 measurement report to the Master Node, containing an NR cell hosted by an unknown gNodeB. This gNodeB is considered to be a potential Secondary Node after EN-DC setup. The B1 measurement report can contain an NR cell that is in an ESS cell pair with an LTE cell.
2. The Automated Neighbor Relations feature checks if the reported radio link quality from the NR cell found in the B1 measurement report is equal to or greater than the ANR-specific threshold configured in the eNodeB. For more information, see Automated Neighbor Relations.
3. If all the preconditions of starting an NCGI measurement are fulfilled and no instance of the GUtranCellRelation MO exists to the found NR cell, the Master Node orders the UE to perform an NCGI measurement. The NCGI measurement report on the NR cell in an ESS cell pair can be returned by the UE without SIB1 in the NR cell. For more information on the preconditions of starting an NCGI measurement, see Automated Neighbor Relations.
4. Based on the received NCGI measurement report, the Master Node creates the following LTE-to-NR neighbor objects to the found cell: ExternalGNodeBFunction ExternalGUtranCell GUtranCellRelation TermPointToGNB
5. The Master Node initiates the X2 TNL address discovery for the unknown target Secondary Node. This is performed through the S1 interface. Note: To support the X2 TNL address discovery procedure, the EN-DC X2 Setup procedure must be preconfigured with at least one eNodeB acting as the Master Node.
6. The Master Node receives the X2 TNL Configuration Information IE from the Secondary Node through the MME.
7. The Master Node sets up the EN-DC X2 connection by using the X2 endpoint information received from the Configuration Transfer process in X2 TNL address discovery.

Related Information

Automated Neighbor Relations

### 3.2.1 X2 TNL Address Discovery Procedure

This procedure can start after the neighbor configuration for a new NR cell in an unknown

Secondary Node is created. The source eNodeB initiates the X2 TNL address discovery

procedure to retrieve the IP address of the unknown gNodeB through the

MME.

The ENodeBFunction.endcX2IpAddrViaS1Active attribute must be set to

true on the following nodes:

- Source eNodeB
- Master Node

By setting the ENodeBFunction.endcX2IpAddrViaS1Active attribute to

true, the following functions become available:

- The source eNodeB can initiate the X2 TNL address discovery procedure.
- The Master Node can send the updated list of connected gNodeBs IE to the MME in the following messages: Through the S1AP ENB CONFIGURATION UPDATE message during the setup or release of the EN-DC connection Through the S1AP S1 SETUP REQUEST message during the S1 connection setup

Figure 2   X2 TNL Address Discovery Procedure

Operational Process

1. The EN-DC X2 connection must be manually pre-configured between the Master Node and the Secondary Node. The Secondary Node sends the following information to the Master Node during the EN-DC X2 Setup procedure: The global gNodeB ID The list of served NR cells including the configured TAC and the list of served PLMNs
2. If the ENodeBFunction.endcX2IpAddrViaS1Active attribute is set to true, the Master Node sends the S1AP ENB CONFIGURATION UPDATE message with the received information from the Secondary Node to the MME to update the list of connected gNodeBs IE. If the EN-DC X2 connection is lost or re-established, the Master Node updates the list of connected gNodeBs IE to the MME. When the gNodeB is configured with MORAN, the MME can identify the target gNodeB even if the Automated Neighbor Relations feature creates an inconsistent neighbor configuration for the gNodeB. If the MME identifies the target gNodeB by a combination of any PLMN from the Broadcast PLMNs and the gNodeB ID from the list of connected gNodeBs IE, the ENodeBFunction.separateEnGNbForMoranEnabled attribute must be set to false. If the MME identifies a separate instance for the MORAN configuration of the target gNodeB by a combination of the first PLMN from the Broadcast PLMNs and the gNodeB ID from the list of connected gNodeBs IE, the ENodeBFunction.separateEnGNbForMoranEnabled attribute is set to true.Note: When using Ericsson MME, the ENodeBFunction.separateEnGNbForMoranEnabled attribute must set to false.
3. The source eNodeB finds a new neighbor cell from an NCGI measurement report. The global gNodeB ID sent in the NCGI measurement report identifies a gNodeB hosting a neighbor NR cell. If the ExternalGNodeBFunnction MO instance does not exists for the global gNodeB ID from the NCGI measurement report, the neighbor NR cell is hosted by an unknown gNodeB. Note: When the NCGI measurement report is sent for an NR cell with MORAN configuration, the global gNodeB ID in the NCGI measurement report does not match the actual global gNodeB ID of the hosting gNodeB.
4. If the ENodeBFunction.endcX2IpAddrViaS1Active attribute is set to true, the source eNodeB starts the X2 TNL address discovery procedure for the unknown Secondary Node through the MME to retrieve the IP address of the unknown gNodeB as follows: The source eNodeB sends the S1AP ENB CONFIGURATION TRANSFER message to the MME. The target gNodeB ID is created from the global gNodeB ID from the NCGI measurement report of an unknown cell. The PLMN of the Selected PLMN in the Source eNB-ID IE set by the PLMN for selected IP network. Note: The source eNodeB selects its local SCTP end-point based on the ExternalGNodeBFunction.gNodeBPlmnID attribute. For more information, see Multiple IP Addresses for S1 and X2. The MME sends the S1AP MME CONFIGURATION TRANSFER message to the Master Node that acts as proxy to the target Secondary Node, with the information received from the source eNodeB. The Master Node performs either of the following checks on this unknown gNodeB: The target global gNodeB ID sent in the S1AP MME CONFIGURATION TRANSFER message matches the global gNodeB ID from the ExternalGNodeBFunction MO instance. The gNodeB ID from the target global gNodeB ID is matched with the ExternalGNodeBFunction.gNodeBId attribute and the PLMN of the target global gNodeB ID is matched with the first value of the ExternalGUtranCell.plmnIdList attribute. The target global gNodeB ID is sent in the S1AP MME CONFIGURATION TRANSFER message. If an external node is found based on the matching parameters, the Master Node sends the X2AP EN-DC CONFIGURATION TRANSFER message to the matched target gNodeB. If there is no match, the X2 TNL address discovery procedure fails as the Master Node ignores the S1AP MME CONFIGURATION TRANSFER message.
5. The target gNodeB sends the X2 TNL Configuration Info IE in the X2AP EN-DC CONFIGURATION TRANSFER message to the source eNodeB through the MME with the following information: The global gNodeB ID in the Source en-gNB ID IE received in the X2AP EN-DC CONFIGURATION TRANSFER message. The PLMN of the selected TAI in the Source en-gNB ID IE set by the PLMN of the selected IP network. The X2 TNL Address Info IE containing the selected Local SCTP end-point configured for the PLMN of Selected TAI in the Source eNodeB ID sent in the X2AP X2 EN-DC CONFIUGRATION TRANSFER message. In case of a gNodeB with MORAN configuration, the global gNodeB ID is received in the X2 EN-DC CONFIGURAITON TRANSFER message might be different from the actual global gNodeB ID on the target gNodeB.
6. The source eNodeB starts the EN-DC X2 Setup procedure after receiving the S1AP MME CONFIGURATION TRANSFER message with the IP address of the target gNodeB. If there is no reply from the MME, another connected MME is selected for the retry. Note: The External Link to gNodeB Failure alarm is raised if the ENodeBFunction.endcX2IpAddrViaS1Active attribute is set to false, or if there is no valid IP address for the TermPointToGNodeB MO instance. The source eNodeB corrects the inconsistent neighbor configuration when it receives the X2AP EN-DC X2 SETUP RESPONSE message with the correct global gNodeB ID.
7. The list of the connected gNodeBs IE on the source eNodeB is updated to the MME in the S1AP ENB CONFIGURATION TRANSFER message. This is performed so the MME can find which eNodeB is connected to the specific Secondary Node.

When there is no response to the S1AP ENB CONFIGURATION UPDATE

message, or the S1AP ENB CONFIGURATION UPDATE FAILURE message is

received from the MME, the Master Node executes a shut down and reestablishment with

the MME, except when updating only Secondary Node information.

#### 3.2.1.1 Configured TAC or Selected TAI

The configured TAC or selected TAI is required for the X2 TNL Address Discovery

procedure.

In the pre-configured EN-DC X2 Setup procedure, the configured TAC of the Secondary Node

must be handled as a mandatory IE in the list of connected or disconnected Secondary

Nodes by the S1 interface. The configured TAC is sent from the Secondary Node to the

MME.

In the configuration transfer of the Secondary Node, the Selected TAI of the Secondary

Node must be handled as a mandatory IE in the source Secondary Node ID.

The selected TAI consists of the PLMN and the configured TAC. It is relayed from the

Secondary Node to the MME through the S1 or X2 interface.

The source eNodeB provides the configured TACs of the newly connected Secondary Nodes to

all connected MMEs.

#### 3.2.1.2 No Configured EPS TAC on Secondary Node

If there is no configured EPS TAC on the Secondary Node, the X2 TNL address discovery

procedure fails because the MME does not know which eNodeB is connected to the Secondary

Node.

In this case, the Secondary Node can reuse the TAC of the Master Node, which is received

during EN-DC X2 Setup.

This means that the control plane of the Secondary Node includes the TAC of the Master

Node as configured TAC in the EN-DC X2 Setup Response or the EN-DC

Configuration Transfer messages.

#### 3.2.1.3 Update Broadcast PLMNs

The broadcasting of Secondary Node PLMNs are relayed to the MME. The PLMNs are configured

with the NRCellDU.pLMNIdList attribute.

Updating the PLMNs has the following way:

1. The control plane of the Secondary Node receives the value of the NRCellDU.pLMNIdList attribute which is included in the F1 Setup Request or the gNB-DU Configuration Update messages.
2. The control plane of the Secondary Node updates the value of NRCellDU.pLMNIdList attribute with the value received by the F1 Setup Request or the gNB-DU Configuration Update messages. The values are also updated to the values of the NRCellCU.pLMNIdList attribute.
3. The value of the NRCellCU.pLMNIdList attribute is included in the EN-DC X2 Setup Response at the EN-DC X2 Setup procedure or in the EN-DC Configuration Update message.

#### 3.2.1.4 X2 TNL Address Discovery Procedure for Secondary Node in EN-DC

Xn interface is created automatically for the Secondary Node in EN-DC after the

AnrFunctionNR.anrAutoCreateXnForEndc attribute is set to

true.

To enable automatic Xn setup for the Secondary Node in EN-DC, the newAnrFunctionNR.anrAutoCreateXnForEndc attribute is introduced. If set to

true, Xn interface is created for all

NRCellRelation objects to an ExternalNRCellCU

MO that has a reference from an ExternalEUtranCell MO.

Figure 3   X2 TNL Address Discovery Procedure

The process has the following steps:

1. X2 connection between gNodeB 2 and Master Node is established.
2. X2 connection between gNodeB 1 and Master Node is established.
3. ANR creates lightweight NRCellRelation object on gNodeB 1. For more information, see NR Automated Neighbor Relations for NR Mobility for EN-DC in NR Automated Neighbor Relations.
4. If the AnrFunctionNR.anrAutoCreateXnForEndc attribute is set to true, corresponding ExternalGNBCUCPFunction and TermPointToGNodeB MOs are created. The gNodeB 1 sends X2AP EAB EN-GNB TNL INFORMATION FETCH REQUEST towards the Master Node to receive TNL IP address of the targeted gNodeB 2.
5. The Master Node sends the X2AP EAB EN-GNB TNL INFORMATION FETCH RESPONSE with the X2 TNL address to the gNodeB 1. Note: The Master Node must know the TNL address of the targeted gNodeB.
6. Xn connection between gNodeB 1 and gNodeB 2 is established with the received TNL address information of gNodeB.

With this procedure, Xn link is set up for each lightweight or manually configured

NRCellRelation object.

Related concepts

Lightweight Neighbor Cell Relation Object Handling

### 3.2.2 Retrieval of NR Cell Information through EN-DC Configuration Update

The process of retrieving NR cell information is the following:

1. The Master Node creates the ExternalGUtranCell and GUtranCellRelation MOs for a known gNodeB based on the NCGI measurement.
2. The NR Automated Neighbor Relations feature automatically configures the ExternalGUtranCell MO.
3. The EN-DC Configuration Update procedure is performed with cell assistance information contained in the EN-DC CONFIGURATION UPDATE message sent by the Master Node through the X2 interface.
4. The gNodeB generates a list of the served NR cells and includes it in the EN-DC CONFIGURATION UPDATE ACKNOWLEDGE message.
5. The Master Node updates the ExternalGUtranCell MO accordingly.

#### 3.2.2.1 Exception Handling during the Retrieval of NR Cell Information

##### 3.2.2.1.1 Failed EN-DC Configuration Update

At the reception of the EN-DC CONFIGURATION UPDATE FAILURE message

containing a waiting time, the Master Node does not restart the EN-DC Configuration

Update procedure until the time elapses. After the waiting time elapses, the Master Node

restarts the EN-DC Configuration Update procedure. This is done by resending the

EN-DC CONFIGURATION UPDATE message to the gNodeB with the previous

configuration data.

##### 3.2.2.1.2 The x2RetryTimer Expires without Response from the gNodeB

When the x2RetryTimer expires without response from the gNodeB, the

Master Node attempts to resend the EN-DC CONFIGURATION UPDATE message

with the previous configuration data.

##### 3.2.2.1.3 The Master Node Does Not Receive the List of Served NR Cells

The Master Node can receive the EN-DC CONFIGURATION UPDATE ACKNOWLEDGE

message without a list of the served NR cells in either of the following cases:

- If the gNodeB does not support cell assistance information
- If the requested NR cell does not exist within the gNodeB

In this case, the Master Node does not restart the EN-DC Configuration Update procedure

to the same gNodeB.

If the Master Node fails to receive a proper list of the served NR cells from the gNodeB,

the already created ExternalGUtranCell and

GUtranCellRelation MOs are kept. They are used as neighbor

objects regardless of the result of the EN-DC Configuration Update procedure.

### 3.2.3 NR Automated Neighbor Relations for NR Mobility for EN-DC

This function allows the automatic detection and creation of NR-to-NR cell relations

in the gNodeB based on the NR Neighbour Information IE propagated from the

Master Node to the gNodeB over the X2 interface.

This function is activated on the gNodeB by creating the AnrFunctionNR

MO and setting the AnrFunctionNR.anrEndcX2Enabled attribute to

true.

The NR neighbor cell information can be included in one of the following IEs in the

EN-DC CONFIGURATION UPDATE or in the EN-DC X2 SETUP

REQUEST message:

If the neighbor cell information is transmitted through the EN-DC CONFIGURATION

UPDATE message, it is included in the following IEs:

- Served E-UTRA Cells to Modify
- Served E-UTRA Cells to Add

If the neighbor cell information is transmitted through the EN-DC X2 SETUP

REQUEST message, it is included in the List of Served E-UTRA

Cells IE.

These messages are sent by the Master Node to neighbor gNodeBs over the X2 interface.

Ericsson Master Nodes send NR neighbor cell information in the EN-DC

CONFIGURATION UPDATE message. Master Nodes from other vendors might send NR

neighbor cell information in the EN-DC X2 SETUP REQUEST message. The

NR Neighbour Information IE contained in the EN-DC

CONFIGURATION UPDATE message allows for the automatic detection and creation

of NR-to-NR cell relations in the gNodeBs.

If the NR neighbor cell information changes in the gNodeB, neighbor eNodeBs are informed

of this change through the Served NR Cells To Modify IE in the

EN-DC CONFIGURATION UPDATE message.

The following pieces of NR neighbor cell information are sent over the X2 interface:

- Served E-UTRA Cell Information IE
- NR Neighbour Information IE

This function supports the creation of intra-frequency and inter-frequency

NRCellRelation objects on Low-Band and Mid-Band. High-Band is

also

supported,

if cell relations in the eNodeB are created by the Automated Neighbor Relations feature or by the operator. If

no NRFrequency MO exists that corresponds to the frequency set in the

NR neighbor cell information, a new NRFrequency MO instance is

created.

An lightweight NRCellRelation object is created if the following

conditions apply:

- The function is activated.
- An unknown NR cell is detected in the NR A3 measurement report or NR A5 measurement report for the PSCell change.
- The reported cell matches a known NR cell, which resides under the same LTE PCell. The relevant NR neighbor cell information is sent by the Master Node in the NR Neighbour Information IE in the EN-DC CONFIGURATION UPDATE message or the EN-DC X2 SETUP REQUEST message.

The NR TAC of the NR neighbor cells does not reflect the absence of an optional

5GS-TAC IE in the NR Neighbour Information IE sent

over the X2 interface. It is not guaranteed that all gNodeBs in the network support the

5GS-TAC IE, which is used for NR Standalone deployment only. This

results in maintaining a previously configured NR TAC value.

The NR TAC of NR neighbor cells is not always updated correctly in gNodeBs in the

following cases:

- A cell configured with NR Standalone deployment is manually reconfigured for EN-DC deployment.
- A disturbance in NR Standalone deployment occurs, for example the connection to the core network is lost, and the NR TAC is not broadcast in the SIB1 message.

In these cases, neighbor cells can incorrectly be considered NR Standalone deployment

because of the previously configured NR TAC value. This triggers handover towards them,

which results in handover failure.

Related concepts

Lightweight Neighbor Cell Relation Object Handling

### 3.2.4 ANR-Specific Thresholds in EN-DC Deployment

Configurable ANR-specific thresholds are used in target cell evaluation to prevent

establishing cell relations to target cells that have poor radio link quality.

Figure 4   ANR-Specific Threshold Evaluation in EN-DC Deployment

If the PCI of an unknown cell is found in an A3 measurement report, ANR-specific

thresholds are checked.

The trigger quantity of the received measurement report is retrieved from the

IntraFreqMCCellProfileUeCfg.betterSpCellTriggerQuantity

attribute. The following trigger quantities are supported:

- If the received trigger quantity is RSRP, the value of the AnrFunctionNRUeCfg.anrRsrpThreshold attribute is used as the threshold.
- If the received trigger quantity is RSRQ, the value of the AnrFunctionNRUeCfg.anrRsrqThreshold attribute is used as the threshold.
- If the received trigger quantity is SINR, the value of the AnrFunctionNRUeCfg.anrSinrThreshold attribute is used as the threshold.

If the reported RSRP, RSRQ, or SINR value is higher than or equal to the determined

threshold, the ANR action is allowed. A lightweight NRCellRelation

object is created based on the received PCI to the existing

ExternalNRCellCU MO, and PSCell change is performed.

If the reported RSRP, RSRQ, or SINR value is lower than the determined threshold or the

value is empty, the ANR action is not allowed. The measurement report is ignored and no

lightweight NRCellRelation object is created.

If the feature is deactivated, the legacy behavior is kept. The ANR action is allowed,

and the lightweight NRCellRelation object is created.

ANR-Specific RSRP Threshold Adjustment

The ANR-specific RSRP threshold is adjusted through the value of the

AnrFunctionNRUeCfg.offsetAdjustAnrRsrpThreshold attribute if

the following conditions are met:

- The value of the AnrFunction.lwCellRelationRatio attribute reaches 100%, which means that the maximum number of lightweight neighbor cell relations is reached.
- The value of AnrFunctionNRUeCfg.offsetAdjustAnrRsrpThreshold attribute is not 0.

The value of the AnrFunctionNRUeCfg.adjustedAnrRsrpThreshold

attribute is set to the adjusted ANR-specific RSRP threshold, which is used as the

new measurement threshold for ANR.

If the value of the

AnrFunctionNRUeCfg.offsetAdjustAnrRsrpThreshold attribute is

set to 0 from a non-zero value, the value of the

AnrFunctionNRUeCfg.adjustedAnrRsrpThreshold attribute is

removed.

The threshold adjustment has no impact on the automatic creation of the

ExternalGNBCUCPFunction and the

TermPointToGNodeB MOs.

Related concepts

Lightweight Neighbor Cell Relation Object Handling

## 3.3 Automatic Creation of Neighbor Relations in the NR Standalone Deployment

The feature automatically creates lightweight NRCellRelation

object based on the NCGI measurement report from the UE.

This procedure can start after the UE reports an unknown NR cell in the A3 measurement

report or A5 measurement report. The gNodeB sends requests to the UE to send the NCGI

measurement. Based on the received NCGI measurement report, the gNodeB creates

lightweight NRCellRelation object.

Related concepts

Lightweight Neighbor Cell Relation Object Handling

### 3.3.1 A3 Intra-Frequency Measurement Triggered ANR

When the UE reports an unknown NR cell in the A3 measurement report, the automatic

creation of the lightweight NRCellRelation

objects

is initiated.

Figure 5   Lightweight NRCellRelation  Object Creation for A3

Intra-Frequency Triggered ANR

Process Steps

1. The UE reports an unknown cell in the A3 measurement report to the gNodeB. An NR cell is considered unknown if the PCI or the NRCellRelation object of the target cell is not known by the source cell.
2. The gNodeB retrieves the configured trigger quantity from the IntraFreqMCCellProfileUeCfg.betterSpCellTriggerQuantity attribute.
3. The gNodeB checks if one of the following attributes is configured based on the retrieved trigger quantity: If the retrieved trigger quantity is RSRP, the gNodeB checks if the AnrFunctionNRUeCfg.anrRsrpThreshold attribute is configured. If the retrieved trigger quantity is RSRQ, the gNodeB checks if the AnrFunctionNRUeCfg.anrRsrqThreshold attribute is configured. If the retrieved trigger quantity is SINR, the gNodeB checks if the AnrFunctionNRUeCfg.anrSinrThreshold attribute is configured.
4. If the checked attribute is not configured, the ANR action is allowed and an NCGI measurement is requested, if possible. If it is configured, the gNodeB compares the received RSRP, RSRQ, or SINR value to the threshold.
5. If the received value is higher or equal to the threshold, the ANR action is allowed and an NCGI measurement is requested, if possible. If it is lower or empty, the A3 report is ignored, and no neighbor objects are created.
6. The feature checks the following criteria to ensure that the NCGI measurement is possible: The AnrFunctionNR.anrCgiMeasIntraFreqEnabled attribute is activated. The corresponding NRFrequency MO and NRFreqRelation MO must exist and the NRFreqRelation.anrMeasOn attribute is set to true. The UE is capable of reading and reporting the CGI of NR cells using the long DRX cycle. The NCGI measurement is not ongoing for the UE. Connections with the following bearer types are not established for the related UEs: VoIP PTT MC\_SIGNALING Note: If the NCGI measurement is not possible, the gNodeB ignores the A3 measurement report for an unknown cell.
7. The gNodeB triggers the NCGI measurement for the reported unknown cell.
8. The UE configures the NCGI measurement report and sends it to the gNodeB.
9. Lightweight NRCellRelation objects are created based on the received NCGI measurement.

Related concepts

Lightweight Neighbor Cell Relation Object Handling

### 3.3.2 A5 Inter-Frequency Measurement Triggered ANR

When the UE reports an unknown NR cell in the A5 measurement report, the automatic

creation of lightweight NRCellRelation object is initiated.

Figure 6   Lightweight NRCellRelation Object Creation for A5

Inter-Frequency Triggered ANR

Process Steps

1. The UE reports an unknown cell in the A5 measurement report to the gNodeB. An NR cell is considered unknown if the PCI or the NRCellRelation object of the target cell is not known by the source cell.
2. The feature checks the following criteria to ensure that the NCGI measurement is possible: The AnrFunctionNR.anrCgiMeasInterFreqMode attribute is set to FR1. The corresponding NRFrequency MO and NRFreqRelation MO must exist and the NRFreqRelation.anrMeasOn attribute is set to true. The UE is capable of reading and reporting the CGI of NR cells, using the long DRX cycle. The NCGI measurement is not ongoing for the UE. The Target Cell frequency range is FR1. Connections with the following bearer types are not established for the related UEs: VoIP PTT MC\_SIGNALING Note: If the NCGI measurement is not possible, the gNodeB ignores the A5 measurement report for an unknown cell.
3. The gNodeB triggers NCGI measurement for the reported unknown cell.
4. The UE configures the NCGI measurement report and sends it to the gNodeB.
5. Lightweight NRCellRelation objects are created based on the received NCGI measurement.

Related concepts

Lightweight Neighbor Cell Relation Object Handling

### 3.3.3 NCGI Measurement Report Handling

NCGI Measurement Report Handling is the same for both A3

Intra-Frequency Triggered ANR and A5 Inter-Frequency Triggered ANR. During the

NCGI measurement, the UE acquires the NCGI from SIB1 of the detected cell, and sends it to

the gNodeB.

Timers

The feature uses the following timers during the operation:

| T321 timer   |    | This timer determines how long the UE keeps the NCGI measurement                                 before removing it. When the UE acquires the NCGI or the timer                                 expires, the UE stops the NCGI measurement and initiates reporting                                 to the gNodeB.   |
|--------------|----|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|              |    |                                                                                                                                                                                                                                                                                                                     |
| DRX timer    |    | This timer allows the UE enough time to read SIB1 of the detected                                 neighbor cell. If the timer expires before the NCGI measurement                                 report arrives, the NCGI measurement is considered as failed.                                                     |

Creating and Sending NCGI Measurement Report

Figure 7 shows the operational process of the

NCGI measurement report creation.

Figure 7   Creating and Sending NCGI Measurement Report

Receiving an A3 measurement report or an A5 measurement report for an unknown NR cell

triggers the NCGI measurement. The operational process is the following:

1. The gNodeB sends an RRCReconfiguration message to the UE for the following purposes: NCGI measurement configuration. DRX reconfiguration, so that the UE can acquire SIB1 of the neighbor cell.
2. The UE starts the T321 timer and sends the RRCReconfigurationComplete message to the gNodeB.
3. When the RRCReconfigurationComplete message arrives, the gNodeB starts the DRX timer.
4. The UE initiates reporting to the gNodeB and stops measurement in any of the following cases:
    - The UE acquires the NCGI from SIB1 of the target cell.
    - The UE detects that the requested NR cell is not transmitting SIB1.
    - The T321 timer expires.
5. The UE sends the NCGI measurement report to the gNodeB and stops the T321 timer.
6. When the NCGI measurement report arrives, the gNodeB stops the DRX timer.
7. The gNodeB restores the previous DRX configuration.

Handling NCGI Measurement Report from an EN-DC-Only Cell

The UE can report NCGI measurement in the following cases:

- SIB1 is not broadcast by the cell
- NR TAC is not configured in the cell

In these cases,

the gNodeB considers the reported cell to be considered EN-DC-only and the NCGI

measurement report to be successful. However, neighbor objects are not created

because of the absence of NR cell information. NCGI measurement is not triggered

towards the same considered EN-DC-only cell for all UEs. Information about this

EN-DC-only cell is kept for 24 hours. This is to ensure the information is not lost

if, for example, SIB1 is temporarily unavailable.

Behavior of the gNodeB during NCGI Measurements

The gNodeB rejects incoming NGAP

setup and

modification procedures

when

the UE is connected with the following voice or critical

services:

- IMS VOICE (5QI 1)
- MCPTT VOICE (5QI 65)
- NMCPTT VOICE (5QI 66)
- MCPTT SIGNALLING (5QI 69)

The gNodeB stops the NCGI measurement procedure if one of the following events

occurs:

- The DRX timer expires.
- The gNodeB receives an NCGI measurement report.
- The gNodeB receives a UE Context Release procedure.
- The gNodeB receives an NGAP procedure for adding a voice QoS flow with 5QI set to 1 or a VoNR connection. Connections with the following bearer types are considered to be VoNR: VoIP PTT MC\_SIGNALING

### 3.3.4 Automatic Creation of ExternalGNBCUCPFunction and TermPointToGNodeB MOs

When the ExternalNRCellCU and the

NRCellRelation objects are created, the

ExternalGNBCUCPFunction and the TermPointToGNodeB

MOs are created conditionally as well.

The ExternalGNBCUCPFunction MO is created if all the following

conditions are met:

- The value of the GNBCUCPFunction.xnIpAddrViaNgActive attribute or the AnrFunctionNR.anrAutoCreateXnForEndc attribute is set to true. Note: Setting the GNBCUCPFunction.xnIpAddrViaNgActive attribute to true enables automatic Xn setup for existing neighbor cell relations. Setting the AnrFunctionNR.anrAutoCreateXnForEndc attribute to true enables automatic Xn setup for the Secondary Node in EN-DC.
- No match is found between the following set of parameters: The PLMNIds and gNBIds of the ExternalGNBCUCPFunction MO The PLMNIds and gNBIds contained in the nRCGI parameter of the lightweight ExternalNRCellCU object
- The unknown gNodeB is not included in the Xn blocklist.

Table 2   ExternalGNBCUCPFunction Attribute Setting

| Attribute           | Value                                                                                                                 |
|---------------------|-----------------------------------------------------------------------------------------------------------------------|
| gNBId               | gNBId contained in the nRCGI parameter of the lightweight                                     ExternalNRCellCU object |
| pLMNId              | ExternalNRCellCU.primaryPLMNId                                                                                        |
| isRemoveAllowed     | true                                                                                                                  |
| noRelationTimeStamp | Set to NOW                                                                                                            |

The TermPointToGNodeB MO is created without IP addresses for 5G SA and

SCTP association if all the following conditions are met:

- The value of the GNBCUCPFunction.xnIpAddrViaNgActive attribute is set to true.
- The ExternalNRCellCU.nRTAC or the ExternalBroadcastPLMNInfo.nRTAC is specified.
- Any PLMNId of the ExternalNRCellCU or the ExternalBroadcastPLMNInfo objects belongs to the TermPointToAmf.pLMNIdList MO.
- The gNBId of the TermPointToGNodeB under the ExternalGNBCUCPFunction MO does not match the gNBId contained in the nRCGI parameter of the lightweight ExternalNRCellCU object.
- Any PLMNId entry of the ExternalNRCellCU.pLMNIdList or the ExternalBroadcastPlmnInfo.pLMNIdList attributes is valid in the dedicated Transport Network (TN) configuration for Xn if the default TN configuration is not used.
- The gNodeB is not included in the Xn blocklist.

The Xn setup procedure is automatically initiated after the

TermPointToGNodeB MO is created.

Related concepts

Lightweight Neighbor Cell Relation Object Handling

### 3.3.5 Blocking Xn Connections

The gNodeB blocklist can be used to prevent an Xn connection to selected

gNodeBs.

The gNodeB blocklist can be configured through the

GNBCUCPFunction.blockedGNodeBList attribute.

The selected gNodeBs can be blocked based on PLMN and gNodeB ID. When the blocked gNodeB

ID is set to 1, Xn connections to all gNodeBs with a specific PLMN can

be blocked.

The gNodeB does not attempt the Xn setup procedure with gNodeBs on the gNodeB blocklist

and incoming Xn setup requests from blocklisted gNodeBs are denied. Active Xn

connections are removed once the related gNodeB is added to the blocklist.

The blocklist can also be used to configure if direct packet forwarding is allowed to a

gNodeB on the gNodeB blocklist during the following procedures:

- NGAP-based inter-gNodeB handover
- Inter-gNodeB PSCell change in NR-DC
- Inter-gNodeB PSCell change in EN-DC

Related concepts

Configuring the Xn Blocklist

### 3.3.6 Removal of NR Neighbor Objects

This feature automatically removes neighbor objects.

The following elements are subject to automatic removal:

- Cell relations
- External cells
- External nodes
- Xn connections

Periodically, ANR evaluates which object can be deleted. The first check is executed one

hour after RBS restart. The automatic removal function supported by ANR in gNodeB only

checks the presence of ANRFunction MO and configured unused time such as AnrFunction.removeNrelTime.

#### 3.3.6.1 Removal of NRCellRelation Objects

The NR Automated Neighbor Relations feature automatically removes

NRCellRelation MOs if the

NRCellRelation.isRemoveAllowed attribute is set to

true and they are not used for the time set in the AnrFunction.removeNrelTime attribute.

For the NRCellRelations objects to be in use means that it is asked

for in a mobility evaluation situation. This does not necessarily mean that handover has

been performed successfully to the cell.

#### 3.3.6.2 Removal of ExternalGNBCUCPFunction MOs

The ANR removal function is supported for the unused

ExternalGNBCUCPFunction MOs. When the

ExternalGNBCUCPFunction MO is removed by the ANR removal

function, all of its child objects are removed as well.

These child objects are the following:

- TermPointToGNodeB
- ExternalNRCellCU
- ExternalBroadcastPLMNInfo

The ExternalGNBCUCPFunction MO is considered unused when the following

conditions are met:

- The removed NRCellRelation object is the last one in any cell corresponding to the ExternalGNBCUCPFunction MO, and there is no RibTmRelation MO corresponding to the ExternalGNBCUCPFunction MO.
- The removed RibTmRelation MO is the last to any cell in the ExternalGNBCUCPFunction MO and there is no NRCellRelation object corresponding to the ExternalGNBCUCPFunction MO.

The time when the ExternalGNBCUCPFunction MO becomes unused is stored

in the ExternalGNBCUCPFunction.noRelationTimeStamp attribute. The

ExternalGNBCUCPFunction.noRelationTimeStamp attribute is cleared

in the following cases:

- The created NRCellRelation object refers to any cell in the ExternalGNBCUCPFunction MO.
- The created RibTmRelation MO refers to any cell in the ExternalGNBCUCPFunction MO.

The AnrFunction.removeGnbTime attribute determines how many days after

being considered unused the ExternalGNBCUCPFunction MO is removed.

The ANR removal function removes any ExternalGNBCUCPFunction MOs that

are considered unused and of which the

ExternalGNBCUCPFunction.isRemoveAllowed attribute is set to

true.

If TermPointToGNodeB MO does not exist when there is an incoming Xn

setup request, any ExternalGNBCUCPFunction MO created by the Xn setup

request is created with the ExternalGNBCUCPFunction.isRemoveAllowed

attribute set to true.

### 3.3.7 Recovery of Lost Xn-C Connection

If the ExternalGNBCUCPFunction MO instance is used when the Xn-C

connection is lost, the feature attempts to recover it automatically.

When the Xn-C connection is lost, the NR Automated Neighbor Relations feature attempts to

recover it automatically. This is done by triggering the reestablishment of the Xn-C

connection based on whether the ExternalGNBCUCPFunction MO instance

is considered used. The ExternalGNBCUCPFunction MO

instance is used if any of its relations refer to a child

ExternalNRCellCU MO or the

ExternalGNBCUCPFunction.isRemoveAllowed attribute is set to

false.

### 3.3.8 Automatic Creation of Lightweight EUtranCellRelation Objects based on ECGI Measurement

#### 3.3.8.1 B1 Measurement Triggered ANR

The Service-Based IRAT Mobility function enables the automatic creation of NR to LTE

cell relations in the gNodeB based on the B1 measurement report.

When a connected UE reports an unknown LTE cell in the B1 measurement report, the ECGI

measurement can be triggered for the reported unknown LTE cell if the following

conditions are fulfilled:

- The AnrFunctionEUtran.anrCgiMeasEUtranEnabled attribute is activated on the node level.
- The EUtranFreqRelation.anrMeasOn attribute is set to TRUE.
- The UE is capable of long DRX cycle.
- The UE is capable of ECGI reporting. This is indicated by the eutra-CGI-Reporting value in the MeasAndMobParameters IE.
- ECGI is not configured.
- The UE is not NR-DC connected.
- The AnrFunctionEUtranUeCfg.ecgiDuringEpsFbEnabled attribute is set to TRUE.
- The value of the McfbCellProfileUeCfg.epsFallbackOperation attribute is configured for measurement-based IRAT handover of non-emergency voice calls.

Process Steps

The operational process is the following:

1. UE reports an unknown LTE cell in the B1 measurement report.
2. If the conditions are met, the gNodeB configures the ECGI measurement for the reported unknown cell.
3. The UE configures the ECGI measurement report and sends it to the gNodeB.
4. The gNodeB creates the lightweight EUtranCellRelation object based on the ECGI information from the UE.

The cell relations are removed automatically if they are not used for IRAT mobility

for a configured time.

Figure 8   Lightweight EUtranCellRelation Object Creation for B1

Measurement Triggered ANR

Related concepts

Lightweight Neighbor Cell Relation Object Handling

#### 3.3.8.2 B2 Measurement Triggered ANR

When the UE reports an unknown NR cell in the B2 measurement report, the automatic

creation of the lightweight EUtranCellRelation object is

initiated.

ECGI Triggering and Handling for B2 Support

When a connected UE reports an unknown LTE cell in B2 measurement report, ECGI

measurement for the reported unknown LTE cell can be triggered if the following

conditions are fulfilled:

- The AnrFunctionEUtran.anrCgiMeasEUtranEnabled attribute is activated on the node level.
- The EUtranFreqRelation.anrMeasOn attribute is set to true.
- The UE is capable of long DRX cycle.
- The UE is capable of ECGI reporting. This is indicated by the eutra-CGI-Reporting value in the MeasAndMobParameters IE.
- The UE is not connected to NR-DC.
- The UE is connected without the following voice or critical services: IMS VOICE (5QI 1) MCPTT VOICE (5QI 65) NMCPTT VOICE (5QI 66) MCPTT SIGNALLING (5QI 69)
- There are no ongoing ECGI or NCGI measurements.

Process Steps

1. The UE reports an unknown LTE cell in the B2 measurement report.
2. The feature checks if the conditions are fulfilled and the ECGI measurement is possible.
3. The gNodeB configures the ECGI measurement for the reported unknown cell.
4. The UE configures the ECGI measurement report and sends it to the gNodeB.
5. The gNodeB creates the lightweight EUtranCellRelation object based on the ECGI information from the UE.

Figure 9    Lightweight EUtranCellRelation Object Creation for B2

Measurement Triggered ANR

Related concepts

Lightweight Neighbor Cell Relation Object Handling

#### 3.3.8.3 Removal of EUTRAN Neighbor Objects

This feature automatically removes NR-to-LTE cell relations and corresponding

neighbor objects.

The removal function is based on time-stamping cell relations when the IRAT mobility

evaluation is requested and determined that mobility can be performed.

If

the EUtranCellRelation

MO

is not used for IRAT mobility for a configured time, this cell relation is removed by

ANR.

If the operator does not want specific

EUtranCellRelation

MO

to be

removed,set

the EUtranCellRelation.isRemoveAllowed attribute to

false.

The ExternalENodeBFunction MO becomes unused when no child

ExternalEUtranCell MO is

referenced

by the EUtranCellRelation

MO.

The ExternalENodeBFunction MO is removed together with its child

ExternalEUtranCell

MOs

if the following

are

true for the ExternalENodeBFunction MO:

- It remains unused for a period of time configured by the AnrFunction.removeEnbTime attribute.
- It is allowed to be removed by ANR.

#### 3.3.8.4 ECGI Measurement Report Handling for B1 Measurement

During the ECGI measurement, the UE acquires the ECGI information from the SIB1

message of the detected cell, and sends it to the gNodeB.

Timers

The feature uses the following timers during the operation:

| T321 timer   |    | This timer determines how long the UE keeps the ECGI measurement                                 before removing it. When the UE acquires the ECGI information or the                                 timer expires, the UE stops the ECGI measurement and initiates                                 reporting to the gNodeB. For ECGI measurements, the timer is set to                                 1s.   |
|--------------|----|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|              |    |                                                                                                                                                                                                                                                                                                                                                                                                                |
| DRX timer    |    | This timer allows the UE enough time to read the SIB1 message of the                                 detected neighbor cell. If the timer expires before the ECGI                                 measurement report arrives, the ECGI measurement is considered as                                 failed. For ECGI measurements, the timer is set to 1s.                                                     |

Creating and Sending ECGI Measurement Report

Receiving a B1 measurement report for an unknown PCI cell triggers the ECGI

measurement. The operational process of creating and handling the ECGI measurement

report is the following:

1. The gNodeB sends an RRCReconfiguration message to the UE for the following purposes: ECGI measurement configuration DRX reconfiguration, so that the UE can acquire SIB1 of the neighbor cell
2. When the RRCReconfigurationComplete message arrives, the gNodeB starts the DRX timer.
3. The UE initiates reporting to the gNodeB and stops the measurement in the following cases:
    - The UE acquires the ECGI information from the SIB1 message of the target cell.
4. When the ECGI measurement report arrives, the gNodeB stops the DRX timer.
5. The gNodeB restores the previous DRX configuration.

Behavior of the gNodeB during ECGI Measurements

If ECGI measurement is configured and the

McfbCellProfileUeCfg.epsFbTargetSearchTimer expires, the

timer is restarted.

#### 3.3.8.5 ECGI Measurement Report Handling for B2 Measurement

During the ECGI measurement, the UE acquires the ECGI information from SIB1 message

of the detected cell, and sends it to the gNodeB.

Timers

The feature uses the following timers during the operation:

| T321 timer   |    | This timer determines how long the UE keeps the ECGI measurement                                 before removing it. When the UE acquires the ECGI or the timer                                 expires, the UE stops the ECGI measurement and initiates reporting                                 to the gNodeB. For ECGI measurements, the timer is set to 1 s.   |
|--------------|----|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|              |    |                                                                                                                                                                                                                                                                                                                                                                     |
| DRX timer    |    | This timer allows the UE enough time to read the SIB1 message of the                                 detected neighbor cell. If the timer expires before the ECGI                                 measurement report arrives, the ECGI measurement is considered as                                 failed. For ECGI measurements, the timer is set to 1 s.         |

Creating and Sending ECGI Measurement Report

Receiving a B2 measurement report for an unknown PCI cell triggers the ECGI

measurement. The operational process of creating and handling the ECGI measurement

report is the following:

1. The gNodeB sends an RRCReconfiguration message to the UE for the following purposes: ECGI measurement configuration DRX reconfiguration, so that the UE can acquire SIB1 of the neighbor cell
2. When the RRCReconfigurationComplete message arrives, the gNodeB starts the DRX timer.
3. The UE initiates reporting to the gNodeB and stops the measurement in the following cases:
    - The UE acquires the ECGI information from SIB1 of the target cell.
    - The UE is connected with the following voice or critical services: IMS VOICE (5QI 1) MCPTT VOICE (5QI 65) NMCPTT VOICE (5QI 66) MCPTT SIGNALLING (5QI 69)
4. When the ECGI measurement report arrives, the gNodeB stops the DRX timer.
5. The gNodeB restores the previous DRX configuration.

Behavior of the gNodeB during ECGI Measurements

The gNodeB rejects incoming NGAP procedures except for voice calls.

The gNodeB stops the ECGI measurement procedure if it receives an NGAP procedure for

adding a voice QoS flow with 5QI set to 1.

### 3.3.9 ANR-Specific Thresholds in NR Standalone Deployment

Configurable ANR-specific thresholds are used in target cell evaluation to prevent

establishing cell relations to target cells that have poor radio link quality.

Figure 10   ANR-Specific Threshold Evaluation in NR Standalone Deployment

If the PCI of an unknown cell is found in an A3 measurement report, ANR-specific

thresholds are checked.

The trigger quantity of the received measurement report is retrieved from the

IntraFreqMCCellProfileUeCfg.betterSpCellTriggerQuantity

attribute. The following trigger quantities are supported:

- If the received trigger quantity is RSRP, the value of the AnrFunctionNRUeCfg.anrRsrpThreshold attribute is used as the threshold.
- If the received trigger quantity is RSRQ, the value of the AnrFunctionNRUeCfg.anrRsrqThreshold attribute is used as the threshold.
- If the received trigger quantity is SINR, the value of the AnrFunctionNRUeCfg.anrSinrThreshold attribute is used as the threshold.

If the reported RSRP, RSRQ, or SINR value is higher than or equal to the determined

threshold, the ANR action is allowed. The gNodeB requests a new NCGI measurement from

the UE. Based on this measurement, a lightweight NRCellRelation

object is created.

If the reported RSRP, RSRQ, or SINR value is lower than the determined threshold or the

value is empty, the ANR action is not allowed. The measurement report is ignored and no

lightweight NRCellRelation object is created.

If the feature is deactivated, the legacy behavior is kept. The ANR action is allowed,

and the lightweight NRCellRelation object is created.

ANR-Specific RSRP Threshold Adjustment

The ANR-specific RSRP threshold is adjusted through the value of the

AnrFunctionNRUeCfg.offsetAdjustAnrRsrpThreshold attribute if

the following conditions are met:

- The value of the AnrFunction.lwCellRelationRatio attribute reaches 100%, which means that the maximum number of lightweight neighbor cell relations is reached.
- The value of AnrFunctionNRUeCfg.offsetAdjustAnrRsrpThreshold attribute is not 0.

The value of the AnrFunctionNRUeCfg.adjustedAnrRsrpThreshold

attribute is set to the adjusted ANR-specific RSRP threshold, which is used as the

new measurement threshold for ANR.

If the value of the

AnrFunctionNRUeCfg.offsetAdjustAnrRsrpThreshold attribute is

set to 0 from a non-zero value, the value of the

AnrFunctionNRUeCfg.adjustedAnrRsrpThreshold attribute is

removed.

The threshold adjustment has no impact on the automatic creation of the

ExternalGNBCUCPFunction and the

TermPointToGNodeB MOs.

Related concepts

Lightweight Neighbor Cell Relation Object Handling

### 3.3.10 Automatic Removal of EUtranFrequency and EUtranFreqRelation MO Instances

Unused EUtranFrequency and EUtranFreqRelation

MO instances can be automatically removed.

The EUtranFrequency and EUtranFreqRelation MO

instances configured in band 48 can be automatically removed by setting the

AnrFunction.removeEUtranFreqRelTime attribute to a value other

than 10000.

If automatic removal is activated, the gNodeB checks for removable MO instances every

minute. After a node restart, the first check is performed after 15 minutes.

Automatic Removal of EUtranFrequency MO Instances

An EUtranFrequency MO instance is considered unused if it is not

referenced by any of the following entities:

- Any EUtranFreqRelation MO instance
- Any ExternalEUtranCell MO instance
- Any lightweight ExternalEUtranCell object

An EUtranFrequency MO instance is automatically removed if the

following conditions are met:

- Automatic removal is activated by setting the AnrFunction.removeEUtranFreqRelTime attribute to a value other than 10000.
- The EUtranFrequency MO instance is configured in band 48.
- The EUtranFrequency MO instance exists for longer than 10 minutes. This check is in place so the MO instance is not immediately deleted before any references to it could be configured by the operator.
- The EUtranFrequency MO instance is unused when it is not referenced by any other MO, such as the ExternalEUtranCell MO, the EUtranFreqRelation MO, or the lightweight ExternalEUtranCell object.

Automatic Removal of EUtranFreqRelation MO Instances

An EUtranFreqRelation MO instance is considered unused if it

refers to an EUtranFrequency MO instance that is not referenced

by any ExternalEUtranCell MO instance or a lightweight

ExternalEUtranCell object. An

EUtranFreqRelation MO instance is automatically removed if

the following conditions are met:

- Automatic removal is activated by setting the AnrFunction.removeEUtranFreqRelTime attribute to a value other than 10000.
- The EUtranFreqRelation MO instance refers to an EUtranFrequency MO instance that is configured in band 48.
- The EUtranFreqRelation MO instance is unused for the time period set through the AnrFunction.removeEUtranFreqRelTime attribute.

### 3.3.11 PLMN-Specific gNodeB ID Length Support

It is supported to apply a different gNodeB ID length for each PLMN for the NR

neighbor relation configurations created by the NR Automated Neighbor Relations

feature.

The configuration of PLMN-specific gNodeB ID length is possible with the

AnrPLMNTable MO class and the following attributes:

- AnrPLMNTable.anrPLMNTableId
- AnrPLMNTable.gNBIdLength
- AnrPLMNTable.pLMNIdList

The following attributes must be set to the same value as the PLMN-specific neighbor node

configuration:

- AnrPLMNTable.gNBIdLength
- AnrPLMNTable.pLMNIdList

If the PLMN in the NCGI is configured within the AnrPLMNTable MO

instances, the gNodeB ID length specified in the AnrPLMNTable MO is

applied to the NR neighbor relation configuration created by ANR. If the PLMN in the

NCGI is not configured within the AnrPLMNTable MO instances, the

gNodeB ID length of the source node specified in the

GNBCUCPFunction.gNBIdLength attribute is applied to the NR

neighbor relation configuration created by ANR.

When ANR creates an NR neighbor relation configuration for a received NCGI, the specified

gNodeB ID length for the PLMN is applied to the newly created neighbor relation

configuration.

It is only allowed to configure a single PLMN with an identical gNodeB ID length.

Therefore, configuring the same PLMN with a different gNodeB ID length in any

AnrPLMNTable MO instance is not permitted. Additionally,

configuring the same PLMN with the GNBCUCPFunction.pLMNId attribute

in this MO instance is not permitted.

The operator must remove the existing inconsistent neighbor relation configurations with

an invalid gNodeB ID length manually after configuring the

AnrPLMNTable.gNBIdLength and the

AnrPLMNTable.pLMNIdList attributes. This step must be done for

ANR to configure the NR neighbor relation configuration with the correct gNodeB ID

length. Otherwise, the NR neighbor relation configuration cannot be created, since it is

regarded as a known cell relation.

# 4 Network Impact of NR Automated Neighbor Relations

The feature enables the introduction of a cell without neighbor relation planning and

increases UE performance by assuring the NR neighbor cell is chosen for the UE.

Capacity and Performance

The feature has a positive impact on maintenance. It minimizes the need for the

manual configuration of neighbor relations between an LTE and an NR cell both in the

EN-DC and in the NR Standalone deployment modes. The cells can be introduced without

neighbor relation planning.

The feature has a positive impact on success rate of NR SA IRAT

handover from NR to LTE by increasing the attempt and success rate towards newly

added neighbor cell relations.

The feature also has a positive impact for the performance of

UEs by assuring the best NR neighbor cell is found,

which can be used automatically.

After an Xn connection is removed because of Xn blocklist updates, the number of RRC

Connection Re-establishment attempts might increase.

Interfaces

The feature affects the following interfaces and protocols:

- X2 interface, X2AP protocol: The EN-DC Configuration Transfer message is introduced. The X2AP SGNB ADDITION REQUEST and the X2AP SGNB ADDITION REQUEST ACKNOWLEDGE messages are updated to allow the blocking of direct packet forwarding.
- Uu interface, RRC protocol New IEs introduced in the RRCRECONFIGURATION message is used to configure NCGI measurement to the UE, and receive NCGI information in the measurement report. New IEs are introduced in the UE CAPABILITY INFORMATION message. They indicate if the UE is capable to acquire relevant information by reading the SI messages of the neighbor cell. The acquired information is then reported to the network.
- F1 interface, F1AP protocol New IEs are introduced in the UE CONTEXT MODIFICATION REQUEST message. They deliver information of the DRX configuration for NCGI measurement and indicate the release of the DRX configuration for restoring the previous DRX configuration.
- NG interface, NGAP protocol UPLINK RAN CONFIGURATION TRANSFER, DOWNLINK RAN CONFIGURATION TRANSFER messages are introduced. The NGAP HANDOVER REQUIRED and the NGAP HANDOVER REQUEST ACKNOWLEDGE messages are updated to allow the blocking of direct packet forwarding.
- Xn interface, XnAP protocol The XN SETUP FAILURE message is updated with the misc - O&amp;M intervention cause for cases when Xn setup fails because the target gNodeB is included in the gNodeB blocklist. The following messages are updated to allow the blocking of direct packet forwarding: XNAP S-NODE ADDITION REQUEST XNAP S-NODE ADDITION REQUEST ACKNOWLEDGE XNAP S-NODE CHANGE REQUIRED

Other Network Elements

The AMF must support NGAP version 15.6.0 or later to decode the

UplinkRANConfigurationTransfer message containing the IP address

for that neighbor gNodeB, to which Xn setup is needed.

# 5 Parameters for NR Automated Neighbor Relations

The feature introduces parameters to handle the ANR function.

Table 3   Parameters

| Parameter                                               | Type       | Description          |
|---------------------------------------------------------|------------|----------------------|
| AnrFunction.anrFunctionId                               | Introduced | See MOM description. |
| AnrFunction.demoteCellRelMobAttThresh                   | Introduced | See MOM description. |
| AnrFunction.promoteCellRelMobAttThresh                  | Introduced | See MOM description. |
| AnrFunction.removeEnbTime                               | Introduced | See MOM description. |
| AnrFunction.removeEUtranFreqRelTime                     | Introduced | See MOM description. |
| AnrFunction.removeGnbTime                               | Introduced | See MOM description. |
| AnrFunction.removeNrelTime                              | Introduced | See MOM description. |
| AnrFunctionEUtran.anrCgiMeasEUtranEnabled               | Introduced | See MOM description. |
| AnrFunctionEUtranUeCfg.ecgiDuringEpsFbEnabled           | Introduced | See MOM description. |
| AnrFunctionNR.anrAutoCreateXnForEndc                    | Introduced | See MOM description. |
| AnrFunctionNR.anrCgiMeasInterFreqMode                   | Introduced | See MOM description. |
| AnrFunctionNR.anrCgiMeasIntraFreqEnabled                | Introduced | See MOM description. |
| AnrFunctionNR.anrEndcX2Enabled                          | Introduced | See MOM description. |
| AnrFunctionNR.anrFunctionNRId                           | Introduced | See MOM description. |
| AnrFunctionNRUeCfg.anrRsrpThreshold                     | Introduced | See MOM description. |
| AnrFunctionNRUeCfg.anrRsrqThreshold                     | Introduced | See MOM description. |
| AnrFunctionNRUeCfg.anrSinrThreshold                     | Introduced | See MOM description. |
| AnrPLMNTable.anrPLMNTableId                             | Introduced | See MOM description. |
| AnrPLMNTable.gNBIdLength                                | Introduced | See MOM description. |
| AnrPLMNTable.pLMNIdList                                 | Introduced | See MOM description. |
| EUtranFreqRelation.anrMeasOn                            | Introduced | See MOM description. |
| ExternalENodeBFunction.isRemoveAllowed                  | Introduced | See MOM description. |
| ExternalENodeBFunction.noRelationTimeStamp              | Introduced | See MOM description. |
| ExternalGNBCUCPFunction.isRemoveAllowed                 | Introduced | See MOM description. |
| ExternalGNBCUCPFunction.noRelationTimeStamp             | Introduced | See MOM description. |
| GNBCUCPFunction.blockedGNodeBList                       | Introduced | See MOM description. |
| GNBCUCPFunction.cellRelationMOThresh                    | Introduced | See MOM description. |
| GNBCUCPFunction.xnIpAddrViaNgActive                     | Introduced | See MOM description. |
| NRCellCU.lwNeighborRel                                  | Introduced | See MOM description. |
| NRCellCU.lwNeighborRelEUtran                            | Introduced | See MOM description. |
| NRCellDU.configuredEpsTAC                               | Introduced | See MOM description. |
| NRCellRelation.isRemoveAllowed                          | Introduced | See MOM description. |
| NRFreqRelation.anrMeasOn                                | Introduced | See MOM description. |
| TermPointToGNodeB.usedPLMNId                            | Introduced | See MOM description. |
| ExternalNRCellCU.nRTAC                                  | Affected   | See MOM description. |
| IntraFreqMCCellProfileUeCfg.betterSpCellTriggerQuantity | Affecting  | See MOM description. |

# 6 Performance of NR Automated Neighbor Relations

The feature has a KPI impact. It also has associated events for performance

observability.

KPIs

Table 4   Key Performance Indicators

| KPI                                                                                                     | Description                                                                                                                                                                                                              |
|---------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Throughput                                                                                              | The EN-DC UE throughput can be improved by connecting to the best                                     NR cell.                                                                                                           |
| NR-to-LTE Inter-RAT Handover success rate captured in source                                     gNodeB | This KPI can improve due to higher handover and success rate from                                     NR to LTE toward newly added neighbor cells.                                                                       |
| NR Handover success rate captured in source gNodeB                                                      | This KPI can improve due to higher handover and success rate in                                     NR SA toward newly added neighbor cells.                                                                             |
| DRB Retainability                                                                                       | DRB Retainability KPIs can degrade because of an increased number                                     of abnormal releases during Xn connection removal related to the                                     Xn blocklist. |

For more information on KPIs, see Key Performance Indicators.

Counters

The feature introduces the following PM counters:

- NRCellCU.pmAnrNeighbRelAddNr
- NRCellCU.pmAnrNcgiMeasTriggerDrx
- NRCellCU.pmAnrNcgiMeasRcvDrx
- NRCellCU.pmAnrNcgiMeasFailUeCap
- NRCellCU.pmAnrNcgiMeasRcvNoSib1NoTacCell
- NRCellCU.pmAnrNeighbRelRemNr
- NRCellCU.pmAnrEcgiMeasTriggerDrx
- NRCellCU.pmAnrEcgiMeasRcvDrx
- NRCellCU.pmAnrNeighbRelAddEutran
- NRCellCU.pmAnrNeighbRelRemEutran
- NRCellCU.pmAnrEcgiMeasFailUeCap
- NRCellCU.pmAnrNoActionTooWeakSa
- NRCellCU.pmAnrNoActionTooWeakEndc
- NRCellCU.pmAnrNeighbRelPromoteNr
- NRCellCU.pmAnrNeighbRelPromoteEutran
- NRCellCU.pmAnrNeighbRelPromoteRejNr
- NRCellCU.pmAnrNeighbRelPromoteRejEutran
- NRCellCU.pmAnrNeighbRelDemoteNr
- NRCellCU.pmAnrNeighbRelDemoteEutran

The following PM counters are

affected

by this feature:

- NRCellCU.pmHoPrepAttOutInterGnb
- NRCellCU.pmHoPrepSuccOutInterGnb
- NRCellCU.pmHoPrepAttOutEutran
- NRCellCU.pmHoPrepSuccOutEutran
- NRCellCU.pmHoExeAttOutEutran
- NRCellCU.pmHoExeSuccOutEutran
- NRCellCU.pmNrdcRelUeSnAbnormalSnInit
- NRCellCU.pmNrdcRelUeSnAbnormalSnInitAct

Events

- CuCpAnrEval
- CuCpAnrNeighbRelAdd
- CuCpAnrNeighbRelRem
- CuCpEcgiMeasurement
- CuCpNcgiMeasurement
- CuCpNgDownlinkRanConfigurationTransfer
- CuCpNgUplinkRanConfigurationTransfer
- CuCpX2EndcConfigurationTransfer
- CuCpX2EndcConfigurationUpdate
- CuCpX2EndcConfigurationUpdateAcknowledge

The following events are affected by this feature:

- CuCpAnrNeighbRelAdd
- CuCpAnrNeighbRelRem
- CuCpProcMnNrdcRelease
- CuCpProcSnNrdcRelease

# 7 Activate Non-License-Controlled Features

Non-license-controlled features do not require manual activation and cannot be

deactivated.

While license-controlled features need to be activated, non-license-controlled features

are activated automatically during node integration. They also do not

have

a software license key associated, which means that they have no

entries in the LKF that is installed on the node.

In some cases, non-license-controlled features need to be configured

manually or have some of

their

subfunctions enabled to work properly.

# 8 Engineering Guidelines for NR Automated Neighbor Relation

Table 5   Automated Neighbor Relations Attribute Configuration

| Impacted Function                                | Action                                                          | Attribute                                 | Attribute Setting   | Description                                                                                                                                                     |
|--------------------------------------------------|-----------------------------------------------------------------|-------------------------------------------|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| LTE-to-NR cell relations' (eNodeB configuration) | Enable Automated Neighbor Relation Functions for NR in LTE      | AnrFunctionNR.anrStateNR                  | ACTIVATED           | By this activation, NCGI measurement is triggered when unknown cell                                 is reported in NR IRAT measurement report on LTE cell.      |
| LTE-to-NR cell relations' (eNodeB configuration) | Enable Automated Neighbor Relation Functions for NR in LTE      | GUtranFreqRelation::anrMeasOn             | true                | By this activation, NCGI measurement is triggered when unknown cell                                 is reported in NR IRAT measurement report on LTE cell.      |
| LTE-to-NR cell relations' (eNodeB configuration) | Disable Automated Neighbor Relation Functions for NR in LTE     | AnrFunctionNR.anrStateNR                  | DEACTIVATED         |                                                                                                                                                                 |
| NR-to-NR cell relations'(gNodeB configuration)   | Enable NR Automated Neighbor Relation Functions in EN-DC        | AnrFunctionNR.anrEndcX2Enabled            | true                | By this activation, neighbor relations from NR to NR can be created                                 in gNB based on NR neighbor information from eNB.           |
| NR-to-NR cell relations'(gNodeB configuration)   | Enable the intra-frequency ANR based NCGI measurement in NR SA  | AnrFunctionNR.anrCgiMeasIntraFreqEnabled  | true                | By this activation, NCGI measurement is triggered when unknown cell                                 is reported in intra-frequency measurement report in NR SA. |
| NR-to-NR cell relations'(gNodeB configuration)   | Enable the intra-frequency ANR based NCGI measurement in NR SA  | NRFreqRelation.anrMeasOn                  | true                | By this activation, NCGI measurement is triggered when unknown cell                                 is reported in intra-frequency measurement report in NR SA. |
| NR-to-NR cell relations'(gNodeB configuration)   | Disable the intra-frequency ANR based NCGI measurement in NR SA | AnrFunctionNR.anrCgiMeasIntraFreqEnabled  | false               |                                                                                                                                                                 |
| NR-to-NR cell relations'(gNodeB configuration)   | Enable the inter-frequency ANR based NCGI measurement in NR SA  | AnrFunctionNR.anrCgiMeasInterFreqMode     | FR1                 | By this activation, NCGI measurement is triggered when unknown cell                                 is reported in inter-frequency measurement report in NR SA. |
| NR-to-NR cell relations'(gNodeB configuration)   | Enable the inter-frequency ANR based NCGI measurement in NR SA  | NRFreqRelation.anrMeasOn                  | true                | By this activation, NCGI measurement is triggered when unknown cell                                 is reported in inter-frequency measurement report in NR SA. |
| NR-to-NR cell relations'(gNodeB configuration)   | Disable the inter-frequency ANR based NCGI measurement in NR SA | AnrFunctionNR.anrCgiMeasInterFreqMode     | DISABLED            |                                                                                                                                                                 |
| NR-to-LTE cell relations(gNodeB configuration)   | Enable ANR based ECGI measurement in NR SA                      | AnrFunctionEUtran.anrCgiMeasEUtranEnabled | true                | By this activation, ECGI measurement is triggered when unknown cell                                 is reported in measurement report in NR SA.                 |
| NR-to-LTE cell relations(gNodeB configuration)   | Enable ANR based ECGI measurement in NR SA                      | EUtranFreqRelation.anrMeasOn              | true                | By this activation, ECGI measurement is triggered when unknown cell                                 is reported in measurement report in NR SA.                 |
| NR-to-LTE cell relations(gNodeB configuration)   | Disable ANR based ECGI measurement in NR SA                     | AnrFunctionEUtran.anrCgiMeasEUtranEnabled | false               |                                                                                                                                                                 |

## 8.1 Change Global gNodeB ID

Manual update is needed for changing the gNodeB ID for gNodeBs.

There is no automatic propagation for the change of the following attributes to

neighboring gNodeBs:

- GNBCUCPFunction.gNBId
- GNBCUUPFunction.gNBId
- GNBDUFunction.gNBId
- GNBCUCPFunction.gNodeBPlmnId
- GNBCUUPFunction.gNodeBPlmnId
- GNBDUFunction.gNodeBPlmnId

Therefore the procedure of changing the global gNodeB ID for gNodeB A is conducted

manually by the operator in the following way:

Steps

1. Deactivate the NR Automated Neighbor Relations feature in gNodeB A and all neighbors of gNodeB A by setting the featureState and the AnrFunctionNR.anrStateNR attributes to DEACTIVATED.
2. Lock all TermPointToGNBCUCP MOs in gNodeB A.
    1. If gNodeB ID changing is done as part of a gNodeB reconfiguration that can affect radio conditions, remove all external gNodeB functions in gNodeB A, including all children and possible referring NRCellRelation MOs. Note: A gNodeB reconfiguration that can affect radio configurations is, for example, the changing of the cell range or cell frequencies. With these changes, some neighbor information might not be needed if the local cells are too far away.
3. Remove the ExternalGNBCUCPFunction MO representing gNodeB A from all neighboring gNodeBs, including all children and possible referring NRCellRelation MOs. Note: The TermPointToGNBCUCP MO must be locked before removing it.
4. Change the following attributes in gNodeB A: GNBCUCPFunction.gNBId GNBCUUPFunction.gNBId GNBDUFunction.gNBId GNBCUCPFunction.gNodeBPlmnId GNBCUUPFunction.gNodeBPlmnId GNBDUFunction.gNodeBPlmnId
5. Restart gNodeB A.
6. Unlock all TermPointToGNBCUCP MOs in gNodeB A.
7. Restore the settings of the NR Automated Neighbor Relations feature in gNodeB A and neighboring gNodeBs. Also, let the feature or the X2 interface recreate the relevant children of NRNetwork and NRCellRelation.

## 8.2 Configure Automatic Creation of Neighbor Relations for Service-Based IRAT Mobility

Prerequisites

- The B1 measurement report can trigger the ECGI measurement when the value of the McfbCellProfileUeCfg.epsFallbackOperation attribute is configured for measurement-based IRAT handover of non-emergency voice calls.
- The AnrFunctionEUtran.anrCgiMeasEUtranEnabled must be activated on the node level.
- The EUtranFreqRelation.anrMeasOn attribute must set to TRUE.

Steps

1. Configure the AnrFunctionEUtranUeCfg.ecgiDuringEpsFbEnabled attribute to enable the automatic creation of the lightweight EUtranCellRelation object based on the B1 measurement report.
2. Configure the following attributes to set the removal of the unused neighbor objects: AnrFunction.removeEnbTime ExternalENodeBFunction.isRemoveAllowed ExternalENodeBFunction.noRelationTimeStamp

Related concepts

Lightweight Neighbor Cell Relation Object Handling

## 8.3 Configuring the Xn Blocklist

The Xn blocklist can be configured to select which gNodeBs are blocked.

To add a gNodeB to the gNodeB blocklist, an entry must be created in the

GNBCUCPFunction.blockedGNodeBList attribute. This entry is a

BlockedGNodeBInfo struct with the following configuration

options:

- mcc
- mnc
- mncLength
- gNBId
- gNBIdLength
- directPacketForwarding

For example, to block all Xn connections for gNodeBs with PLMN ID 123-45 and block direct

packet forwarding from or to those gNodeBs as well, the following configuration can be

used:

- mcc is set to 123.
- mnc is set to 45.
- mncLength is set to 2.
- gNBId is set to -1.
- gNBIdLength is set to 22.
- directPacketForwarding is set to false.

When a gNodeB matches multiple entries in the gNodeB blocklist, the entry that

specifically blocks the ID of the gNodeB is prioritized over any entries using the

-1 wildcard for the gNodeB ID.

To avoid misconfiguration, it is recommended to configure the gNodeB blocklist on both

gNodeBs where a connection must be blocked. The first gNodeB is recommended to be

configured to block the second gNodeB, and the second gNodeB is recommended to be

configured to block the first gNodeB.

The ExternalGNBCUCPFunction.gNBIdLength attribute is generated by the

feature based on the value of the GNBCUCPFunction.gNBIdLength

attribute. This might lead to a difference in the value of the attribute and the actual

length of the gNodeB ID.

If any NR-DC connected UEs are using a gNodeB as a Master Node or Secondary Node, those

UEs might be released when the gNodeB is added to the gNodeB blocklist. This might lead

to an increased number of RRC Connection Re-establishment procedure attempts. To

minimize this impact, it is recommended to configure the gNodeB blocklist during periods

of low network use.

Blocking direct packet forwarding is only supported to and from gNodeBs, that use a RAN

Compute unit in RAN Compute group 4 or higher.

## 8.4 Configuring PLMN-Level Xn Blocklist Using ENM Bulk Configuration

It is recommended to use ENM Bulk Configuration to configure PLMN-level Xn

blocklists.

It is recommended to use ENM Bulk Configuration to configure the list of excluded PLMNs

and gNodeBs in the GNBCUCPFunction.blockedGNodeBList attribute. It is

recommended to conduct only one bulk configuration job at a time with sequential

execution to reduce the number of deletion notifications from the gNodeBs to the

ENM.

Removing a large number of Xn connections at the same time can lead to a high volume of

deletion notifications in the ENM, which can result in a full configuration management

resynchronization of some gNodeBs in the ENM.

## 8.5 Configure Support for PLMN-Specific gNodeB ID Lengths

Prerequisites

- Two nodes are configured with different gNodeB ID lengths and PLMNs.
- The UE supports the nr-CGI-Reporting and the longDRX-Cycle parameters for NCGI measurements.

Steps

If the NR Automated Neighbor Relations feature is already configured, do the following:

1. Set the values of the AnrPLMNTable.gNBIdLength and the AnrPLMNTable.pLMNIdList attributes to match with the target node configuration.

After This Task

The operator must remove the old neighbor configuration with an invalid gNodeB ID

length if such a configuration exists.

If the NR Automated Neighbor Relations feature is not configured, the values of the

AnrPLMNTable.gNBIdLength and the

AnrPLMNTable.pLMNIdList attributes must be set to match with

the target node configuration. After that, the NR Automated Neighbor Relations

feature must be configured.

# Appendix A: Feature Change History

This section lists changes that affected this feature and the impact it had on the

network.

## Appendix A.a: 20.Q4: Retrieval of NR Cell Information through EN-DC Configuration Update

This enhancement enables the Master eNodeB to retrieve the cell information of a

specific NR cell over the X2 interface.

| Feature Name:           | NR Automated Neighbor Relations   |
|-------------------------|-----------------------------------|
| Feature Identity:       | FAJ 121 5218                      |
| Value Package Name:     | NR Low/Mid-Band Base Package      |
| Value Package Identity: | FAJ 801 4002/5LM                  |
| Node Type:              | Baseband Radio Node               |
| Access Type:            | NR                                |

Benefits

The enhancement ensures that the configuration data of

ExternalGUtranCell neighbor objects is kept up-to-date

through the X2 interface. This data cannot be acquired through the NCGI received

from the UE.

Capacity and Performance

No impact.

Operation

No impact.

Interfaces

This change affects the following interfaces:

- X2AP The Cell Assistance Information IE is introduced in the X2AP: EN-DC CONFIGURATION UPDATE message to request information about a specific NR cell. The List of Served NR Cells IE in the X2AP: EN-DC CONFIGURATION UPDATE ACKNOWLEDGE message is used to include information about the requested NR cell.

Hardware

No specific hardware requirements.

Other Network Elements

No impact.

## Appendix A.b: 21.Q2: NR Automated Neighbor Relations for Intra-Frequency NR Mobility for EN-DC

This enhancement enables the gNodeB to detect and create lightweight

NRCellRelation object based on the neighbor cell information provided

by the eNodeB over the X2 link. Lightweight NRCellRelation object can

also be created based on incoming NR A3 measurements.

| Feature Name:           | NR Automated Neighbor Relations   |
|-------------------------|-----------------------------------|
| Feature Identity:       | FAJ 121 5218                      |
| Value Package Name:     | NR Base Package                   |
| Value Package Identity: | FAJ 801 4002                      |
| Node Type:              | Baseband Radio Node               |
| Access Type:            | NR                                |

Benefits

The enhancement enables the automatic detection and creation of NR-to-NR neighbor

cell relations if NR neighbour information IE is propagated from the

eNodeB to the gNodeB over the X2 link. The need for manual optimization in the

NR-to-NR neighbor cell list is removed. This reduces OPEX, supporting SA and NSA

mobility in the gNodeB.

Capacity and Performance

No impact.

Operation

The ANRFunctionNR MO must be created and the

AnrFunctionNR.anrEndcX2Enabled attribute must be set to

true to activate the automatic detection and creation of

NR-to-NR cell relations on the node level.

This function supports the creation of intra-frequency lightweight

NRCellRelation object on Low-Band and Mid-Band. High-Band is

also supported, if cell relations in the eNodeB are created by the Automated Neighbor Relations feature or by the

operator.

A lightweight NRCellRelation object is created if the following

conditions are fulfilled:

- The enhancement is activated.
- An unknown NR cell is reported in the NR A3 message for PSCell change.
- The reported cell matches a known NR cell, which resides under the same LTE PCell. The relevant NR neighbor cell information is sent by the eNodeB in the NR Neighbour Information IE in the EN-DC CONFIGURATION UPDATE message or the EN-DC X2 SETUP REQUEST message.

The NRCellCU.lwNeighborRel attribute can be used to display

read-only information on the lightweight NRCellRelation

object.

For information on related eNodeB configurations, see Automated Neighbor Relations.

Interfaces

This change affects the X2 interface. The NR Neighbour Information IE

is introduced in the following IEs:

- The Served E-UTRA Cells to Add IE or the Served E-UTRA Cells to Modify IE in the EN-DC CONFIGURATION UPDATE message.
- The List of Served E-UTRA Cells IE in the EN-DC X2 SETUP REQUEST message.

Hardware

No special hardware requirements.

Other Network Elements

ENM version 21.1 or later is required for this enhancement.

## Appendix A.c: 21.Q2: NR Automated Neighbor Relations for Intra-Frequency NR Mobility for NR SA

This feature enhancement enables the automatic creation of NR-to-NR cell relations

for NR cells reported by the UE based on NCGI measurements. It also enables the automatic

removal of NRCellRelation objects that fulfill removal

conditions.

| Feature Name:           | NR Automated Neighbor Relations                 |
|-------------------------|-------------------------------------------------|
| Feature Identity:       | FAJ 121 5218                                    |
| Value Package Name:     | NR                                 Base Package |
| Value Package Identity: | FAJ 801 4002                                    |
| Node Type:              | Baseband Radio Node                             |
| Access Type:            | NR                                              |

Summary and Benefits

This feature enhancement enables the automatic creation of NR-to-NR cell relations

for NR cells based on NCGI measurements. NCGI measurement procedure is not supported

towards cell on high-band.

This feature enhancement minimizes the need for manual configuration of NR-to-NR cell

relations and optimization of mobility functions.

Capacity and Performance

No impact.

Operation

With this feature enhancement, the NRCellCU.lwNeighborRel

read-only attribute displays automatically created lightweight

NRCellRelation objects.

The introduced AnrFunctionNR.anrCgiMeasIntraFreqEnabled attribute

must be enabled to allow the automatic creation of lightweight

NRCellRelation objects. For that, the

NRFreqRelation.anrMeasOn attribute must be set to

true.

This feature enhancement automatically removes NRCellRelation

objects in the following cases:

- NRCellRelation MOs are removed if the NRCellRelation.isRemoveAllowed attribute is set to true and they are not used for the time set in the AnrFunction.removeNrelTime attribute.
- Existing lightweight NRCellRelation object listed in the NRCellCU.lwNeighbourRel attribute are removed if they are not used for the time set in the AnrFunction.removeNrelTime attribute.

This feature enhancement introduces the following PM counters:

- NRCellCU.pmAnrNcgiMeasTriggerDrx
- NRCellCU.pmAnrNcgiMeasRcvDrx
- NRCellCU.pmAnrNcgiMeasFailUeCap
- NRCellCU.pmAnrNcgiMeasRcvNoSib1NoTacCell

To monitor the number of the automatically added or removed NR cell relations, the

following counters can be used:

- NRCellCU.pmAnrNeighbRelRemNr
- NRCellCU.pmAnrNeighbRelAddNr

Interfaces

This feature enhancement affects the Uu interface the following way:

- An IE is introduced indicating the UE capability to acquire relevant information by reading the SI messages of the neighbor cell and report the acquired information to the network.
- IEs are introduced to configure NCGI measurement to the UE and to receive the NCGI information in a measurement report.

This feature enhancement affects the F1 interface the following way:

- An IE is introduced delivering information of the DRX configuration for NCGI measurement.
- An IE is introduced indicating the release of the DRX configuration for restoring to previous DRX configuration.

Hardware

No special hardware requirements.

Other Network Elements

ENM version 21.1 or later is required for this feature

enhancement.

## Appendix A.d: 21.Q2: Automatic Xn Setup and IP Address Retrieval

The feature enhancement enables to automatically establish the Xn connection

to the neighbor

node.

| Feature Name:           | NR Automated Neighbor Relations   |
|-------------------------|-----------------------------------|
| Feature Identity:       | FAJ 121 5218                      |
| Value Package Name:     | NR Base Package                   |
| Value Package Identity: | FAJ 801 4002                      |
| Node Type:              | Baseband Radio Node               |
| Access Type:            | NR                                |

Benefits

The feature enhancement enables the gNodeB to do the

following automatically:

- Create ExternalGNBCUCPFunction and TermPointToGNodeB MOs based on NRCellRelation objects toward unknown external gNodeBs
- Set up Xn-C connection to an external gNodeB
- Remove neighbor objects that are not used for a configured amount of time

Capacity and Performance

No impact.

Operation

The following attributes are introduced:

- GNBCUCPFunction.xnIpAddrViaNgActive The attribute is introduced to activate configuration transfer over the NG interface. If the GNBCUCPFunction.xnIpAddrViaNgActive attribute is set to true and an NRCellRelation object toward an unknown external gNodeB is created, then the following processes are performed: Automatic creation of ExternalGNBCUCPFunction and TermPointToGNodeB MOs Xn-C connection setup to external gNodeB
- TermPointToGNodeB.usedPLMNId The TermPointToGNodeB.usedPLMNId attribute is introduced to store the PLMN identity used for the SctpEndPoint selection for Xn-C.
- ExternalGNBCUCPFunction.isRemoveAllowed The automatic removal of ExternalGNBCUCPFunction MO and child objects is enabled by setting the ExternalGNBCUCPFunction.isRemoveAllowed attribute to true and AnrFunction.removeGnbTime attribute to any value other than 1000. If the automatic removal is enabled and the ExternalGNBCUCPFunction MO is not used for longer than the time specified in the AnrFunction.removeGnbTime attribute, then the ExternalGNBCUCPFunction MO and its child objects are removed.
- ExternalGNBCUCPFunction.noRelationTimeStamp The attribute is introduced to identify when the ExternalGNBCUCPFunction is not used. This is done by identifying when the ExternalNRCellCU and its child objects are not referred by any relation.

Interfaces

The following NGAP messages are used:

- UPLINK RAN CONFIGURATION TRANSFER
- DOWNLINK RAN CONFIGURATION TRANSFER

Hardware

No special hardware requirements.

Other Network Elements

ENM version 21.2 or later is required for this feature

enhancement.

The AMF must support NGAP version 15.6.0 or later to decode the

UplinkRANConfigurationTransfer message. The

UplinkRANConfigurationTransfer contains the IP address for that

neighbor gNodeB, to which Xn setup is needed.

If the decoding fails, the following happens:

- Automatic Xn setup fails
- Only manual Xn setup is possible
- A TermPointToGNodeB MO for each discovered neighbor gNodeB is unlocked and disabled.

## Appendix A.e: 21.Q2: NR Automated Neighbor Relations for Inter-Frequency NR Mobility for NR SA

This

enhancement enables the gNodeB to create NR-to-NR cell relations automatically.

| Feature Name:           | NR Automated Neighbor Relations                                                      |
|-------------------------|--------------------------------------------------------------------------------------|
| Feature Identity:       | FAJ 121 5218                                                                         |
| Value Package Name:     | NR                                 Band                                 Base Package |
| Value Package Identity: | FAJ 801 4002                                                                         |
| Node Type:              | Baseband Radio Node                                                                  |
| Access Type:            | NR                                                                                   |

Summary and Benefits

This feature enhancement enables the automatic creation of NR-to-NR cell relations

for NR cells based on NCGI measurements. NCGI measurement procedure is not supported

towards cell on high-band.

This enhancement supports the creation and removal of inter-frequency neighbor

relations so that inter-frequency handover can be performed without manual

configuration.

Capacity and Performance

No impact.

Operation

The ANR function with NCGI measurement can be activated for inter-frequency

mobility.

For inter-frequency ANR function, the following configurations are required:

- The AnrFunctionNR.anrCgiMeasInterFreqMode attribute must be set to FR1.
- The NRFreqRelation.anrMeasOn attribute should be set to true on the corresponding frequency relation MO.

Interfaces

No impact.

Hardware

No special hardware requirements.

Other Network Elements

ENM version 21.1 or later is required for this enhancement.

## Appendix A.f: 21.Q3: Automatic Removal of System-Created ExternalGNBCUCPFunction MO and Recovery Handling of Lost Xn-C Connection

This feature enhancement introduces support for the automatic removal of unused

ExternalGNBCUCPFunction MO instances created by the system. It also

introduces the recovery handling of lost Xn-C connections.

| Feature Name:           | NR Automated Neighbor Relations   |
|-------------------------|-----------------------------------|
| Feature Identity:       | FAJ 121 5218                      |
| Value Package Name:     | NR Base Package                   |
| Value Package Identity: | FAJ 801 4002                      |
| Node Type:              | Baseband Radio Node               |
| Access Type:            | NR                                |

Summary and Benefits

The system automatically creates the ExternalGNBCUCPFunction MO

instance with the ExternalGNBCUCPFunction.isRemoveAllowed

attribute set to true in one of the following cases:

- The gNodeB receives an XN SETUP REQUEST message from an unknown gNodeB.
- The gNodeB receives an NCGI measurement report for a neighbor NR cell of an unknown gNodeB.

All automatically created ExternalGNBCUCPFunction MO instances are

also removed by the ANR removal function.

If the AnrFunction MO does not exist, the unused

ExternalGNBCUCPFunction MO and all of its child MOs are

removed after 60 minutes. For more information, see Xn Configuration.

When the Xn-C connection is lost, the NR Automated Neighbor Relations feature

attempts to recover it automatically. This is done by triggering the reestablishment

of the Xn-C connection based on whether the

ExternalGNBCUCPFunction MO instance is used.

Capacity and Performance

No impact.

Operation

No impact.

Hardware

No specific hardware requirements.

Interfaces

No impact.

Other Network Elements

ENM version 21.1 or later is required for this feature

enhancement.

Related Information

NR Automated Neighbor Relations

## Appendix A.g: 21.Q3: Support for Automated Neighbor Relations for Inter-Frequency NR Mobility for EN-DC

This enhancement enables the gNodeB to detect and create lightweight

NRCellRelation objects based on the neighbor cell information

provided by the eNodeB over the X2 link. Lightweight NRCellRelation

objects can be created based on incoming NR A5 measurements.

| Feature Name:           | NR Automated Neighbor Relations     |
|-------------------------|-------------------------------------|
| Feature Identity:       | FAJ 121 5218                        |
| Value Package Name:     | NR Base Package                     |
| Value Package Identity: | FAJ 801 4002                        |
| Node Type:              | Baseband Radio Node                 |
| Access Type:            | NR                                  |
| Licensing               | Basic feature. No license required. |

Summary and Benefits

This enhancement allows for the automatic finding and creation of inter-frequency

neighbors from NR-to-NR for NSA mobility when NR Neighbour

Information IE is propagated from eNodeB to gNodeB over the X2 link.

Through the automated NR ANR support, the enhancement reduces the need for the

operator to manually create lightweight NRCellRelation objects

for PSCell change in EN-DC.

The enhancement also improves conditions for automatic removal of unused

NRCellRelation objects in order not to remove

NRCellRelation objects being used for EN-DC.

Capacity and Performance

The following PM counter can be used to monitor the number of automatically added and

removed NRCellRelation objects:

- NRCellCU.pmAnrNeighbRelAddNr
- NRCellCU.pmAnrNeighbRelRemNr

Through the automated NR ANR support, the enhancement reduces the need for theThe following PM counters can be used to monitor the number of attempted PSCell

changes:

- NRCellCU.pmEndcPSCellChangeAttIntraSgnb
- NRCellCU.pmEndcPSCellChangeAttInterSgnb

Operation

To activate automatic creation of inter-frequency NR-to-NR relations on node level,

set AnrFunctionNR.anrEndcX2Enabled to true. This

feature is instantly turned on if AnrFunctionNR.anrEndcX2Enabled

was previously set to true.

To activate automatic removal of NRCellRelation objects, set

NRCellRelation.isRemoveAllowed to true and

set AnrFunction.removeNrelTime to the duration NR cell relations

can remain unused in the gNodeB.

Interfaces

No impact.

Hardware

No special hardware requirements.

Other Network Elements

ENM version 21.1 or later is required for this feature

enhancement.

## Appendix A.h: 21.Q4: EN-DC ANR Support for NR Cells Used in ESS with No SIB1

This feature enhancement enables the creation of LTE-to-NR cell relations for EN-DC

setup to NR cells used in ESS cell pairs without SIB1 transmission.

| Feature Name:           | NR Automated Neighbor Relations   |
|-------------------------|-----------------------------------|
| Feature Identity:       | FAJ 121 5218                      |
| Value Package Name:     | NR Base Package                   |
| Value Package Identity: | FAJ 801 4002                      |
| Node Type:              | Baseband Radio Node               |
| Access Type:            | NR                                |

Summary and Benefits

With this feature enhancement, more LTE-to-NR cell relations can provide more

opportunities for EN-DC.

If an NR cell exists in an ESS cell pair and an NCGI measurement is reported on the

eNodeB confirming that SIB1 is not transmitted, a

GUtranCellRelation MO is automatically created. For unknown

gNodeBs, IP retrieval is performed and an EN-DC X2 connection is set up.

Capacity and Performance

No impact.

Operation

No impact.

Hardware

No specific hardware requirements.

Interfaces

This feature enhancement introduces an IE for Ericsson Private Extension that

contains information about the neighbor NR cells that might not be possible to find

through NCGI measurements. This information element is introduced in the following

messages sent over the X2-C interface:

- X2AP X2 SETUP REQUEST
- X2AP X2 SETUP RESPONSE
- X2AP ENB CONFIGURATION UPDATE

Other Network Elements

It is recommended to use ENM version 21.4 or later to support the

MOM changes introduced by this feature enhancement. If the Release Independence

Manager application is used, the MOM changes are supported on earlier ENM versions

also.

## Appendix A.i: 22.Q1: ANR for Coverage-Based IRAT Mobility

This feature enhancement enables the automatic management of NR-to-LTE neighbor

relations based on ECGI measurements.

| Feature Name:           | NR Automated Neighbor Relations   |
|-------------------------|-----------------------------------|
| Feature Identity:       | FAJ 121 5218                      |
| Value Package Name:     | NR Base Package                   |
| Value Package Identity: | FAJ 801 4002                      |
| Node Type:              | Baseband Radio Node               |
| Access Type:            | NR                                |

Summary and Benefits

This enhancement enables the automatic creation of lightweight

EUtranCellRelation objects in the gNodeB using ECGI

measurements. Additionally, if the neighbor objects are unused for a configurable

period, they are removed.

When a connected UE reports an unknown LTE cell in the B2 measurement report, the

ECGI measurement is triggered. Based on the ECGI measurement report, the gNodeB

creates lightweight EUtranCellRelation objects.

The EUtranCellRelation objects are removed automatically if they

are not used for IRAT mobility for a configured time.

This enhancement decreases the need for manual configuration for IRAT handover.

Capacity and Performance

No impact.

Operation

The AnrFunctionEUtran MO class is introduced.

The following attributes are introduced:

- AnrFunctionEUtran.anrCgiMeasEUtranEnabled
- EUtranFreqRelation.anrMeasOn
- AnrFunction.removeEnbTime
- ExternalENodeBFunction.isRemoveAllowed
- ExternalENodeBFunction.noRelationTimeStamp
- NRCellCU.lwNeighborRelEUtran

The AnrFunction.removeNrelTime attribute is updated to include LTE

cell relations.

The AnrFunctionNR.gNBIdLength attribute is deprecated.

The following PM counters are introduced:

- NRCellCU.pmAnrEcgiMeasTriggerDrx
- NRCellCU.pmAnrEcgiMeasRcvDrx
- NRCellCU.pmAnrNeighbRelAddEutran
- NRCellCU.pmAnrNeighbRelRemEutran
- NRCellCU.pmAnrEcgiMeasFailUeCap

The following PM events are introduced:

- CuCpEcgiMeasurement

This feature enhancement affects the following PM events:

- CuCpAnrNeighbRelAdd
- CuCpAnrNeighbRelRem

Interfaces

This change affects the following RRC messages:

- RRC UECapabilityInformation
- RRC MeasurementReport
- RRC RRCReconfiguration

Hardware

No impact.

Other Network Elements

It is recommended to use ENM version 22.1 or later to support the MOM changes introduced by this feature enhancement. If the Release Independence Manager application is used, the MOM changes are supported on earlier ENM versions also.

## Appendix A.j: 22.Q2: ANR for Service-Based IRAT Mobility

This

feature enhancement enables the automatic creation of the NR-to-LTE neighbor relations based

on the B1 measurement report. It also supports the handling of the LTE cell information in

the gNodeB.

| Feature Name:           | NR Automated Neighbor Relations   |
|-------------------------|-----------------------------------|
| Feature Identity:       | FAJ 121 5218                      |
| Value Package Name:     | NR Base Package                   |
| Value Package Identity: | FAJ 801 4002                      |
| Node Type:              | Baseband Radio Node               |
| Access Type:            | NR                                |

Summary and Benefits

This feature enhancement enables the automatic creation of the lightweight

EUtranCellRelation objects in the gNodeB based on received B1

measurement report. It supports the scenario when the value of the

McfbCellProfileUeCfg.epsFallbackOperation attribute is

configured for measurement-based IRAT handover of non-emergency voice calls. When a

connected UE reports an unknown LTE cell in the B1 measurement report, the ECGI

measurement is triggered. Based on the ECGI measurement report, the gNodeB creates

lightweight EUtranCellRelation objects. The NR-to-LTE cell

relations are removed automatically if they are not used for IRAT mobility for a

configured time.

This feature enhancement has the following benefits:

- Decreases manual configuration for IRAT handover
- Increases the NR-to-LTE Inter-RAT Handover success rate captured in source gNodeB KPI
- Decreases the number of the UE Release with Redirection to LTE and the number of the UE Abnormal Release procedures
- Supports the maintenance of the cell relations by enhanced handling of the LTE cell frequency information in the gNodeB

Capacity and Performance

No impact.

Operation

This feature enhancement introduces the AnrFunctionEUtranUeCfg MO

class. The AnrFunctionEUtranUeCfg.ecgiDuringEpsFbEnabled

attribute is introduced for B1 measurement-based IRAT handover of non-emergency

voice calls.

The following attributes also need to be configured to benefit from this feature

enhancement:

- AnrFunctionEUtran.anrCgiMeasEUtranEnabled
- EUtranFreqRelation.anrMeasOn
- AnrFunction.removeEnbTime
- ExternalENodeBFunction.isRemoveAllowed
- ExternalENodeBFunction.noRelationTimeStamp

The following counters monitor the ECGI measurement:

- NRCellCU.pmAnrEcgiMeasTriggerDrx
- NRCellCU.pmAnrEcgiMeasRcvDrx
- NRCellCU.pmAnrEcgiMeasFailUeCap

The following counters monitor the creation and the removal of the neighbor objects:

- NRCellCU.pmAnrNeighbRelAddEutran
- NRCellCU.pmAnrNeighbRelRemEutran

The following counters monitor the increase in the IRAT handover attempts:

- NRCellCU.pmHoPrepAttOutEutran
- NRCellCU.pmHoPrepSuccOutEutran
- NRCellCU.pmHoExeAttOutEutran
- NRCellCU.pmHoExeSuccOutEutran

The following counters monitor the decrease in the number of UE Release with

Redirection to LTE procedures triggered by the EPS Fallback procedure:

- NRCellCU.pmUeCtxtRelAbnormalAmf
- NRCellCU.pmUeCtxtRelAbnormalGnb
- NRCellCU.pmRwrEutranUeSuccEpsfb

Interfaces

This feature enhancement affects the X2 interface. It supports the processing of the

LTE cell frequency information in the gNodeB that are received with the following

messages:

- X2AP EN-DC X2 SETUP REQUEST
- X2AP EN-DC CONFIGURATION UPDATE

Hardware

No impact.

Other Network Elements

It is recommended to use ENM version 22.1 or later to support the MOM changes introduced by this feature enhancement. If the Release Independence Manager application is used, the MOM changes are supported on earlier ENM versions also.

## Appendix A.k: 22.Q2: ANR Enhancement with MO Actions and Cell ID Change Handling

The feature enhancement enables the display and promotion of lightweight objects

created in persistent memory.

| Feature Name           | NR Automated Neighbor Relations   |
|------------------------|-----------------------------------|
| Feature Identity       | FAJ 121 5218                      |
| Value Package Name     | NR Mid/Low-Band Base Package      |
| Value Package Identity | FAJ 801 4002                      |
| Node Type              | Baseband Radio Node               |
| Access Type            | NR                                |

Summary and Benefits

The feature enhancement introduces MO action to display lightweight objects created

in persistent memory and to promote them into MOM objects. This enables the operator

to modify the relations attributes and reduces OPEX.

Capacity and Performance

This feature enhancement is associated with the following counters:

- NRCellCU.pmHoPrepAttOutIntraGnb
- NRCellCU.pmHoPrepSuccOutIntraGnb
- NRCellCU.pmHoExeAttOutIntraGnb
- NRCellCU.pmHoExeSuccOutIntraGnb
- NRCellCU.pmHoPrepAttOutInterGnb
- NRCellCU.pmHoPrepSuccOutInterGnb
- NRCellCU.pmHoExeAttOutInterGnb
- NRCellCU.pmHoExeSuccOutInterGnb
- NRCellCU.pmEndcPSCellChangeAttIntraSgnb
- NRCellCU.pmEndcPSCellChangeSuccIntraSgnb
- NRCellCU.pmEndcPSCellChangeAttInterSgnb
- NRCellCU.pmEndcPSCellChangeSuccInterSgnb
- NRCellCU.pmUeCtxtRelAbnormalGnb
- NRCellCU.pmUeCtxtRelAbnormalAmf
- NRCellCU.pmDrbRelAbnormalAmf5qi
- NRCellCU.pmEndcRelUeAbnormalMenb
- NRCellCU.pmEndcRelUeAbnormalSgnb

Operation

The following MO actions are introduced:

- NRCellCU.displayNRCellRelation
- NRCellCU.displayEUtranCellRelation
- NRCellCU.promoteLwNRCellRelation
- NRCellCU.promoteLwEUtranCellRelation

Interfaces

No impact.

Hardware

No specific hardware requirements.

Other Network Elements

It is recommended to use ENM version 22.2 or later to support the

MOM changes introduced by this feature enhancement. If the Release Independence

Manager application is used, the MOM changes are supported on earlier ENM versions

also.

## Appendix A.l: 22.Q2: Automatic Xn Setup Improvements

The feature improvement enables automatic Xn setup for existing

NRCellRelation objects.

| Feature Name:           | NR Automated Neighbor Relations   |
|-------------------------|-----------------------------------|
| Feature Identity:       | FAJ 121 5218                      |
| Value Package Name:     | NR Mid/Low-Band Base Package      |
| Value Package Identity: | FAJ 801 4002                      |
| Node Type:              | Baseband Radio Node               |
| Access Type:            | NR                                |

Summary and Benefits

This feature improvement enables automatic Xn setup for existing

NRCellRelation objects. This eliminates the need for manual

Xn setup configuration.

Capacity and Performance

The feature improvement affects the following PM events:

- CuCpNgUplinkRanConfigurationTransfer
- CuCpNgDownlinkRanConfigurationTransfer
- CuCpXnSetupRequest
- CuCpXnSetupResponse

Operation

To enable the feature improvement, the

GNBCUCPFunction.xnIpAddrViaNgActive attribute must be set to

true.

Interfaces

No impact.

Hardware

No specific hardware requirements.

Other Network Elements

No impact.

## Appendix A.m: 22.Q3: ANR-Specific Thresholds to Create Neighbor Relation

Configurable ANR-specific thresholds are used in target cell evaluation to prevent

establishing cell relations to target cells that have poor radio link

quality.

| Feature Name           | NR Automated Neighbor Relations   |
|------------------------|-----------------------------------|
| Feature Identity       | FAJ 121 5218                      |
| Value Package Name     | NR Base Package                   |
| Value Package Identity | FAJ 801 4002                      |
| Node Type              | Baseband Radio Node               |
| Access Type            | NR                                |
| Impact at Upgrade      | Optional                          |

Summary and Benefits

This feature enhancement optimizes neighbor relation handling by preventing the

creation of a cell relation to target cells that have poor radio quality. This

provides the following benefits:

- The UE only has target cells for mobility that provide better radio quality.
- Reduces the chance of the UE losing connection after mobility.
- Reduces the chance of the UE performing the RRC Connection Re-establishment procedure.

Capacity and Performance

The enhancement reduces the number of cell relations created. This can be observed

using the NRCellCU.pmAnrNeighbRelAddNr counter.

Due to the increase in target cell strength, incoming intra-frequency mobility can be

served better. This can be observed with the following counters:

- NRCellCU.pmHoPrepSuccOutIntraGnb
- NRCellCU.pmHoPrepAttOutIntraGnb
- NRCellCU.pmHoPrepSuccOutInterGnb
- NRCellCU.pmHoPrepAttOutInterGnb
- NRCellCU.pmHoExeSuccOutIntraGnb
- NRCellCU.pmHoExeAttOutIntraGnb
- NRCellCU.pmHoExeSuccOutInterGnb
- NRCellCU.pmHoExeAttOutInterGnb
- NRCellCU.pmEndcPSCellChangeSuccInterSgnb
- NRCellCU.pmEndcPSCellChangeAttInterSgnb
- NRCellCU.pmEndcPSCellChangeSuccIntraSgnb
- NRCellCU.pmEndcPSCellChangeAttIntraSgnb

In SA deployment, instead of handover to a weak target cell after the ANR action,

other target cell mobility can occur or the UE can loose connection and perform

connection reestablishment. This can increase the following counters:

- NRCellRelation.pmEbsHoPrepAttOutInterGnb
- NRCellRelation.pmEbsHoPrepAttOutIntraGnb
- NRCellRelation.pmEbsHoPrepAttOutInterGnbIntraF
- NRCellCU.pmUeCtxtRelAbnormalAmf
- NRCellCU.pmUeCtxtRelAbnormalGnb
- NRCellCU.pmRrcConnReestAtt

In EN-DC deployment, more UE measurement reports might be received. Instead of PSCell

change to the weak target cell, PSCell change to other target cells can occur or

EN-DC SCG might be released. This can increase the following counters:

- NRCellRelation.pmEndcUeMeasurementReport
- NRCellRelation.pmEbsEndcPSCellChangeAttInterSgnb
- NRCellRelation.pmEbsEndcPSCellChangeAttIntraSgnb
- NRCellRelation.pmEbsEndcPSCellChangeAttIntraSgnbIntraF
- NRCellRelation.pmEbsEndcPSCellChangeAttInterSgnbIntraF
- NRCellCU.pmEndcRelUeAbnormalMenb
- NRCellCU.pmEndcRelUeAbnormalSgnb

Operation

The enhancement reduces the number of cell relations created. To observe this, the

following counters are introduced:

- NRCellCU.pmAnrNoActionTooWeakSa
- NRCellCU.pmAnrNoActionTooWeakEndc

The enhancement introduces the CuCpAnrEval event. In case

neighbor creation is not allowed due to ANR-specific thresholds, the result of the

CuCpAnrEval event is

ANR\_EVAL\_RESULT\_NO\_ACTION\_TOO\_WEAK\_TARGET\_SIGNAL.

The enhancement introduces the AnrFunctionNRUeCfg MO class.

The enhancement introduces the following parameters for controlling the

threshold:

- AnrFunctionNRUeCfg.anrRsrpThreshold
- AnrFunctionNRUeCfg.anrRsrqThreshold

The enhancement updates the AnrFunctionEUtranUeCfg MO class. The

AnrFunctionEUtranUeCfg=Base MO instance is created

automatically when its parent MO is created, unless created manually in the same

transaction as the parent MO.

Interfaces

No impact.

Hardware

No specific hardware requirements.

Other Network Elements

It is recommended to use ENM version 22.3 or later to support the

MOM changes introduced by this feature enhancement. If the Release Independence

Manager application is used, the MOM changes are supported on earlier ENM versions

also.

Related Information

NR Automated Neighbor Relations

## Appendix A.n: 23.Q3: Automatic Promotion and Demotion of Neighbor Cell Relation Objects

Lightweight neighbor cell relation objects can be automatically promoted and demoted

based on the number of mobility attempts targeting

them.

| Feature Name           | NR Automated Neighbor Relations   |
|------------------------|-----------------------------------|
| Feature Identity       | FAJ 121 5218                      |
| Value Package Name     | NR Base Package                   |
| Value Package Identity | FAJ 801 4002                      |
| Node Type              | Baseband Radio Node               |
| Access Type            | NR                                |
| Impact at Upgrade      | Mandatory                         |

Summary and Benefits

This feature enhancement allows lightweight neighbor cell relation objects to be

automatically promoted to visible MOs when the number of mobility attempts to a cell

reaches the configured threshold. All mobility attempts are counted, regardless of

success. This automatic promotion allows easier management of neighbor cell relation

objects.

A high number of visible MOs can lead to performance and memory issues. To avoid

this, the feature enhancement introduces automatic demotion of cell relation MOs

that are less utilized for mobility to lightweight neighbor cell relation

objects.

The feature enhancement also introduces ANR support for the NR Traffic Steering

feature, which eliminates the need for manual configuration of mobility triggered by

A5 and B1 measurement events.

The feature enhancement updates the promoteNRCellRelation MO

action to allow promotion even if the target cell is not an MO. Automatic promotion

can happen, even if the target cell is a lightweight object.

Capacity and Performance

The following PM events are updated:

- CuCpAnrNeighbRelAdd
- CuCpAnrNeighbRelRem

The following existing PM counters can be used to observe the impact of the feature

enhancement:

- NRCellCU.pmHoPrepAttOutInterGnb
- NRCellCU.pmHoPrepSuccOutInterGnb
- NRCellCU.pmHoPrepAttOutEutran
- NRCellCU.pmHoPrepSuccOutEutran
- NRCellCU.pmHoExeAttOutEutran
- NRCellCU.pmHoExeSuccOutEutran

The following existing KPIs can improve:

- NR-to-LTE Inter-RAT Handover success rate captured in source gNodeB
- NR Handover success rate captured in source gNodeB

Operation

The feature enhancement introduces the following attributes:

- AnrFunction.promoteCellRelMobAttThresh
- AnrFunction.demoteCellRelMobAttThresh
- GNBCUCPFunction.cellRelationMOThresh

The feature enhancement introduces the following PM counters:

- NRCellCU.pmAnrNeighbRelPromoteNr
- NRCellCU.pmAnrNeighbRelPromoteEutran
- NRCellCU.pmAnrNeighbRelPromoteRejNr
- NRCellCU.pmAnrNeighbRelPromoteRejEutran
- NRCellCU.pmAnrNeighbRelDemoteNr
- NRCellCU.pmAnrNeighbRelDemoteEutran

If the promoteLwNRCellRelation MO action is used with incorrect

information, this can lead to incorrect MO configuration. This is be corrected when

an Xn connection is set up, and if there is a RibTmRelation MO

related to the incorrectly configured ExternalNRCellCU MO, it is

removed during this process, since it can be automatically created again.

Hardware

No specific hardware requirements.

Interfaces

No impact.

Other Network Elements

It is recommended to use ENM version 23.2 23.05 or later to

support the MOM changes introduced by this feature enhancement. If the Release

Independence Manager application is used, the MOM changes are supported on earlier

ENM versions also.

Related Information

NR Automated Neighbor Relations

NR Traffic Steering

## Appendix A.o: 23.Q2: Automatic EN-DC X2 Setup Using X2 TNL Address Discovery to gNodeB with MORAN Configuration

This feature enhancement allows the Master Node to correct the inconsistent neighbor

configurations for NR cells with MORAN configuration.

| Feature Name           | NR Automated Neighbor Relations   |
|------------------------|-----------------------------------|
| Feature Identity       | FAJ 121 5218                      |
| Value Package Name     | NR Base Package                   |
| Value Package Identity | FAJ 801 4002                      |
| Node Type              | Baseband Radio Node               |
| Access Type            | NR                                |
| Impact at Upgrade      | Mandatory                         |

Summary and Benefits

This feature enhancement updates the X2 TNL Address Discovery procedure. The update

allows the Automatic Neighbor Relations feature on the eNodeB to create consistent

neighbor configuration for the cells hosted by a gNodeB with MORAN

configuration.

The feature enhancement introduces the following functions:

- An IP request can be sent from the MME to the gNodeB through a proxy Master Node for the hosted neighbor NR cell with MORAN configuration. The proxy Master Node can select the gNodeB based on the global gNodeB ID received from the NCGI measurement report of the cell with MORAN configuration sent from the UE.
- The Master Node can correct the inconsistent configuration of an external neighbor gNodeB with MORAN configuration.
- Automatic EN-DC X2 setup to the neighbor gNodeB with MORAN configuration.
- Selecting the correct IP address for EN-DC X2 setup between the eNodeB and the neighbor gNodeB with MORAN configuration when multiple IP addresses are configured for the operators.

If the ENodeBFunction.separateEngNBForMoranEnalbed is set to

true, a separate instance is sent to the MME for a connected

gNodeB hosting cells with MORAN configuration. As a result, the gNodeB has separate

instances for MORAN and non-MORAN configured cells in the list of

connected gNodeBs IE. The MME can identify the gNodeB from the global

gNodeB ID received from an NCGI measurement report for a cell with MORAN

configuration.

This feature enhancement has the following benefits:

- The number of successful EN-DC setups to a gNodeB with MORAN configuration increases.
- The need for manual configuration of LTE-to-NR cell relations is decreased.
- New NR cells with MORAN configuration can be introduced on the Master Node without specific neighbor cell relation planning.

Capacity and Performance

No impact.

Operation

For MORAN configuration, the NRCellDU.configuredEpsTAC attribute

must be configured in at least one non-MORAN and one MORAN cell for each operator.

The MME can identify the shared gNodeB from the global gNodeB ID sent in the NCGI

measurement report for a MORAN and non-MORAN cell. The PLMN of the MORAN and

non-MORAN cell has to be included in the Broadcast PLMN IE in

the list of connected gNodeBs IE. The Broadcast PLMN IE can be

included in each configured TAC. If the NRCellDU.configuredEpsTAC

attribute is not configured the PLMN is not updated and the target gNodeB ID cannot

be identified. As a result,  the MME is unable to find a proxy Master Node.

Interfaces

This feature enhancement updates the X2 interface as the following:

- The following IEs are updated on the X2 interface to indicate the PLMN for the selected IP network: Selected TAI on Source eNB ID in EN-DC SON Configuration Transfer Selected TAI on Source en-gNB ID in EN-DC SON Configuration Transfer
- The following messages are used to send the updated EN-DC SON Configuration Transfer IE: X2AP EN-DC CONFIGURATION TRANSFER

Hardware

No specific hardware requirements.

Other Network Elements

This feature enhancement requires the following network elements:

- ENM It is recommended to use ENM version 23.2 or later to support the MOM changes introduced by this feature enhancement. If the Release Independence Manager application is used, the MOM changes are supported on earlier ENM versions also.
- MME The MME must be compliant with 3GPP TS 36.413 15.5.0 or above and support the X2 TNL address discovery procedure for a candidate gNodeB.
- UE The UE must be compliant with 3GPP TS 36.331 15.3.0 or above to support the RRC protocol and support the reporting of the CGI measurement on LTE and NR cells.

Related Information

NR Automated Neighbor Relations

## Appendix A.p: 24.Q1.0: ANR-Specific Threshold for Creating LTE-to-NR Neighbor Cell Relations

The feature enhancement makes it possible to configure an ANR-specific threshold on

the eNodeB to avoid creating LTE-to-NR neighbor cell relation to NR cells with poor radio

link quality.

| Feature Name           | NR Automated Neighbor Relations   |
|------------------------|-----------------------------------|
| Feature Identity       | FAJ 121 5218                      |
| Value Package Name     | NR Base Package                   |
| Value Package Identity | FAJ 801 4002                      |
| Node Type              | Baseband Radio Node               |
| Access Type            | NR                                |
| Impact at Upgrade      | Optional                          |

Summary and Benefits

By configuring the ANR-specific threshold on the eNodeB, LTE-to-NR neighbor cell

relations are only created to NR cells in which the radio link quality is above the

configured threshold. The ANR-specific threshold is used in the evaluation of the B1

measurement report in the eNodeB to prevent the creation of an LTE-to-NR cell

relation for EN-DC setup and for outgoing IRAT mobility to NR cells with poor radio

link quality.

The ANR-specific threshold is configurable on the eNodeB either on a node level or on

a frequency relation level. For both, the trigger quantity can be either RSRP or

RSRQ, depending on the configuration. If the trigger quantity is set to RSRP, the

ANR-specific threshold for RSRP is used. If the trigger quantity is set to RSRQ, the

ANR-specific threshold for RSRQ is used. Configuration on the frequency relation

level makes it possible to consider frequency level characteristics for the

following NR frequency bands:

- Low-Band
- Mid-Band
- High-Band

With the application of the ANR-specific threshold on the eNodeB, NR cells with

insufficient radio link quality can be filtered from cell relation creation. This

way, LTE-to-NR neighbor cell relation-handling is improved because the need to block

or remove NR cells with poor radio quality in cell relations can be reduced.

Capacity and Performance

The INTERNAL\_EVENT\_ANR\_NR\_EVAL PM event is triggered when cell

relation addition is prevented because of a weak target cell.

The following PM counters are stepped when cell relation addition is prevented due to

a weak target cell:

- EUtranCellFDD.pmAnrNrNoActionTooWeak
- EUtranCellTDD.pmAnrNrNoActionTooWeak
- GUtranFreqRelation.pmAnrNrNoActionTooWeak

Operation

No impact.

Hardware

No impact.

Interfaces

No impact.

Other Network Elements

It is recommended to use ENM version 24.1 or later to support the

MOM changes introduced by this feature enhancement. If the Release Independence

Manager application is used, the MOM changes are supported on earlier ENM versions

also.

Related Information

NR Automated Neighbor Relations

## Appendix A.q: 24.Q2.0: Dynamic Handling of NR Frequency Relations

A change in the frequency of an NR neighbor cell can automatically be updated in the

NR neighbor configuration of the eNodeB. Unused LTE frequency and frequency relation MO

instances in band 48 can automatically be cleaned up on the

gNodeB.

| Feature Name           | NR Automated Neighbor Relations   |
|------------------------|-----------------------------------|
| Feature Identity       | FAJ 121 5218                      |
| Value Package Name     | NR Base Package                   |
| Value Package Identity | FAJ 801 4002                      |
| Node Type              | Baseband Radio Node               |
| Access Type            | NR                                |
| Impact at Upgrade      | Optional                          |

Summary and Benefits

This feature enhancement allows the eNodeB to automatically update NR frequency

relations and cell relations. When the eNodeB receives a message over the X2

interface that contains information about a changed NR frequency of an existing

neighbor cell, the eNodeB automatically updates the related neighbor relations.

The feature enhancement allows the gNodeB to automatically clean up unused LTE

frequency and frequency relation MO instances in band 48.

These improvements improve OPEX by automatic removal of unused

EUtranFreqRelation and EUtranFrequency MO

instances in band 48.

Capacity and Performance

The following PM counters can increase because the neighbor configuration on the

eNodeB is automatically updated:

- NRCellCU.pmEndcSetupUeAtt
- NRCellCU.pmEndcSetupUeSucc
- NRCellCU.pmEndcSetupScgUeAtt
- NRCellCU.pmEndcSetupScgUeSucc
- NRCellCU.pmEndcCaConfigAtt
- NRCellCU.pmEndcCaConfigSucc

The following EBS counters associated with the NRCellCU MO can

increase because the neighbor configuration on the eNodeB is automatically

updated:

- pmEbsEndcSetupScgUeAtt
- pmEbsEndcSetupScgUeSucc
- pmEbsEndcSetupUeAtt
- pmEbsEndcSetupUeSucc
- pmEbsEndcSetupDrbAtt
- pmEbsEndcSetupScgDrbAtt

The neighbor configuration is automatically updated on the eNodeB and mobility

without PSCell change is performed for a changed frequency. Because of this, the

following PM counters can increase:

- NRCellCU.pmEndcMnHoPSCellKeepAtt
- NRCellCU.pmEndcMnHoPSCellKeepSucc

Operation

The AnrFunction.removeEUtranFreqRelTime attribute is introduced to

configure when unused LTE frequency relations in band 48 are removed.

Interfaces

No impact.

Hardware

No specific hardware requirements.

Other Network Elements

It is recommended to use ENM version 24.2 or later to support the

MOM changes introduced by this feature enhancement. If the Release Independence

Manager application is used, the MOM changes are supported on earlier ENM versions

also.

Related Information

NR Automated Neighbor Relations

## Appendix A.r: 25.Q1.0: Support for gNodeB Blocklist in gNodeB

The feature enhancement introduces the gNodeB blocklist, which allows the operator to

prevent Xn connections to specific gNodeBs.

| Feature Name           | NR Automated Neighbor Relations   |
|------------------------|-----------------------------------|
| Feature Identity       | FAJ 121 5218                      |
| Value Package Name     | NR Base Package                   |
| Value Package Identity | FAJ 801 4002                      |
| Node Type              | Baseband Radio Node               |
| Access Type            | NR                                |
| Impact at Upgrade      | Optional                          |

Summary and Benefits

The feature enhancement allows the blocking of selected gNodeBs by including them in

a gNodeB blocklist. When a gNodeB is included in the gNodeB blocklist, existing Xn

connections are removed and no new EN-DC X2 connections are set up. Direct packet

forwarding can be blocked during the following procedures:

- NG-based inter-gNodeB handover
- Inter-gNodeB PSCell change

The feature enhancement improves OPEX by allowing the restriction of Xn connections

to gNodeBs with poor coverage or incompatible design.

Capacity and Performance

DRB Retainability KPIs might decrease because of an increased number of abnormal

releases during Xn connection removal caused by the gNodeB blocklist.

The increased number of Xn setup failures after setting up the gNodeB blocklist can

be observed through the CuCpXnSetupFailure PM event.

The abnormal release of UEs and DRBs might increase when an Xn connection to a gNodeB

included in the blocklist is removed. This might lead to an increase in the

following PM counters:

- NRCellCU,pmUeCtxtRelAbnormalGnb
- NRCellCU.pmUeCtxtRelAbnormalGnbAct
- NRCellCU.pmUeCtxtRelAbnormalGnbInact
- NRCellCU.pmDrbRelAbnormalGnb5qi
- NRCellCU.pmDrbRelAbnormalGnbAct5qi
- NRCellCU.pmDrbRelAbnormalGnbActArp
- NRCellCU.pmDrbRelAbnormalGnbArp
- NRCellCU.pmDrbRelAbnormalGnbInact5qi
- NRCellCU.pmPduSessionRelAbnormalGnb
- NRCellCU.pmNrdcRelUeSnAbnormalMnInit
- NRCellCU.pmNrdcRelUeSnAbnormalMnInitAct
- NRCellCU.pmNrdcRelUeSnAbnormalSnInit
- NRCellCU.pmNrdcRelUeSnAbnormalSnInitAct

The increased number of abnormal releases might also lead to an increase of the

following EBS counters associated with the NRCellCU MO:

- pmEbsDrbRelAbnormalGnb5qi
- pmEbsDrbRelAbnormalGnbAct5qi
- pmEbsDrbRelAbnormalGnbInact5qi
- pmEbsDrbRelAbnormalGnbActCauseGrpNgCause
- pmEbsDrbRelAbnormalGnbCauseGrpNgCause
- pmEbsDrbRelAbnormalGnbInactCauseGrpNgCause
- pmEbsPduSessionRelAbnormalGnb

For more information on EBS counters associated with the feature, see Lists and Delta Lists.

Operation

The feature enhancement introduces the

GNBCUCPFunction.blockedGNodeBList attribute to allow the

configuration of the gNodeB blocklist.

The following PM events are updated to allows the monitoring of Master Node and

Secondary Node releases caused by the Xn connection removal:

- CuCpProcMnNrdcRelease
- CuCpProcSnNrdcRelease

The following PM events are updated to increase after abnormal UE release when the Xn

connection is removed:

- NRCellCU.pmNrdcRelUeSnAbnormalSnInit
- NRCellCU.pmNrdcRelUeSnAbnormalSnInitAct

Interfaces

- X2 The X2AP SGNB ADDITION REQUEST and the X2AP SGNB ADDITION REQUEST ACKNOWLEDGE messages are updated to allow the blocking of direct packet forwarding.
- NG The NGAP HANDOVER REQUIRED and the NGAP HANDOVER REQUEST ACKNOWLEDGE messages are updated to allow the blocking of direct packet forwarding.
- Xn The XN SETUP FAILURE message is updated with the misc - O&amp;M intervention cause for cases when Xn setup fails because the target gNodeB is included in the gNodeB blocklist. The following messages are updated to allow the blocking of direct packet forwarding: XNAP S-NODE ADDITION REQUEST XNAP S-NODE ADDITION REQUEST ACKNOWLEDGE XNAP S-NODE CHANGE REQUIRED

Hardware

Blocking direct packet forwarding is only supported to and from gNodeBs, that use a

RAN Compute unit in RAN Compute group 4 or higher.

Other Network Elements

It is recommended to use ENM version 24.4 or later to support the

MOM changes introduced by this feature enhancement. If the Release Independence

Manager application is used, the MOM changes are supported on earlier ENM versions

also.

Related Information

NR Automated Neighbor Relations

## Appendix A.s: 25.Q2.0: PLMN-Specific gNodeB ID Length Support for NR Automated Neighbor Relations in NR Standalone

This feature enhancement introduces support for multiple PLMN-specific gNodeB ID

lengths in the same network.

| Feature Name           | NR Automated Neighbor Relations   |
|------------------------|-----------------------------------|
| Feature Identity       | FAJ 121 5218                      |
| Value Package Name     | NR Base Package                   |
| Value Package Identity | FAJ 801 4002                      |
| Node Type              | Baseband Radio Node               |
| Access Type            | NR                                |
| Impact at Upgrade      | Optional                          |

Summary and Benefits

This feature enhancement enables a consistent NR neighbor relation configuration that

has a different gNodeB ID length. It is achieved by configuring the PLMN-specific

gNodeB ID length on the source gNodeB. When the ANR creates an NR neighbor relation

configuration for a received NCGI, the specified gNodeB ID length for the PLMN is

applied to the newly created neighbor relation configuration.

OPEX can also be improved through the automatic maintenance of the neighbor relations

between the nodes that are configured with different gNodeB ID lengths.

Capacity and Performance

The following PM counters and KPIs might improve for the automatically created

neighbor cells with different gNodeB ID lengths:

- The NRCellCU.pmHoExeAttOutInterGnb PM counter
- The NRCellCU.pmHoExeSuccOutInterGnb PM counter
- The DRB Retainability - Percentage of Active Lost per mapped 5QI without outgoing inter-gNodeB HO UEs, gNodeB triggered only 24.Q4 and later KPI
- The NR Handover success rate captured in source gNodeB KPI

Memory usage can be more efficient if ANR manages the neighbor relation configuration

as a lightweight NR neighbor relation for cells with different gNodeB ID lengths

instead of relying on the manual configuration of the MO instances.

If the automatically created neighbor cell with a different gNodeB ID length is used

for PSCell change on the source Secondary gNodeB and the Master eNodeB maintains a

correct NR neighbor relation configuration for the target PSCell with a different

gNodeB ID length, the following PM counters and KPIs might improve:

- The NRCellCU.pmEndcPSCellChangeSuccInterSgNB PM counter on the source PSCell
- The NRCellCU.pmEndcPSCellChangeResAllocReqInterSgNB and the NRCellCU.pmEndcPSCellChangeResAllocSuccInterSgNB PM counters on the target PSCell
- The EN-DC inter-sgNodeB PSCell Change success rate captured in gNodeB KPI
- The SCG Active Radio Resource Retainability considering EN-DC connectivity, Captured in gNodeB KPI

For more information on the KPIs associated with the feature enhancement, see

Key Performance Indicators.

The size of the NRCellCU.lwNeighborRel attribute increases

slightly because the PLMN and the gNodeB ID length are newly considered for the

known and the unknown neighbor configuration decisions.

Operation

This feature enhancement introduces the AnrPLMNTable MO class for

configuring the gNodeB ID length for each PLMN differently.

This feature enhancement introduces the following attributes:

- AnrPLMNTable.anrPLMNTableId
- AnrPLMNTable.gNBIdLength
- AnrPLMNTable.pLMNIdList

To enable this feature enhancement, the following attributes must be set to the same

value as the PLMN-specific neighbor node configuration:

- AnrPLMNTable.gNBIdLength
- AnrPLMNTable.pLMNIdList

This feature enhancement modifies the following PM events by adding the

neighbor\_gnb\_id and the neighbor\_gnb\_id\_length

event parameters:

- CuCpAnrNeighbRelAdd
- CuCpAnrNeighbRelRem

For more information on the events associated with the feature enhancement, see

Lists and Delta Lists.

The operator must remove the existing inconsistent neighbor relation configurations

with an invalid gNodeB ID length manually after configuring the

AnrPLMNTable.gNBIdLength and the

AnrPLMNTable.pLMNIdList attributes. This step must be done

for ANR to configure the NR neighbor configuration with a correct gNodeB ID length.

Otherwise, the NR neighbor configuration cannot be created since it is regarded as a

known cell relation.

This feature enhancement is applicable for NR standalone in Low-Band and Mid-Band

deployments.

Interfaces

No impact.

Hardware

No specific hardware requirements.

Other Network Elements

- ENM Without the Release Independence Manager application, this feature enhancement requires ENM version 25.2 or later. The Release Independence Manager application also supports the feature enhancement on earlier supported ENM versions.
- UE The UE must support the nr-CGI-Reporting and the longDRX-Cycle parameters for NCGI measurements.

Related Information

NR Automated Neighbor Relations