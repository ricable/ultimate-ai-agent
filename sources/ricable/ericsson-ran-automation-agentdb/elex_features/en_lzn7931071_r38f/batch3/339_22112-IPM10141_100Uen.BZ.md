---
complexity_score: 115.0
converted_at: '2025-08-13T06:58:05.255384Z'
file_type: html
format: html
image_processing_enhanced: true
images_extracted: 126
images_saved: 3
original_path: 339_22112-IPM10141_100Uen.BZ.html
pictures_extracted: 126
processing_method: docling_multimodal
quality_score: 9.0
source_file: 339_22112-IPM10141_100Uen.BZ.html
source_zip: en_lzn7931071_r38f.zip
tables_extracted: 92
zip_image_types:
- .svg
- .png
- .gif
- .jpg
- .bmp
zip_images_total: 2796
---

# 

NR SA Connectivity Guideline with Option 2

Contents

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

|    1 | Introduction                                                                                         |
|------|------------------------------------------------------------------------------------------------------|
| 1.1  | Scope                                                                                                |
| 2    | Principles and Guidelines                                                                            |
| 2.1  | NR SA Option 2 Architecture                                                                          |
| 2.2  | Deployment Scenarios                                                                                 |
| 2.3  | gNodeB Architecture                                                                                  |
| 2.4  | NR NSA and NR SA within the same Cell                                                                |
| 2.5  | NR and LTE Core Interworking                                                                         |
| 2.6  | Voice Service                                                                                        |
| 2.7  | UE Mobility                                                                                          |
| 2.8  | Network Slicing                                                                                      |
| 2.9  | Mixed Mode Baseband                                                                                  |
| 2.1  | Mixed Mode Radio                                                                                     |
| 2.11 | Migration from NR NSA to NR SA + NSA                                                                 |
| 2.12 | Multiple IP Addresses per RAN Interface                                                              |
| 2.13 | Automatic Xn-C Connection Setup with Automated Neighbor     Relations                                |
| 2.14 | ANR for IRAT Mobility                                                                                |
| 2.15 | NG-C Connection Setup with AMF FQDN                                                                  |
| 2.16 | NR Multiple TNL Associations                                                                         |
| 2.17 | NR SA Deployment Consideration                                                                       |
| 3    | Network Elements                                                                                     |
| 3.1  | Baseband units                                                                                       |
| 3.2  | Radio units                                                                                          |
| 3.3  | Routers                                                                                              |
| 4    | Example Network Designs                                                                              |
| 4.1  | NR SA + LTE Scenario: C-RAN with Trusted L2 Access     Network                                       |
| 4.2  | NR SA + NR NSA + LTE Scenario: C-RAN with Baseband Hotel     Router in Trusted Backhaul              |
| 4.3  | NR SA + NR NSA + LTE Scenario: C-RAN Network with RAN     Processor 6672                             |
| 4.4  | NR SA + NR NSA + LTE Scenario: D-RAN with Untrusted     Backhaul                                     |
| 4.5  | NR SA + NR NSA + LTE Scenario: D-RAN with Mixed Mode Baseband     in Trusted MBH                     |
| 4.6  | NR SA + NR NSA + LTE Scenario: D-RAN with RAN Processor     6672                                     |
| 4.7  | NR SA+ NR NSA+LTE Scenario: IPv4-based NSA + IPv6-based     SA                                       |
| 4.8  | NR SA + NR NSA + LTE Scenario: Traffic Separation with     Different IP Addresses Over the Same VLAN |
| 4.9  | NR-NR Dual Connectivity (NR-DC) + EN-DC Scenario: D-RAN with     Trusted Backhaul                    |
| 4.1  | NR-DC + Direct IPsec VPN for Xn                                                                      |
| 4.11 | NR SA Network Slicing Examples                                                                       |
| 5    | Solution Guideline Change History                                                                    |

# 1 Introduction

The purpose of this document is to support solution architects to understand the connectivity of NR Standalone (SA) networks with Option 2.

The intended audience of this document is solution architects and field technicians performing node integration.

## 1.1 Scope

This document covers the following aspects:

- Planning information about connectivity network design aspects supporting the high-level design phase.
- Concepts and deployment considerations of the NR SA architecture together with an LTE or an NR NSA network.
- Overview of the hardware and software requirements for mid-band and low-band NR deployment.
- Design examples of RAN site connectivity.

# 2 Principles and Guidelines

## 2.1 NR SA Option 2 Architecture

The figure below shows the NR SA option 2 architecture and the LTE option 1 architecture. In theory, an NR SA network can be deployed independently from an LTE network.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 1   NR SA Option 2 and LTE Option 1 Architecture

- In NR SA, the following interfaces are used:
    - NG-C for control plane traffic between the gNodeB and the 5GC
    - NG-U for user plane traffic between the gNodeB and the 5GC
    - Xn-C for control plane traffic between neighboring gNodeBs
    - Xn-U for user plane traffic between neighboring gNodeBs
- In LTE, the following interfaces are used:
    - S1-C for control plane traffic between the eNodeB and the EPC
    - S1-U for user plane traffic between the eNodeB and the EPC
    - X2-C for control plane traffic between neighboring eNodeBs
    - X2-U for user plane traffic between neighboring eNodeBs

## 2.2 Deployment Scenarios

The NR SA network can be deployed independently or together with an existing LTE or NR NSA network.

In the early introduction of the NR SA network, the NR SA network is deployed with an existing LTE or NR NSA network for better coverage. This document focuses on the following deployment scenarios:

- LTE + NR NSA + NR SA
- LTE + NR SA

There are three possible types of UEs with varied network capabilities. Within all the suitable and supported networks, the UE selects the default network to camp on. SA UEs and EN-DC capable UEs are backwards compatible.

Below table shows the UE capabilities in different networks.

| UE Type          | LTE Network   | NR NSA Network   | NR SA Network   | Default Network   |
|------------------|---------------|------------------|-----------------|-------------------|
| LTE UE           | Compatible    | Incompatible     | Incompatible    | LTE               |
| EN-DC capable UE | Compatible    | Compatible       | Incompatible    | NR NSA            |
| SA UE            | Compatible    | Compatible       | Compatible      | NR SA             |

Below figure shows the deployment scenario of LTE, NR NSA, and NR SA.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 2   Deployment Scenario of LTE + NR NSA + NR SA

The N26 and the S5 interfaces are used for interworking between the 5G EPC and the 5GC.

- The LTE network consists of eNodeB\_1, eNodeB\_2, and the 5G EPC. The LTE RAN can serve all three types of UEs. The LTE UE connects to the 5G EPC by LTE RAN by default.
- The NR SA network consists of gNodeB\_1, gNodeB\_2, and the 5GC. The SA UE connects to the 5GC by the NR RAN by default.
- The NR NSA network configuration allows EN-DC connection by eNodeB\_2 and gNodeB\_1 for EN-DC capable UEs. The EN-DC capable UE connects to the 5G EPC by eNodeB\_2 and gNodeB\_1. The eNodeB\_2 is the anchor node.

Below figure shows the deployment scenario of LTE and NR SA.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 3   Deployment Scenario of LTE + NR SA

There is no X2 configured between the eNodeB and the gNodeB. The N26 and the S5 interfaces are used for interworking between the 5G EPC and the 5GC.

- The LTE network consists of eNodeB\_1, eNodeB\_2, and the EPC. The LTE RAN can serve all three types of UEs.
- The NR SA network consists of gNodeB\_1, gNodeB\_2, and the 5GC. The NR RAN can only serve SA UEs. The SA UE connects to gNodeB\_1 or gNodeB\_2 by default.

## 2.3 gNodeB Architecture

The gNodeB has the following managed elements:

- gNB-CU-CP
- gNB-CU-UP
- gNB-DU

Below figure shows the Embedded Mode gNodeB.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 4   Embedded Mode gNodeB

- gNB-CU-CP: gNodeB Central Unit Control Plane, a logical node hosting the RRC and the control plane.
- gNB-CU-UP: gNodeB Central Unit User Plane, a logical node hosting the user plane.
- gNB-DU: gNodeB Distributed Unit, a logical node hosting the RLC, MAC, and PHY layers.

The LTE application MO branch of the eNodeB is the following:

- ENodeBFunction

The NR application MO branches of the gNodeB are the following:

- GNBCUCPFunction
- GNBCUUPFunction
- GNBDUFunction

Below figure shows the MO branches of the eNodeB and the gNodeB.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 5   Different MO Branches of eNodeB and gNodeB

## 2.4 NR NSA and NR SA within the same Cell

Below figure shows the coexistence of NR NSA and NR SA within one NR cell. The NSA and SA dual mode NR cell serves EN-DC-capable UEs and SA-capable UEs simultaneously.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 6   NR NSA and NR SA in the Same NR Cell

An EN-DC capable UE connects to the eNodeB and the gNodeB in EN-DC connection mode. The eNodeB is the LTE anchor node. The EN-DC capable UE can receive user plane traffic simultaneously from the eNodeB and the gNodeB. The control plane traffic is transferred through the eNodeB.

The control plane and user plane traffic received by the SA-capable UE are sent through the gNodeB.

Both the EN-DC-capable UE and the SA-capable UE can connect to the same NSA and SA dual mode NR cell. The UE configuration type is identified by Msg3. For the EN-DC-capable UE, the UE session context is sent from eNodeB to the gNodeB by RRC reconfiguration message before the gNodeB RACH procedure. If the gNodeB can find the UE session context associated with C-RNTI (Radio Network Temporary Identity) in Msg3 during the initial access procedure, then it is an EN-DC-capable UE. Otherwise, it is a SA-capable UE.

An NR cell can be configured to support SA and NSA capability. Each NR cell can be configured for the following modes:

- NSA only
- SA only
- SA and NSA dual mode

For SA mode, the SIB1 is configured to transmit in NR cell. The SA capable UE can camp, receive, and decode configuration information via SIB1. The Tracking Area Code (TAC) along with NR cell identity and PLMN identity are broadcast in SIB1. If NRCellDU.secondaryCellOnly MO instance is set to FALSE, the NR cell is configured to transmit SIB1 but can still serve EN-DC users if non-standalone is deployed. It depends on the presence of Tracking Area Code IE per PLMN-IdentityInfo, if Tracking Area Code IE is present, which means this NR cell is accessible for any SA capable UEs served by such PLMN, otherwise, it is only accessible for EN-DC UEs served by such PLMN, while EN-DC ANR is possible in such a case for such NSA only PLMN. There can be up to 12 PLMN-IdentityInfo IEs configured in SIB1 of each NR cell.

If the NRCellDU.secondaryCellOnly MO instance is set to TRUE, the NR cell isn't configured to transmit SIB1, then below use cases can be supported:

- Cell can be configured as a PScell with NSA mode in FR1 and FR2.
- Cell can be configured as a SCell with NSA mode in NR FR1 Downlink Carrier Aggregation.
- Cell can be configured as a SCell with NSA mode in NR FR2 Downlink and Uplink Carrier Aggregation.
- Cell can be configured as a SCell with SA mode in NR FR1 and FR2 Downlink and Uplink Carrier Aggregation, since SCell does not require SIB1 transmission.

For NSA only NR cell, X2-C/U and S1-U interface need to be configured, Ng-C/U and Xn-C/U (optionally) interfaces need to be configured for SA only NR cell. While for NSA and SA dual mode NR cell, all needed interfaces should be configured properly.

The cellState of any NR cell is related to the status of the configured external link types (X2-C, NG-C and Xn-C) towards the gNodeB. This feature gives flexibility to configure the link types when calculating the values of cellState on per-cell basis within the same node. This functionality enables the operator to select which interfaces are to be used when deciding the cellState for each cell based on the requirement specified by MOM attribute NRCellCU.interfaceSupervision added to NRCellCU MO Class to set which link types are considered during NRCellCU.cellState calculation.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 7   MO attribute InterfaceSupervision added to the NRCellCU MO Class

The value of NRCellCU|cellState will be evaluated every time the status of a link is changed, and every time the value of NRCellCU.interfaceSupervision is changed. Below Table shows the link types defined while selection of cellState values in NRCellCU MO Class:

| interfaceSupervision value   | Description                                                                                                                                       |
|------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| ALL_LINKS                    | NRCellCU::cellState is based on overall X2, NG and Xn availability. If any X2, NG or Xn links are available, NRCellCU::cellState is always ACTIVE |
| NO_SUPERVISION               | No interfaces are considered and NRCellCU::cellState is always ACTIVE                                                                             |
| NG_ONLY                      | NRCellCU::cellState is based on NG availability. If any NG links are available, NRCellCU::cellState is always ACTIVE                              |
| X2_ONLY                      | NRCellCU::cellState is based on X2 availability. If any X2 links are available, NRCellCU::cellState is always ACTIVE                              |
| XN_ONLY                      | NRCellCU::cellState is based on Xn availability. If any Xn links are available, NRCellCU::cellState is always ACTIVE                              |
| NG_X2_COEXISTENCE            | NRCellCU::cellState is based on overall X2 and NG availability. If any NG or X2 links are available, NRCellCU::cellState is always ACTIVE         |
| NG_XN_COEXISTENCE            | NRCellCU::cellState is based on overall NG and Xn availability. If any NG or Xn links are available, NRCellCU::cellState is always ACTIVE         |
| X2_XN_COEXISTENCE            | NRCellCU::cellState is based on overall X2 and Xn availability. If any X2 or Xn links are available, NRCellCU::cellState is always ACTIVE         |

The value must be considered when creating a cell otherwise, the default value ALL\_LINKS is used. For RAN sharing case, Mobile Network operators sharing the cell, need to agree on the configured values. For more information, see Shared NR RAN Solution Guideline.

Note: NRCellCU.interfaceSupervision does not apply for ESS cells and always have their cellState attribute set to ACTIVE.

Related Information:

Manage Radio Network

Configurable Cell State Handling (NIR)

## 2.5 NR and LTE Core Interworking

The interworking between NR/5GC and LTE/EPC is important in the early deployment of the NR SA with option 2 network. The goal is to achieve service continuity, when UE needs to fallback from NR SA to LTE. This interworking solution could provide UE better experience.

### 2.5.1 NR/5GC and LTE/EPC Inter-Working Architecture

Below figure shows that NR/5GC and LTE/EPC inter-working architecture, which involves both RAN and Core.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 8   NR/5GC and LTE/EPC Interworking Architecture

#### 2.5.1.1 IRAT Interworking between the eNodeB and gNodeB

The IRAT interworking between the eNodeB and the gNodeB is to order the SA UE to do the proper mobility between LTE and NR SA in connected mode. There are three available methods: blind Release with Redirect (RwR), measurement-based RwR, measurement-based Handover. The table below is a summary of the recommended interworking methods from NR SA to LTE in terms of use cases.

| Methods               | Pros                                      | Cons                                                     | Recommended Use Case                     |
|-----------------------|-------------------------------------------|----------------------------------------------------------|------------------------------------------|
| Blind RwR             | Easy to deployment                        | LTE and NR SA coverage optimization needed in Radio site | Emergency call of Non-VoNR capable UE    |
| Measurement-based RwR | Higher successful rate of fallback        | Neighbored cells design optimization needed              | Normal Voice call of Non-VoNR capable UE |
| IRAT handover         | Shorter time of data service interruption | Complex network deployment                               | NR SA Poor Coverage                      |

Measurement-based RwR is used for the mobility from LTE to NR SA when NR SA has goodcoverage and NR SA UE does not have an ongoing VoLTE call.

#### 2.5.1.2 N26 Interface

The interworking between the Mobility Management Entity (MME) and the Access andMobility Management Function (AMF) is implemented by the N26 interface, whichprovides session continuity. During UE mobility between the 5GC and the EPC, the UEcontext is transferred through the N26 interface. This includes information aboutsecurity context, identities, and ongoing sessions.

If there is UE mobility between NR and LTE, the UE connected network is switched from NR to LTE. The User Plane Function (UPF) remains the anchor point during mobilityand maintains the IP address assigned to the UE.

#### 2.5.1.3 S5 Interface

S5-C is the interface between the Serving Gateway (SGW) and the Session ManagementFunction (SMF). The SMF handles the control plane traffic.

S5-U is the interface between the SGW and the UPF. The UPF handles the user planetraffic. The S5-U interface ensures that the UE is served by the common UPF,regardless of the UE connecting to LTE or NR.

#### 2.5.1.4 HSS-UDM Interface

HSS-UDM is the interface between the HSS and the UDM, which handles the UE mobility.When the UE attaches EPC from 5GC, the HSS notifies the UDM to performderegistration at AMF. When the UE attaches 5GC from EPC, the UDM notifies HSS toperform deregistration at MME.

### 2.5.2 Dual-Mode Core Architecture

5G Dual-Mode Core providing the combined solution for 5GC and EPC functionalities into acommon platform, which support NR SA, NSA and LTE access technologies.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 9   Dual-Mode Core Architecture

The Dual-Mode Core supports the following control plane functions:

- AMF
- MME
- SMF
- PGW-C
- SGW-C

The Dual-Mode Core supports the following user plane functions:

- UPF
- PGW-U
- SGW-U

The UDM and HSS in Dual-Mode Core support subscription management for both NR and LTE.

In the Dual-Mode Core architecture, the N26, S5, and HSS-UDM are all internal interfaces, which simplify the core network architecture. Moreover, the Dual-Mode Core combines the 5GC and EPC functions in one node that makes the core network integration easy.

## 2.6 Voice Service

There are two kinds of voice solution in NR SA network. One is the EPS fallback solution, the other is the VoNR solution. The EPS fallback solution relies on the VoLTE capability in the LTE network, and the interworking design between NR/5GC and LTE/EPC. Differently, the VoNR solution is independent from the LTE network. It only relies on the NR SA network. Hence, the network architecture of the VoNR solution is simpler than that of EPS fallback solution. When deploy the voice in NR SA network, it also needs to consider the mobility requirement, which has big impact on the user experience. Below recommendations are given for how to deploy the VoNR and EPS fallback solutions:

- The VoNR solution is recommended when the coverage of the NR SA network is good enough. For example, there is a regional or national wide NR SA network deployed.
- The EPS fallback voice is recommended in case of limited coverage of NR SA. For example, the NR SA is deployed in hot-spot area.

The normal call and emergency call are two different voice solutions. They have its own solution implementations. They are independent from each other.

### 2.6.1 EPS Fallback

#### 2.6.1.1 Normal Voice Call

Below figure shows the network architecture of the voice EPS fallback. The SA UE performs EPS fallback to LTE from NR, when thereis call request in Mobile-Orientating (MO) or Mobile-Terminated (MT) way.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 10   Voice EPS Fallback Architecture

- The UPF is the Common Gateway node, which is the gateway for both LTE and NR functions as the anchor point. The IP flows use the same Common Gateway, regardless of the UE using the LTE or the NR RAN. Therefore, the IP address of the UE can be maintained during NR and LTE switchover. The RAT change is not visible from an application perspective.
- The SMF and the UPF support the S5 interface.
- The N26 interface provides UE context information exchange between the MME and the AMF. When the voice call flow is set up, a new PDU Session Modify procedure is introduced. This procedure enables the modification of already established PDU sessions. The 5GC identifies if a voice call is set up.

The UE context is transferred through the N26 interface from the AMF to the MME. Data is buffered until a bearer in LTE is set up by the EPC for the UE. Then the gNodeB initiates the transfer of all PDU sessions from the 5GC to the EPC.

- gNodeB orders the UE to do the fallback to LTE through blind RwR, measurement-based RwR, or IRAT handover. From solution point view, it is recommended to use the measurement-based RwR because of the following facts:
    - Easy deployment and good performance in terms of call setup time and call establishment successful rate.
    - Data service interruption is acceptable when voice call is triggered.
- In Voice EPS Fallback Architecture, the "before voice call" part indicates the PDU session over NR before voice call setup. The "during voice call" part shows the EPS bearer over LTE after EPS fallback is used for the voice call setup. The Common Gateway stays the anchor point. The voice call flow traverses the Common Gateway to the IMS domain. When the voice call is finished, the UE moves back to the NR SA cell as the NR SA has higher priority than the LTE network. If the UE is in idle mode, cell reselection is used. If the UE is in connected mode, measurement-based release with direct Release with Redirect (RwR) is used to trigger IRAT mobility from LTE to NR SA. The UE contexts are transferred from MME to AMF through the N26 interface. The UE data sessions are transferred from EPC to 5GC. The UE session is maintained during this transition period.

#### 2.6.1.2 Emergency Call

The Emergency call solution uses the EPS fallback mechanism, as described in Service Request-Based Emergency Fallback. It assumes the following prerequisites for Emergency call:

- Emergency call is already deployed in the LTE network.
- Interworking between EPC and 5GCP through N26 and S5.
- IMS is shared by EPC and 5GC.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 11   Service Request-Based Emergency Fallback

When the emergency call is performed, the gNodeB orders the UE to fall back to the LTE RAT. The method of RwR is used during the transition from NR RAT to LTE RAT. The overall procedure is similar to the section  EPS Fallback.

### 2.6.2 Voice over NR

#### 2.6.2.1 Normal Voice Call in VoNR

Blow figure shows the network architecture of the VoNR solution. The UE can use both voice and data services simultaneously in NR SA network. When the voice service is triggered for the UE in connected mode, the UE can continue the existing the data service without interruption.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 12   VoNR Network Architecture

The PDU sessions of data and voice are independent from each other. The PDU session of voice is set up with two Data Radio Bearers (DRBs) towards UE as shown in below figure. The SIP DRB is for IMS signaling traffic and the Voice DRB is for voice data flow traffic.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 13   VoNR PDU Session

Since the voice data traffics must be prioritized in the transport network, it is important to set the proper QoS mapping from 5QI to DSCP for the voice service. For more information, refer to the document of E2E QoS Guideline.

#### 2.6.2.2 Emergency Call in VoNR

Emergency Call over NR uses the similar network architecture to normal VoNR. Both emergency calls and normal voice calls use 5QI 1 for voice data and 5QI 5 for IMS signaling. Both calls need to enable the support in UE, RAN, 5GC and IMS as described above figure in section  Voice over NR.

The Allocation and Retention Priority (ARP) of 5QI 1 or 5QI 5 is used to distinguish the emergency call from normal voice. The ARP values of emergency call are configurable in Baseband and must be aligned with 5GC's configurations. The ARP of emergency call needs to be smaller than that of normal voice call. For example, if the ARP value of normal VoNR is 9, the ARP value of emergency calls needs to be configured to less than 9, for example 6. The configuration for emergency calls is done through the EmCall.arpPrioEm5qi1List and the EmCall.arpPrioEm5qi5List parameters, which are used to distinguish emergency calls from normal voice calls in the RAN.

Emergency voice call traffic follows the same QoS policy as normal voice call traffic in the transport domain, since they use same 5QI values.

### 2.6.3 EPS Fallback Voice and Voice over NR Co-exist in
      gNB

To support the NR SA UE without VoNR capability, both VoNR and EPS fallback Voice solutions should be deployed in the NR SA network, as show in below Figure. It is recommended to set VoNR solution as higher priority than EPS fallback solution. UE 1 with VoNR capability could stay at NR SA for both voice and data services, while UE 2 without VoNR capability needs to do fallback to LTE network for voice.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 14   EPS Fallback Voice and VoNR Co-existing in NR SA

The UE behavior is configurable in gNB. It is recommended to set the value of MO McfbCellProfile.espFallbackOperation as ACTIVE\_MEAS\_RWR. When the UE supports VoNR capability, the VoNR solution will be used. If the UE does not support VoNR, the EPS fallback voice solution with measurement-based RwR method will be used.

## 2.7 UE Mobility

UE mobility is handled differently in idle mode and connected mode. The following sections describe the mobility design related to the NR SA network. For more information on 5G mobility, see 5G Mobility and Traffic Management Guideline. For more information on voice-related mobility, see  Voice Service.

### 2.7.1 RRC Inactive State

RRC Inactive State is introduced in NR SA deployment. When the UE is in RRC\_CONNECTED state, gNodeB can release the UE to RRC\_INACTIVE or RRC\_IDLE state. When in RRC\_INACTIVE state, the UE can return to RRC\_CONNECTED state as quickly and efficiently as possible.

When the UE is in RRC\_INACTIVE state, both the UE and gNodeB store the necessary information to resume the connection to RRC\_CONNECTED state, the UE suspends all Singling Radio Bearers (SRBs) and DRBs except SRB0, and the core network connection is maintained in RRC\_INACTIVE state. Below figure shows the RRC\_INACTIVE state.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 15   RRC\_INACTIVE State

### 2.7.2 Mobility in Idle Mode or RRC Inactive State

Cell reselection ensures that the UE in RRC idle mode or RRC inactive state camps on the best cell in terms of signal strength. When a neighbor cell with higher signal strength is available and meets the criteria, the UE processes the cell reselection.

After the cell reselection, the UE remains in RRC idle mode or RRC Inactive state. Below figure shows the UE mobility in RRC idle mode or RRC Inactive state.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 16   Mobility in RRC Idle Mode or RRC Inactive State

Below table shows the mobility directions in RRC idle mode or RRC Inactive state.

| Mobility Direction   | Mobility Description                                                                                  | Function                                                           |
|----------------------|-------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|
| NR to NR             | The UE camps on an NR SA cell and meets the cell reselection criteria, with continuous NR coverage    | Intra-Frequency Cell Reselection, Inter-Frequency Cell Reselection |
| NR to LTE            | The UE camps on an NR SA cell and meets the cell reselection criteria, without continuous NR coverage | IRAT Cell Reselection                                              |
| LTE to NR            | The UE that camps on an LTE cell moves to NR SA coverage                                              | IRAT Cell Reselection                                              |

### 2.7.3 NR to NR Handover in Connected Mode

The NR to NR handover supports both intra-frequency and inter-frequency cases as shown in below Figure. The IRAT mobility from NR SA to LTE is described in the next section.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 17   UE Mobility in Connected Mode

The intra-frequency handover is triggered by Event A3, when the neighbor cell becomes offset better than the serving cell. The inter-frequency is triggered by Event A5, when the serving cell becomes worse than one threshold1 and neighbor cell becomes better than another threshold2.

The intra-frequency handover has always higher priority than the inter-frequency handover. Only after intra-frequency handover fails to find a proper cell, interfrequency handover process starts.

The process for NR to NR handover is the following:

1. The source gNodeB requests the UE to measure the signal quality of the target cell.
2. The UE sends the measurement reports to the source gNodeB.
3. The source gNodeB makes the handover decision based on the measurement reports.
4. The source gNodeB hands over the UE to the target cell, if the handover criteria is satisfied.

The NR to NR handover can also been categories to intra-gNodeB and intergNodeB, as shown in below table.

| Mobility Direction                                                                    | Mobility Description                                                                                   | Function              |
|---------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|-----------------------|
| NR to NR, within the same gNodeB, as shown in below figure (Intra-gNodeB Handover)    | Both the serving cell and the target cell are in the same gNodeB. Event A3 or A5 triggers the handover | Intra-gNodeB Handover |
| NR to NR, between different gNodeBs, as shown in below figure (Inter-gNodeB Handover) | The serving cell and the target cell are in different gNodeBs. Event A3 or A5 triggers the handover    | Inter-gNodeB Handover |

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 18   Intra-gNodeB Handover

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 19   Inter-gNodeB Handover

In the figure above, the serving cell and the target cell belong to different gNodeBs. The NR RAN initiates an Inter-gNodeB Handover for the UE. There are two available options: NG based handover and Xn based handover. Both Xn based Handover and NG based Handover support direct packet forwarding over Xn-U interface, which reduces the traffic interruption during the handover. Both inter-frequency and intra-frequency cases are supported as well in two options.

Depending on the network situation, the source gNB decided to perform intra-gNB handover, Xn based handover or NG based handover. Below figure shows how the method of handover is determined when handover is triggered.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 20   Handover Method Decision Flow

In step 1, if target cell is one MO NRCellCU instance, then both serving cell and target cell are in same gNB. Otherwise, target cell should be one MO ExternalNRCellCU instance created manually or automatically.

In step 2, it needs to check if serving AMF region of target gNB: ExternalGNBCUCPFunction.amfRegionInfoList is also serving source gNB.

In step3, it needs to check if Xn connection between source gNB and target gNB: TermPointToGNodeB.operationalState is enabled.

### 2.7.4 IRAT Mobility between NR SA and LTE in Connected
      Mode

#### 2.7.4.1 LTE and NR IRAT Mobility Overview

When UE is in the poor coverage area of NR SA, IRAT mobility provides a session continuity solution of moving from NR SA to LTE.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 21   IRAT Mobility between NR SA and LTE in Connected Mode

Above figure shows the mobility of NR SA UE between NR SA and LTE in connected mode.

For the mobility from NR SA to LTE, the NR SA UE measures the quality of LTE cells when they are in a poor coverage area of NR SA, where the A2 report is received by the gNodeB. If the quality of an LTE cell is better than the threshold, the B2 event report is generated for this LTE cell. It is possible to have multiple candidate LTE cells in priority order. If the UE, the gNodeB, the eNodeB, the 5GC, and the EPC all support the IRAT handover, the IRAT handover procedure is triggered. Otherwise, the measurement base RwR is used for mobility from NR to LTE. If no candidate LTE cell found after the A2 event report, blind RwR from NR SA to LTE is performed.

For mobility from LTE to NR SA, The SA UE measures the quality of an NR SA cell when the UE is in overlapping coverage of LTE and NR SA. If the quality of the NR SA cell is better than the threshold for a certain time, the B1 event is triggered, if all preconditions are satisfied. The outgoing NR IRAT handover is triggered, otherwise, redirected to NR through the method of measurement-based RwR. For more information, see Outgoing NR IRAT Handover.

#### 2.7.4.2 Direct Packet Forwarding

The Outgoing NR IRAT Handover feature extends the existing IRAT Mobility between LTE and NR SA and enables the UE to transfer from the LTE network to the NR network while maintaining the data session.Below figure shows the direct packet forwarding through X2-U between source eNodeB and target gNodeB during outgoing NR IRAT handover. Indirect packet forwarding through N26 is not supported. EN-DC X2-U interface is required to be configured in both source eNodeB and target gNodeB to enable direct packet forwarding, legacy EN-DC X2-U configuration is reused in this use case. Otherwise, direct packet forwarding fails, and packet loss would occur during handover.

Direct packet forwarding can also be supported when source eNodeB and target gNodeB are defined within the same LTE+NR Mixed Mode Baseband scenarios, the X2-U can be defined in either intra-VR or inter-VR use cases.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 22   Outgoing IRAT Handover - Direct Packet Forwarding

## 2.8 Network Slicing

Network slicing enables multiple logical networks in one common physical network. One logical network is treated as one network slice. One network slice is used for one dedicated service use case, such as eMBB and IoT. For more information on the concept of network slicing, see NR SA Network Slicing Guideline.

### 2.8.1 Transport Connectivity Supporting Network Slice

From transport network point view, network slicing does not introduce any new RAN interface. The transport VPN design in section  Transport Network Consideration is still valid if the operator wants to use one VPN for all the RAN traffic of different network slices.

However, if the operator requires more stringent requirement on the traffic separation among network slices, one dedicated transport VPN (IP VPN or IPsec VPN connection) is considered for each slice as shown in below Figures. The shared AMF node can be connected to RAN through one of transport VPN. The connectivity design inside 5GC is not shown in these below Figures. The 5GC connectivity can follow the design in the beginning of the chapter  Example Network Designs.

Two solutions are supported to implement the above network design. The first one is to use one same IP interface of one same RAN interface for all the slice traffic in gNB. The other way is to use multiple IP addresses of one same RAN interface. This section is about the first method. For the second one, see  Multiple IP Addresses per RAN Interface.

Although gNodeB is aware of S-NSSAI information, there is no explicit configuration association between S-NSSAI and transport resource like IPsec VPN connection in gNodeB. The slice traffic steering relays on the IP routing design configured in manual way. The design is limited to the network slicing scenario, where each UPF is dedicated for one slice.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 23   Network Slice Traffic Separation, Trusted MBH

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 24   Network Slice Traffic Separation, IPsec Case

Each slice is characterized with the Service Level Agreement (SLA) in terms of throughput, latency, and packet loss in User Plane. Transport QoS mechanism is key to ensure the SLA of the slice. Although transport network does not support QoS mechanism associating with S-NSSAI, traffic classification based on the information in IP header can help differentiate the network slice performance in some cases. Below figure shows an example design of using the address of SEG or UPF as transport network identifier.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 25   Traffic QoS Mapping Example

In gNodeB, the received UE traffic is associated with S-NSSAI and 5QI in PDU session. Then the outer destination IP address of the traffic packet is filled with IP address of UPF or SEG. The DSCP value of IP packet is based on the 5QI mapping through either the standard QoS mapping by default or the specified QoS mapping per S-NSSAI defined by operator. Table in below figure gives an example of QoS Mapping for two network slices. The slice "1" maps the 5QI value of 9 to the DSCP value of 12 following the QoS requirement of the operator.

|   5QI Value | Resource Type   | QoS Mapping Method   |   DSCP Value |
|-------------|-----------------|----------------------|--------------|
|           1 | GBR             | Default              |           46 |
|           5 | Non-GBR         | Default              |           40 |
|           9 | Non-GBR         | Operator-Defined     |           12 |

|   5QI Value | Resource Type   | QoS Mapping Method   |   DSCP Value |
|-------------|-----------------|----------------------|--------------|
|           1 | GBR             | Default              |           46 |
|           5 | Non-GBR         | Default              |           40 |
|           9 | Non-GBR         | Default              |           14 |

In the RAN transport edge router, IP address of UPF or SEG is used to map the slice to transport network resource partition (for example, VPN). And DSCP value is mapped to Traffic Class (TC) queue, which is used to control the network performance.

Note: This design is only applicable to the network scenario where each slice has one dedicated UPF or SEG.The above figure shows only the Uplink traffic. In Downlink, similar approach can be achieved in CN edge router. The difference is that CN edge router should use the outer Source IP address (that is IP address of SEG or UPF) as transport Identifier.

## 2.9 Mixed Mode Baseband

Mixed Mode Baseband can run both NR and LTE RATs in one baseband node simultaneously. There is one common OAM interface for network management purpose in the Mixed Mode Baseband. One eNodeB function and one gNodeB function are defined. The architecture of the gNodeB consists of DU, CUCP, and CUUP logical node functions. In NR SA deployment case, the gNodeB function could be NR SA-only or NR SA+NSA coexistence, as shown in below figure.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 26   Mixed Mode Baseband NR + LTE

It is supported to use two separated Virtual Routers (VRs) in the Mixed Mode Baseband to support the separation of the traffic between LTE and NR. One is for LTE traffic, the other one is for NR traffic. It can ensure easy network operations since there is no direct network impact between NR and LTE.

It is also supported to use the same VR for both LTE and NR, which is also useful for such shared RAN case. In shared RAN case, it needs at least one virtual router per operator to ensure the traffic separation among different operators. If further two separated virtual routers for LTE and NR are set up, the total number of the required virtual router can be doubled, see related information.

For more information about solution design that meets the network standards, see Shared NR RAN Solution Guideline.

Related Information

TN Configuration Limit

## 2.10 Mixed Mode Radio

NR and LTE RATs has a common Mixed Mode Radio. It enables NR and LTE in the same radio unit, using the same antenna without external equipment. The typical use cases are the following:

- Two separated frequency bands: one for NR, another for LTE.
- One common frequency band for NR and LTE with fixed partition. For example, 20% for LTE and 80% for NR.
- Split mode of antennas in AIR products. For example, 32 antenna branches for NR and another 32 antenna branches for LTE configured in AIR 6488.

Below figure shows the connection cases of the Mixed Mode Radio to the baseband.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 27   Mixed Mode Radio Connection to Baseband

Case A shows the Mixed Mode Radio connected to the dedicated Baseband units for each RAT.

Case B shows the Mixed Mode Radio connected to the Mixed Mode Baseband in case of CPRI-based low-band and mid-band deployment.

## 2.11 Migration from NR NSA to NR SA + NSA

The migration from NR NSA to NR SA + NSA is necessary for NR SA introduction in an existing NR NSA network. The migration has the following conditions:

- There is an existing NR NSA deployment.
- NR SA has the same coverage as NR NSA.
- The migration has minimal impact on the existing NR NSA network.

The network migration path is shown in below Figure.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 28   NR NSA Migration to NR SA + NSA

The main impact of the migration is that new interfaces of NG and Xn are introduced on the gNodeB. Also, in the core network site, new 5GC system needs to be set up.

The migration is based on the function of NR SA and NR NSA co-existence within the same NR Cell.

Related Information

NR NSA and NR SA Within the Same Cell

### 2.11.1 Hardware and Software Requirements of the Migration

#### 2.11.1.1 Hardware

The migration has the following hardware requirements:

- The gNodeB is common for both NR SA and NR NSA. It is not necessary to add new baseband in the NR SA introduction. The eNodeB is not affected.
- NR SA and NR NSA have common NR radio unit. It is not necessary to add new radio unit in the NR SA introduction. The LTE radio unit is not affected.
- New 5GC is required to enable the NR SA network with option 2 in core network. 5G EPC is not changed.

Note: NR SA can share the same transport network with NR NSA. As a result, the transport network infrastructure does not upgrade. However, if there is no 5G EPC in the new core site, the new 5GC requires a new transport network to be built between the new core site and the NR Radio site.

#### 2.11.1.2 Software

The migration has the following software requirements:

- The gNodeB needs upgrade to support the function of the supporting NR SA and NR NSA co-existence in the NR cell.
- The eNodeB needs upgrade to support the Release with Redirect (RWR) function between NR SA and LTE for mobility purpose.
- The 5G EPC needs upgrade to support the Interworking Function with 5GC through the N26 and S5 interfaces.

Note: The licenses of software packages must be considered.

Related Information

UE Mobility |  NR and LTE Core Interworking

### 2.11.2 Migration Planning

The migration from NR NSA to NR SA + NSA is an end-to-end network upgrade activity. The network update involves the radio, core network, transport network, and ENM domains. A recommended overall network migration procedure is shown in below figure.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 29   Overall Network Migration Flow

1. Prepare the mobile backhaul network in one of the following ways:
    - Upgrade the transport network.
    - Set up the transport network according to the network connectivity and capacity dimensioning requirements.
2. Upgrade the ENM system to support the FCAPS (Fault, Configuration, Accounting, Performance, and Security) management functions of the NR SA network.
3. Set up the 5GC system.
    - The 5G EPC needs to be upgraded to support interworking with 5GC.
4. Migrate the RAN site.

This is the last step as it relies on the network readiness in other domains.

Note: The migration activity must be planned and executed carefully within each domain upgrade. The focus is on the RAN site migration in this document. The designs of core network, transport network, and ENM are not covered in this document.

The RAN migration solution is software-driven. Generally, there is no need to add additional hardware such as baseband, radio, or CSR, if the migration enables NR SA with the existing NR NSA in the same NR cell setup. As NR SA and NR NSA share common cell resource, the cell capacity does not increase.

Note: If new frequency spectrum is added and the advanced radio modulation is enabled, the new hardware assessment must be done in advance.

#### 2.11.2.1 Physical Connectivity

The physical connectivity of the RAN site does not need to be changed. From the fronthaul network perspective (CPRI or eCPRI), as the NR cell does not change, the connection of the radio unit to the baseband does not change either. The NR SA and NR NSA share a common NR Cell.

From the backhaul network perspective, the transport function is common for NR SA and NR NSA in the baseband. This means that the NR SA interfaces, such as Xn and NG, can also reuse the existing physical link.

#### 2.11.2.2 Logical Connectivity

The logical connectivity of the RAN site needs to be updated to meet the new connectivity requirements in the gNodeB. Below table lists the logical connectivity requirements in gNodeB before and after RAN migration.

| Local Application Interface   | Far End Application   | Before Migration   | After Migration   |
|-------------------------------|-----------------------|--------------------|-------------------|
| S1-U                          | SGW in 5G EPC         | YES                | YES               |
| EN-DC X2-C                    | Anchored eNodeB       | YES                | YES               |
| EN-DC X2-U                    | Anchored eNodeB       | YES                | YES               |
| OAM                           | ENM                   | YES                | YES               |
| NG-C                          | AMF in 5GC            | NO                 | YES               |
| NG-U                          | UPF in 5GC            | NO                 | YES               |
| Xn-C                          | Neighbored gNodeB     | NO                 | YES               |
| Xn-U                          | Neighbored gNodeB     | NO                 | YES               |

The gNodeB keeps all the existing connectivity for NR NSA and network management, while it adds connectivity to the new interfaces for NR SA. The aim is to reuse as many existing IP interfaces as possible for the new interfaces to minimize the impact on the transport network.

#### 2.11.2.3 IP Addressing

For the IP addressing of NR NSA in the baseband, the typical case is shown in below Figure.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 30   IP Addressing Migration

In Baseband NR NSA, an OAM\_IF IP interface is for OAM applications and a RAN\_IF IP interface for S1-U, EN-DC X2-C, and EN-DC X2-U interfaces. It is recommended to bind the new RAN interfaces of NG-C, NG-U, Xn-C, and Xn-U to the same RAN\_IF IP interface.

With the same RAN\_IF IP interface, there are two IP addressing solutions. One is to have one IP address for all the RAN traffic. The existing IP address of RAN\_IF IP interface is not changed, which is recommended in most cases.

The other IP addressing solution is to add one IP address under the RAN\_IF IP interface for NR SA traffics separately. In this case, there is two IP addresses under the RAN\_IF IP interface as shown in below Figure. The existing IP address, IP\_A is used for S1-U and EN-DC X2 traffic, while the newly added IP address, IP\_B is used for NG and Xn traffic. If both IP\_A and IP\_B belong to one IP subnet, it does not need to redesign the IP addressing in transport network.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 31   Two IP Addresses under One IP Interface

From QoS perspective, the same rule of QoS mapping from DSCP to PCP is used for both IP\_A and IP\_B addresses. For example, if S1-U and NG-U traffic have the same DSCP value in IP layer, both S1-U and NG-U traffic have the same PCP value in VLAN layer.

Regarding routing, the static routing approach is used with different priority. If OSPF method is used in Baseband, IP\_A or IP\_B needs to be set as the primary IP address of the RAN\_IF interface, which is used for OSPF route exchange. The configuration is to set the AddressIPv4.primaryAddress attribute to TRUE. If the NR NSA network is decommissioned in short term, it is recommended to use IP\_B as the primary address, otherwise use IP\_A as primary address.

#### 2.11.2.4 IPsec Policy Upgrade

The IPsec policy update is shown in below Figure.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 32   IPsec Policy Update

In an untrusted MBH case, the IPsec VPN is set up to protect the RAN traffic between the Baseband and SEG. In the NR NSA case, one IPsec VPN is used to protect the S1-U and X2 traffic towards 5G EPC (subnet A) and RAN sites (subnet B). Subnet B includes the IP address subnet of neighbor anchor eNodeBs. In the Baseband, there is one IPsec policy for each remote subnet. The subnet is configured in IpsecPolicy.remoteTrafficSelector attribute.

Note: X2 traffic can be protected through directed X2 IPsec VPN.

After NSA to NSA+SA migration, the NG/Xn traffic can use the same IPsec VPN connection with one more IPsec policy added for subnet C to 5GC.

#### 2.11.2.5 IPv6 and IPv4 Cases

If the NR NSA gNodeB is IPv6-based, it is easy to introduce the IPv6-based NR SA with the same IPv6 IP interface. In this case, the 5GC supports the IPv6-based NG-C and NG-U interfaces, as well.

If the existing NR NSA gNodeB is IPv4-based, it needs to create one IPv6 interface for the Xn, and NG traffics of NR SA.

#### 2.11.2.6 Site Synchronization

The site synchronization solution is not affected during the migration from NR NSA to NR SA + NSA. Comparing to NR NSA, NR SA does not raise a synchronization requirement.

NR NSA and NR SA share one common OAM configuration in the gNodeB. The ENM is the unified system for managing the RAN site. The general OAM applications of NETCONF, SNMP, and PKI do not need change. After the migration, the ENM supports the SA-specific alarms and performance counters.

Note: The ENM must be upgraded before the RAN migration.

Related Information

IP Version

### 2.11.3 Migration Execution

The RAN site migration consists of the following tasks:

- Software upgrade of the baseband
- Configuration update in the baseband

Considering the large number of the RAN sites, it is not efficient to perform software update and network configuration manually. Therefore, it is recommended to perform the RAN migration through ENM and automate the migration activity as much as possible.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 33   Migration Operation with ENM

#### 2.11.3.1 Software Update

The Software and Hardware Manager (SHM) application is responsible for the software upgrade of the baseband in ENM. It supports the upgrade of multiple Baseband units to the same software package within one upgrade task. License upgrade is also supported during the software package update. The configuration backup is always recommended during the software package update. If there is a new software issue, it is possible to restore the last correct configuration.

#### 2.11.3.2 Configuration Update

After the software upgrade of the baseband, the configuration needs to be updated. Bulk Configuration is used for this purpose. It is a web-based application in ENM that allows importing Configuration Management (CM) data to the existing network in bulk. It supports the configuration and its update in the baseband node with a bulk configuration file. In the bulk configuration file, the common configuration must be defined. For example, the LocalSctpEndpoint.sctpEndpointRef under the GNBCUCPFunction relates to the SctpEndpoint MO need to be created for the new NG-C interface setup. This configuration is applicable to the gNodeB for the same management area, for example, Tracking Area.

## 2.12 Multiple IP Addresses per RAN Interface

If traffic separation is required among different PLMNs or S-NSSAIs, it could configure multiple IP addresses for one RAN interface, such as Xn-C, Xn-U, NG-U, and NG-C in the gNodeB. In the case of multiple PLMNs, each PLMN could have one dedicated IP address for one RAN interface. However, only one IP address is supported for Xn-C or NG-C interface within one PLMN, which means all the S-NSSAI slices of one PLMN should share the same control plane connectivity. User plane does not have such limitation. Each Xn-U or NG-U of different slices could have a dedicated IP address.

Below figure shows one IP Addressing Design example of NR SA-only gNB, where there are two PLMNs: PLMN 1 with two slices of S-NSSA 1 and S-NSSA 2, and the PLMN 2 with one slice of S-NSSAI 3.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 34   Example Design of Multiple IP Addressing for RAN Application Interface

For the control plane traffic, PLMN1 and PLMN2 have different IP interfaces for traffic separation. However, the control plane of S-NSSAI1 and S-NSSAI2 slices of PLMN1 share the same IP interface. For the user plane traffic, each slice has its dedicated IP interface as shown in above Figure, this could help guarantee the SLA of each network slice.

Below figure describes one example of network slicing connectivity design with multiple IP addresses. In this case, VLAN ID is used as slice traffic identifier in transport network. Therefore, it needs to do the traffic identifier mapping from the S-NSSAI to the VLAN ID. The IP interface is used as mapping media since it is associated with both S-NSSAI and VLAN ID.

On the configuration level, first it is necessary to define CP and UP IP addresses of all configured slices (S-NSSAIs) to dedicated IP addresses under IP interfaces, which is used for NG-C, Xn-C, NG-U, and Xn-U. Then, the IP interfaces can be encapsulated into the expected VLAN port. In the uplink direction, Baseband is responsible for the mapping from the slice ID S-NSSAI to the corresponding VLAN ID, while in the Downlink direction, 5GC system is responsible for the mapping (not shown in the picture).

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 35   Example Design of Traffic Separation of Network Slicing

In the example of above Figure, there are multiple IP interfaces configured, and each IP interface is dedicated for one group of traffic (S-NSSAI 1 and S-NSSAI 3 are sharing the same UP IP address in this example. They can also use separate IP addresses, but with same IP version within the same IP interface, or even IPv4 for S-NSSAI 1 and IPv6 for S-NSSAI 3 can share the same VLAN.). Such IP interfaces can be configured in separate or the shared Virtual Routers (VRs), as different RAN Compute Groups support different maximum numbers of VRs.

Note: It is also supported to use one IP address for all the slice traffics in Baseband NR, in case of shortage of IPv4 address. And once one UPF is used for multiple slices and is assigned with one same IP address in 5GC, the observability of the EP\_NgU MO is slightly limited. From observability perspective, one EP\_NgU MO instance is identified by one IP pair of {gNodeB IP address, UPF IP address} in Baseband. When multiple slices have the same IP pair, only one EP\_NgU MO instance is created for these slices in the Baseband. Therefore it is not supported to do the observability for each slice.

Note: Currently, Baseband unit can only support up to eight virtual routers, hence the issue of scalability should be considered carefully when doing the solution design.

## 2.13 Automatic Xn-C Connection Setup with Automated Neighbor
    Relations

This section describes the solution of Xn-C connection auto-setup between two gNodeBs. This solution relies on the Automated Neighbor Relations feature in the NR SA network. The feature provides the function of automatically creating NR cell relations based on the measurement report from the UE. Both inter-frequency and intra-frequency handover cases are supported. The created NR cell relation triggers the automatic setup the Xn-C connections between the source gNodeB and the target gNodeB if both gNodeBs have the attribute of GNBCUCPFunction.xnIpAddrViaNgActive set to true.

Below figure depicts the procedure of automatic Xn-C connection setup with Automated Neighbor Relations. This solution has the following prerequisites:

- It needs to be supported by the UE, the gNodeB, and the AMF.
- The local IP addresses are configured for Xn-C interfaces on both source gNodeB and target gNodeB. Both IP addresses are of the same IP version.
- The AMF needs to support relaying the RAN configuration transfer message between source gNodeB and the target gNodeB. In case different AMFs are connected to source gNodeB and the target gNodeB respectively, the AMFs need to support routing the RAN Configuration Transfer message between AMFs.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 36   Automatic Xn-C Connection Setup with the Automated Neighbor Relations Feature

The procedure of the solution is as follows:

1. When one NR SA UE moves from the Cell A to the Cell B, the UE sends the NCGI measurement report to the source gNodeB. In this NCGI measurement report, the PLMN ID and the gNodeB ID of Cell B are extracted to identify the target gNodeB.
2. The source gNodeB sends the SON request to one connected AMF for the Xn-C IP address of the target gNodeB. The SON request is encapsulated in RAN Configuration Transfer message over the NG-C interface.
3. The selected AMF transfers the SON request message to the target gNodeB according to the target gNodeB information stored in the AMF. If the selected AMF is not connected to the target gNodeB, it must relay this request to the right AMF.
4. The target gNodeB replies the SON request to its connected AMF, with the information of the Xn-C IP address of the target gNodeB.
5. The AMF transfers the SON reply to the source gNodeB.
6. With the retrieved Xn-C IP address of the target gNodeB, the Xn-C connection between the source gNodeB and the target gNodeB is set up automatically.

Note: The current solution only supports in the trusted MBH network.

## 2.14 ANR for IRAT Mobility

### 2.14.1 NR SA to LTE IRAT HO

This section describes the ANR for IRAT mobility from NR SA to LTE, when a connected UE reports an unknown E-UTRAN cell in the B1 or B2 measurement report, the ANR functionality requests an ECGI measurement, based on the measurement report creates an NR to E-UTRAN cell relation in gNodeB.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 37   NR SA ANR for IRAT Mobility (B1 or B2 Based)

Above figure shows the ANR case of mobility from SA to LTE:

1. When UE detects unknown E-UTRAN cell, reports to source SA cell.
2. gNodeB request the ECGI measurement for the reported cell.
3. UE reports the ECGI information.
4. Based on the ECGI measurement report, gNodeB automatically creates the IRAT neighbor relations.
5. Incoming NR IRAT Handover is performed from the next Measurement Report toward this E-UTRAN cell relation, created by ANR functionality.
6. IRAT handover from SA cell to LTE cell.

The E-UTRAN cell relations and the relation neighbor objects are removed automatically if the cell relations are not used for IRAT mobility during configurable time.

This feature can automatically create and remove neighbor relations. The handover can be performed without manual configuration, which reduces OPEX.

### 2.14.2 LTE to NR SA IRAT HO

This section describes the ANR for IRAT mobility from LTE to NR SA, when a connected UE reports an unknown NR cell in the B1 measurement report, the ANR functionality requests an NCGI measurement. Based on the measurement report and EN-DC configuration, E-UTRAN to NR cell relations are created in the gNodeB.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 38   ANR for B1 Based IRAT Mobility

Above figure shows the ANR case of mobility from LTE to NR SA:

1. When the UE detects an unknown NR cell, it reports this to the source E-UTRAN cell.
2. gNodeB requests the NCGI measurement for the reported cell.
3. UE reports the NCGI information depending on EN-DC configuration in the UE. NCGI measurements are set up if either reportCGI-NR-EN-DC-r15 or reportCGI-NR-NoEN-DC-r15 are supported.
4. Based on the NCGI measurement report, gNodeB automatically creates the IRAT neighbor relations.
5. Outgoing NR IRAT Handover is performed from the next Measurement Report toward this NR cell relation, created by ANR functionality.
6. IRAT handover from LTE cell to NR cell.

The E-UTRAN cell relations and the relation neighbor objects are removed automatically if the cell relations are not used for IRAT mobility during configurable time.

This feature can automatically create and remove neighbor relations. The handover can be performed without manual configuration, which reduces OPEX.

Note: ANR for NR supported for FR1 only.

Note: PCI-based ANR is conflicting functionality to NCGI-based ANR (cannot be activated together in eNB).

Note: NR neighbor relations are created based on first PLMN only, information received from neighbor NR cell (SIB1 broadcast).

## 2.15 NG-C Connection Setup with AMF FQDN

NG-C's connection is setup between gNodeB and AMF. gNodeB is responsible for initializing NG-C's connection, therefore gNodeB needs to know AMF's IP address. In gNodeB, one way is to specify AMF's IP address statically under the MO TermPointToAmf. Another way is to configure AMF's FQDN instead of AMF's IP address. In case of no AMF's IP address configured, gNodeB will do DNS lookup with the configured AMF's FQDN via DNS server and fetch AMF's IP address accordingly. Comparing to AMF's static IP solution, AMF's FQDN solution does not need change AMF's IP related configurations in gNodeB if the AMF's network needs to be upgraded or redesigned in future.

AMF's FQDN can be defined in gNodeB either in manual approach per TermPointToAmf.domainName or retrieved by gNodeB via DNS server in automatic approach. The DNS server can be deployed in either OAM or RAN domain and local DnsClient MO can be configured in either OAM Router or RAN Router in gNodeB. When DnsClient MO is configured in RAN router, the LocalDnsEndpoint MO is needed to reference such local DNS client as shown in below MO Model Figures in this chapter.

Note: In shared RAN deployment, operators can share the common DNS server and use the same local DnsClient MO in shared gNodeB, or separate DNS Server and seperate local DnsClient MOs can be defined per operator to fetch their own AMF's IP address via dedicate DNS servers. For specific reference solutions for RAN sharing scenarios, refer to Shared NR RAN Solution Guideline.

### 2.15.1 Manual approach for AMF FQDN Definition

Below figure describes the DNS lookup procedure for AMF's IP addresses in manual approach. When Discovery of AMFs via DNS is deactivated by GnbCuCPFunction.dnsLookupOn5GsTai set as FALSE by default, to setup NG-C connection toward any new AMF entity, the MO TermPointToAmf could be configured manually with Domain Name rather than IPv4 or IPv6 address. Once MO TermPointToAmf is unlocked, gNodeB resolves IPv4 or IPv6 AMF's IP addresses using A and AAAA DNS queries. When IP addresses are resolved, gNodeB starts initializing the NG-C connection towards AMF. When NG-C connection breaks or gNodeB restarts, it also triggers AMF's DNS lookup in gNodeB. DNS servers must be configured with AMF FQDN A or AAAA resource records.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 39   AMF's DNS Lookup Solution

### 2.15.2 Automatic approach for AMF FQDN Definition

The automatic approach is enabled when Discovery of AMFs via DNS is activated by GnbCuCPFunction.dnsLookupOn5GsTai set as TRUE. Discovery of AMFs via DNS feature enables automated handling of TermPointToAmf and NG-C connections to the 5G Core nodes (AMF) that is based on DNS lookups. AMFs FQDN are resolved by NAPTR (Name Authority Pointer Record) DNS query type. gNodeB automatically resolves AMF's FQDNs and creates or deletes TermPointToAmf MO instances. Newly created TermPointToAmf MOs are unlocked. gNodeB resolves AMF's IP Addresses by A or AAAA DNS queries.

Below figure shows the flow for disovery of AMF's via DNS, starts with NAPTR DNS query based on 5GS TAI FQDN. DNS query resolves AMF domain names and DNS response returns AMF FQDN list. TermPointToAmf MO is created for each resolved unkonwn AMF FQDN and with domainName MO set. After the MO unlocking, gNodeB follows the functionality as described for manual approach.

DNS lookup on AMF domain name is performed to resolve IP addresses. NG-C connection is set up with the received IP addresses. DNS servers must be configured with 5GS TAI FQDN NAPTR resource records and with AMF FQDN A or AAAA resource records.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 40   Discovery of AMFs via DNS sequence

After the gNodeB software upgrade to the release supporting Discovery of AMFs via DNS function, manual approach could still be used as below figure shown, see more details in previous section Manual approach with AMF's FQDN. Discovery of AMFs via DNS feature is deactivated by default with GnbCuCPFunction.dnsLookupOn5GsTai set to FALSE and for all existing TermPointToAmf, TermPointToAmf.isRemoveAllowed is set to FALSE by default as well. DNS client is configured in OAM domain.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 41   AMF Discovery MO Model with deactivated feature

Below figure shows the example when Discovery of AMFs via DNS function is activated by setting GnbCuCPFunction.dnsLookupOn5GsTai MO attribute to TRUE and local DNS client is defined in RAN domain router. DNS client is referenced by LocalDnsEndpoint MO. In such a case, TermPointToAmf MOs are created and deleted automatically according to DNS lookup on 5GS TAI results. For automatically created TermPointToAmf, TermPointToAmf.isRemoveAllowed is set to TRUE. For feature configuration and activation, please, see NR Standalone.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 42   AMF Discovery MO Model with activated feature

Note: If local DnsClient MO is defined in OAM VR, it is referenced by default and there is no need to configure LocalDnsEndpoint MO.

#### 2.15.2.1 Network Capability

Network capability (NC) is used for TermPointToAmf MO class attribute configuration. gNodeB start AMF discovery with constructing the 5GS TAI FQDN and initiating NAPTR procedure with the application unique string set to that 5GS TAI FQDN. NAPTR procedure outputs a list of AMFs FQDN each with a service for that 5GS TAI. gNodeB shall consider AMFs FQDN with service parameter set to "x-3gpp-amf:x-n2". Network capability will enable complete TermPointToAmf MO creation and configuration automation. It can be used for TermPointToAmf MO class attributes definition in the DNS as addition to the Service parameter "x-3gpp-amf:x-n2". Example of 5GS TAI DNS file with 1 TAI, 2 AMF sets and one AMF in each set. For the first AMF FQDN, Service parameter "x-3gpp-amf:x-n2" is extended with '+nc-pws.def' network capabilities. This means that NR-RAN shall use this AMF for PWS (Public warning system) functionality and also that this AMF is default AMF. If the '+nc' is omitted as it is the case for the second AMF FQDN , this AMF does not support PWS and it is not default AMF.

Note: DNS server must be configured with 5GS TAI FQDN Resource records with Service parameter set to "x-3gpp-amf:x-n2".

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 43   Network Capability option parameter example

The possible combinations of Network Capability parameters are summarized in the below table:

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 44   Combination of Network Capability parameters

### 2.15.3 Reference Solutions

#### 2.15.3.1 DNS server in OAM Domain and local DNS client in OAM
        VR

This is a legacy solution for gNodeB with software release not supporting Discovery of AMFs via DNS feature or with software release supporting the feature but feature is deactivated.

In gNodeB, two virtual routers (VR) are created. OAM VR is used for OAM traffic. IP A1 is created within OAM VR and referenced by OamAccessPoint MO. RAN VR is used for RAN traffic. IP A2 is created in RAN VR as local IP endpoint for Ng-C setup. The MO TermPointToAmf is only configured with one DomainName and without IP address, DnsClient MO was defined in OAM VR and DnsClient.localIpAddress referenced to IP A1. If local DnsClient MO is defined in OAM VR then no need to define LocalDnsEndpoint MO. In DNS server, AMF FQDN mapping to IP address records are configured. When the MO TermPointToAmf is unlocked, gNodeB uses IP A1 to perform the DNS query for AMF's FQDN. After AMF's IP address is received (NG IP: C1), gNodeB uses IP A2 to setup the NG-C connection toward AMF.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 45   Network Example of AMF's FQDN Lookup in Trusted MBH

#### 2.15.3.2 DNS server in RAN Domain and local DNS client in OAM
        VR

Below figure shows one solution example of NG-C connection setup with AMF's FQDN in Untrusted MBH. This is a legacy solution for gNodeB with software release not supporting Discovery of AMFs via DNS feature or with software release supporting the feature but feature is deactivated.

In MBH, there are two IPSec VPNs: OAM and RAN (Signaling). In this example, in gNodeB, there are one Outer VR and one Inner VR. The Outer VR is responsible for IP communication between SEG and Baseband. In the Inner VR, IP A1 is defined for OAM traffic and referenced by OamAccessPoint MO, IP A2 is defined for Ng-C traffic as local end point. The MO TermPointToAmf is configured with DomainName and without IP address. The DNS server is deployed in 5GC (RAN) Domain. DnsClient MO is defined in inner VR and DnsClient.localIpAddress referenced to IP A2. In DNS server, it needs to configure A or AAAA DNS records for AMF's FQDN. Noted in this case, local DnsClient MO is defined in the same VR with OAM IP, there is no need to define LocalDnsEndpoint MO. Refer to above figure of AMF Discovery MO Model with deactivated feature after the software upgrade.

When MO TermPointToAmf is unlocked, Baseband uses IP A2 to perform the DNS query for AMF's FQDN. After AMF's IP address is resolved, IP A2 was reused to setup the NG-C connection toward AMF (NG IP: C1).

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 46   Network Example of AMF's FQDN Lookup in Untrusted MBH

#### 2.15.3.3 DNS server in RAN Domain and local DNS client in RAN
        VR

This is a modernized solution for gNodeB with software release supporting Discovery of AMFs via DNS feature. As below figure shows in gNodeB, two virtual routers (VR) are created. OAM VR is used for OAM traffic. IP A1 is created within OAM VR and referenced by OamAccessPoint MO. RAN VR is used for RAN traffic. IP A2 is created in RAN VR as local IP endpoint for Ng-C setup. The MO TermPointToAmf could be configured with one Domain Name and without IP address as manual approach does (Discovery of AMF via DNS is deactivated), or the MO TermPointToAmf can be created or deleted automatically as automatic approach does (Discovery of AMF via DNS is activated).

DnsClient MO was defined in RAN VR and DnsClient.localIpAddress referenced to IP A2. Noted If local DnsClient MO is defined in RAN VR then it is needed to define LocalDnsEndpoint MO as shown in above figure of AMF Discovery MO Model with feature activation. In DNS server, AMF FQDN mapping to IP address records are configured and ,optionally, 5GS TAI FQDN mapping to AMFs FQDN list are configured. If feature is activated, gNodeB uses IP A2 to perform DNS query for 5GS TAI's FQDN and creates TermPointToAmf for each resolved AMF FQDN. When the MO TermPointToAmf is unlocked, gNodeB uses IP A2 to perform the DNS query for AMF's FQDN. After AMF's IP address is received, gNodeB uses IP A2 to setup the NG-C connection toward AMF (NG IP: C1).

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 47   Network Example of AMF's FQDN Lookup Solution

## 2.16 NR Multiple TNL Associations

This feature enables multiple SCTP associations also referred as TNLA (Transport Network Layer Association) between gNodeB and AMF pair (Cloud AMF). It support Multiple SCTP endpoints on AMF and Single SCTP endpoint on gNodeB. There are multiple TNLAs serving a single NG-C connection. Up to 32 TNL associations can be established for each AMF and up to 64 AMF can be connected at the same time.

Note: When multiple operators use a shared node, separate SCTP endpoint on gNodeB can be configured for each operator.

The benefits of having multiple TNL associations are:

- Feature adds support for NG-C connection with AMFs having multiple SCTP endpoints.
- Create, remove, and update additional AMF TNL Associations, as ordered by AMF.
- Improve AMF scalability and allow Load distribution of UE-associated signaling on NG-C connection.
- Interoperability with Cloud Core AMFs that are using multiple SCTP endpoints.
- Cloud Core AMF is deployed as scalable Network Function (NF) instance and can be distributed geographically.

For more information, see NR Multiple TNL Associations guideline.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 48   Multiple TNL Associations between gNodeB and AMF

The first TNL association between gNodeB and AMF is always initiated by gNodeB. Additional TNL associations are created by gNodeB on the request from AMF. gNodeB creates new NG-C connection with AMF per legacy Ng-C setup procedure, TermPointToAMF MOs are created or deleted manually. AMF IP addresses can be configured as static MOs TermPointToAMF.ipv4Address1, TermPointToAMF.ipv4Address2, TermPointToAMF.ipv6Address1, TermPointToAMF.ipv6Address2 or can be resolved by DNS lookup procedure via MO TermPointToAMF.domainName.

Related Information

NG-C Connection Setup with AMF FQDN

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 49   TNL Association MO instance

Above figure shows TNL association setup for NG-C conneciton example towards each AMF. Refer to TnlAssociation MO class for attributes detail.

## 2.17 NR SA Deployment Consideration

### 2.17.1 RAN Site Consideration

#### 2.17.1.1 Cooperation of NR RAN and LTE RAN

In the NR SA deployment for eMBB service, it is suggested to deploy NR SA into an existing LTE site. While NR SA does not rely on LTE RAT, LTE is needed in the early phase of the introduction of NR SA. This has the following reasons:

- LTE can complement insufficient network coverage of NR.
- Once Voice over NR is not supported. Voice EPS fallback is needed.

#### 2.17.1.2 Baseband IP Address Planning

Below figure shows the gNodeB with the RAN interfaces which can support NR NSA and NR SA together in one node.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 50   RAN Interfaces in Embedded gNodeB

In embedded gNodeB, the IP connectivity for F1-C is configurable and needs to be specified with proper connectivity design. Since the F1-C traffic flow between DU and CUCP functions is kept internally, two common IP addresses can be reused for all embedded gNodeBs in the network.

If one embedded gNodeB uses the configuration scripts generated by the ECT (Ericsson Configuration Tool), by default one dedicated Virtual Router (VR) named Node\_Internal\_F1 and two loopback IP addresses are created for internal F1-C traffic. However, it is possible to reuse any other VR or IP addresses for such internal F1-C communication as shown in below Figure.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 51   F1 Interface Connectivity Optimization

Related Information

IP Version |  Multiple IP Addresses per RAN Interface

### 2.17.2 S1-U and NG-U Path Number Limit

In most NR SA networks, UPF is deployed on the cloud native container, which runs on the COTS hardware. The capacity of each UPF instance is assumed small. To meet the increased network capacity requirement, the number of NG-U paths from the gNodeB towards the UPFs is much higher than the number of S1-U paths towards SGWs in the LTE network. Besides, the shared RAN features, such as network slicing and MOCN also need more NG-U paths.

On the gNodeB side, one NG-U path is needed for one UPF when this UPF is used for NG-U traffic. NG-U path is identified by one pair of {gNodeB IP address, UPF IP address}. Same case is for S1-U path towards SGW in EPC. Number of supported S1-U and NG-U GTP-U connections paths are configurable via MO attributes and can be set cardinality within range 0-1800 as shown in below figure.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 52   MO class CardinalityLimits for S1-U and NG-U

When high value for S1ULink and EP\_NgU MO cardinality is set, the total number of used GTP-U paths for all interfaces may reach the HW node limit, currently set to 4095 GTP-U paths. It is recommended to avoid using too many GTP-U paths, to avoid reaching the node limit for interfaces S1, NG, X2, Xn.

Operators can reduce the number of used S1/NG GTP-U paths by:

- Reconfiguring UPF/SGW to use lower number of IP addresses.
- Take the NG-U path limit into consideration when deploy network slicing and RAN sharing.
- On gNodeB, the same IP address can be shared by S1-U and NG-U interface. This will reduce the number of used GTP-U paths only if SGW and UPF share the same IP addresses. Below figure still shows separate S1-U and Ng-U use case, since different SGW and UPF IP addresses are being used in the example.

Note: On LTE+NR Mixed-Mode Baseband configuration, the same IP address can be shared by eNodeB and gNodeB for S1-U towards the common SGW to reduce the GTP-U path number.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 53   MO Class limits on baseband

Note: For more information, please refer to CPI FED NR Increased Number of GTP-U Connections.

### 2.17.3 Transport Network Consideration

#### 2.17.3.1 Mobile Backhaul Network

In the mobile backhaul (MBH) network, traffic separation is suggested for OAM traffic and RAN traffic service. This separation has the following benefits:

- VPNs meet different traffic type requirements.
- Network OAM becomes easy.
- The traffic becomes secured.

The use of the following VPNs is proposed from a design perspective:

- One OAM traffic VPN, which carries OAM traffic between the gNodeB and Ericsson Network Manager (ENM) and other support applications.
- One RAN traffic VPN, which carries the control plane and user plane traffic of the gNodeB.

The separation can be implemented through different network VPN technologies, for example VLAN and BGP/MPLS VPN.

The NR RAN can share VPN with LTE or use a dedicated VPN, depending on the NR RAN deployment strategy.

Note: From a logical connectivity perspective, it is recommended to set up one RAN VPN for both LTE and NR RAN traffics to simplify the network configuration. Also, it is recommended to carry the NR OAM traffic and LTE OAM traffic in one VPN to simplify the network configuration.

#### 2.17.3.2 Fronthaul Network

From a design perspective, Direct Fiber connection is recommended for the D-RAN case, while Wavelength-Division Multiplexing (WDM) fronthaul is recommended for the C-RAN case. For more information on fronthaul, see NR Optical Fronthaul Solution Guideline and Ethernet Fronthaul Solution Guideline.

#### 2.17.3.3 Network Capacity and Latency

Network capacity dimensioning and latency requirements must be considered.

Compared to the LTE RAN, the general requirement of one single NR D-RAN site is changed from 1 Gbps to 10 Gbps because of cell throughput increase. For specific dimensioning requirements, see NR Transport Dimensioning Guideline and NR Transport Dimensioning Examples.

Below table shows the recommended latency values for the user plane traffic of the eMBB use case as an example.

| Traffic       | Recommended One-Way Latency   |
|---------------|-------------------------------|
| NG            | < 30 ms                       |
| Xn (MBB)(1)   | < 15 ms                       |
| Xn (NR-DC)(2) | < 5 ms                        |
| CPRI or eCPRI | < 75 s                       |

Note(1): Handover traffic between gNBs for mobility.

Note(2): NR-DC traffic supports Dual Connectivity by coordinating data flow between gNBs.

Note: For other services with different service type other than eMBB, the one-way latency for each interface must be considered according to their respective PDB requirement. For detail PDB requirement of each service, see 3GPP 23.501.

#### 2.17.3.4 PDU Size Considerations

The Baseband node uses IPsec as traffic protection mechanism. With that, the proper maximum SCTP PDU size value should be considered to avoid fragmentation of packets in the transport network (TN) with the SctpProfile.maxSctpPduSize parameter.

For instance, IPv4 to IPv6 migration happens in trusted or untrusted backhaul cases. During this process, the SctpProfile.maxSctpPduSize attribute value needs to be adjusted to prevent fragmentation or any packet drop issue.

If the SctpProfile.maxSctpPduSize value is not considered, the Security Gateway (SEG) drops the IPv6 packet bigger than MTU without further fragmentation. The SEG sends back ICMPv6 to the sender, which means that the packet is too big and includes the proposed MTU size.

All Routers and SEGs must support forwarding IPv6 fragments of SCTP, for example, during SCTP Packet retransmission cases.

Below table shows the value of the SctpProfile.maxSctpPduSize attribute for each separate inner and outer network configuration for the calculation of the correct SCTP Maximum Transmission Unit (MTU). If there is no Network Address Translation (NAT), the maximum of 80 bytes for IPv4 and 100 bytes for IPv6 margins are added.

| IP Type             |   MOM: maxSctpPduSize |   Inner Interface MTU |   Outer Interface MTU |
|---------------------|-----------------------|-----------------------|-----------------------|
| IPv4(I) and IPv4(O) |                  1400 |                  1420 |                  1500 |
| IPv6(I) and IPv6(O) |                  1360 |                  1400 |                  1500 |
| IPv4(I) and IPv6(O) |                  1380 |                  1400 |                  1500 |
| IPv6(I) and IPv4(O) |                  1380 |                  1420 |                  1500 |

### 2.17.4 Core Network Consideration

#### 2.17.4.1 EPS Fallback

In the early phase of 5G SA network deployment, as the radio network is not built out for carrying VoNR so both EPC and 5GC are required for the voice service. When EPS fallback happens, the 5GC works together with the EPC through the N26 and the S5 interfaces. After EPS fallback, both data and voice services are being served by the LTE networks.

EPS fallback to LTE network can be done with the following approaches:

- blind release with redirect (RwR)
- measurement-based release with redirect (RwR)
- measurement-based handover

For detailed description of EPS fallback, please refer to 5G Voice SA RAN Solution Guideline and EPS Fallback for IMS Voice.

#### 2.17.4.2 Multiple AMFs per PLMN

Multiple AMFs deployment provides increased redundancy and flexibility, ensuring better load balancing and resilience in the network. When one AMF is planned for out-of-service, AMF Status Indication Procedure over NG interface ensures that the AMF can be gracefully removed without impacting connected UEs and prevents new UEs from being assigned to planned unavailable AMFs.

Below figure shows the multiple AMFs deployment scenario. AMF1 is planned removal from core network, the AMF1 sends the AMF STATUS INDICATION message that contains "Unavailable GUAMI List" as AMF management function.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 54   AMF Status Indication Procedure over NG interface

In this scenario, there are two types of UEs affected by the AMF planned removal:

- UEs coming from CM-IDLE state: Since AMF1 is in the Unavailable GUAMI List, it is not available for UEs coming from CM-IDLE state. Other AMFs are selected for these UEs.
- Already Connected UEs: The NG-C link of AMF1 remains active, and UEs in CM-CONNECTED state is continued to be served by AMF1 until it is removed. There is a possibility to move UEs to another AMF with answering the Initial Context Setup or by using UE Context Modification procedure initiated from another AMF. Otherwise, it impacts on connected UEs when the AMF is removed

For detailed information, see Support for AMF Status Indication Procedure over the NG Interface in Network Impact Report.

### 2.17.5 Management Consideration

ENM is a unified management system for RAN, Transport, and Core applications. ENM is recommended to manage the NR SA network. ENM can support the following NR SA node management functions:

- Configuration management
- Performance monitoring
- Fault management
- Software upgrade
- PKI management

Note: For gNodeB integration, auto-integration with ENM is recommended to reduce the effort and time of the network rollout.

### 2.17.6 Security Consideration in Untrusted MBH Network

IPsec protection is the recommended solution in the untrusted backhaul for RAN service traffic. A RAN Security Gateway (SEG) can be deployed to secure the NG and Xn traffic. A Security Gateway (SEG) can be deployed to secure the NG and Xn traffic in NR SA mode.

One shared SEG node can be used as the security functionality for both LTE and NR.

For detailed technical information about security, see NR RAN Transport Security Guideline.

Below figure shows a typical IPsec deployment scenario to cover:

- NR SA
- NR NSA
- LTE

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 55   IPsec VPN Deployment

The above figure shows NR SA and NR NSA co-existence scenario, the following IPsec VPN connections can be established for different purposes:

- IPsec VPN toward SEG can be established to protect RAN and OAM traffic before Direct IPsec VPN connections are set up, RAN traffic include NG-C/U, Xn-C/U, S1-C/U, and X2-C/U. SEG is deployed at the border of untrusted and trusted MBH zones, so operator traffic flows over untrusted MBH zone can be protected by IPsec VPN towards SEG before entering trusted MBH zone.
- The OAM traffic could be also protected in a separated IPsec VPN connection from the one to protect RAN traffic flows, which is not shown in above Figure. Another alternative solution of OAM traffic protection is to use the Transport Layer Security (TLS) with Public-Key Infrastructure (PKI) solution between gNodeB and ENM.
- If eNodeBs and gNodeBs are from Ericsson, Direct IPsec VPN for X2 and Xn can be established to protect X2-U and Xn-U traffic, once X2-C and Xn-C are reusing the same IP addresses as X2-U and Xn-U, they can also be protected by such Direct IPsec VPN connections. Direct IPsec VPN for X2 is mainly to protect X2-U traffic flows in inter-eNodeB CA or EN-DC scenarios, while Direct IPsec VPN for Xn is mainly to protect Xn-U traffic flows in NR-DC scenarios.
- For Direct IPsec VPN deployments, a SEG is required for initial Xn/X2 connection setup. Without Direct IPsec VPN connections, IPsec-protected X2/Xn traffic is always routed toward the SEG.

See more RAN security configurations and considerations in NR RAN Transport Security Guideline and Manage IPsec.

### 2.17.7 E2E QoS Consideration

The 5G QoS Identifier (5QI) parameter is introduced to identify the QoS of NR SA service traffic flows, for example voice or data. This requires alignment and integration with the existing LTE QCI concept.

The following scenarios need to be considered:

- QCI to 5QI mapping in the gNodeB
    - The EN-DC UE connects to the eNodeB and uses control plane signaling through the LTE network. During Secondary Node based split bearer setup, The eNodeB sends DRB-related QCI parameters to the gNodeB to control the QoS. The gNodeB can only recognize 5QI values, the feature QoS Framework in gNodeB supports QoS for EN-DC users by a straight mapping of QCI to 5QI, that is, QCI=x is treated as 5QI=x.
- 5QI to QCI mapping in the 5GC
    - The 5G EPC can only recognize QCI values. For the interworking between the 5GC and the 5G EPC, it is necessary to perform 5QI to QCI mapping for S5-U traffic between the 5GC and the 5G EPC.
- 5QI to QoS identifier in the transport network
    - The E2E PDU flow is identified with the QoS Flow Identifier, which contains 5QIs recognized by the UE, the gNodeB, and the 5GC. The gNodeB and the 5GC map UL and DL NG-U traffic 5QI to the transport network QoS information. The QoS information includes DSCP, EXP, and P-bit, encapsulated in a transport network header.

In the gNodeB, the mapping from 5QI to DSCP of user plane traffic is provisioned through the CUUP5qiTable attribute. The mapping from 5QI to DSCP of control plane traffic is provisioned through the SctpProfile.dscp attribute. The mapping from DSCP to P-Bit is provisioned through the DscpPcpMap table associated with the VLAN port. The QoS information of EXP can be used in the IP/MPLS based transport network.

Below figure shows the E2E connectivity QoS mapping.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 56   E2E Connectivity QoS Mapping

It is supported to do customized mapping from 5QI to DSCP in terms of NR SA network slices through non-default CUUP5qiTable.CUUP5qi. However, for EN-DC user plane traffic mapping from QCI to DSCP must follow the default CUUP5qiTable, and setting DSCP value for each PLMN in shared NR RAN is not supported for EN-DC capable UEs.

For more information on NR QoS specific mapping, see E2E QoS Guideline and NR SA Network Slicing Guideline.

### 2.17.8 Synchronization

Time and phase synchronization of the radio interface is essential to operate and transmit data for the NR SA system. For general technical information about synchronization, see Network Synchronization Solution Guideline.

#### 2.17.8.1 PTP Synchronization

NR SA TDD requires strict time synchronization. PTP over Ethernet provides a time and phase synchronization reference to the connected eNodeB and gNodeB. If the gNodeB is the GM, and the eNodeB is the OC or BC. The PTP time reference is distributed from the gNodeB (Grandmaster) to the eNodeB (OC) by the transport network. The CSR can also provide PTP over Ethernet to the baseband. NR SA FDD requires time and phase synchronization, as well. The minimum requirement is PTS with relaxed network limits in NR SA FDD deployment. For more information, see Network Synchronization Solution Guideline.

#### 2.17.8.2 GNSS Synchronization

With several eNodeBs and gNodeBs in the same location, the optional power divider and GNSS active splitter can be used to split the signal from the GNSS antenna to several GNSS Receiver Units (GRUs), then the GRU is connected to each Baseband unit to provide the synchronization accordingly.

Below figure shows the RAN with GNSS and APTS as assisting reference is used for time and phase synchronization.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 57   GNSS and APTS Synchronization

### 2.17.9 IP Version

Baseband eNodeB and gNodeB support IPv4 or IPv6 protocol for RAN traffic and OAM traffic. Both the LTE and the NR transport network can be IPv4- or IPv6-based. Generally, IPv4 is used widely in real deployments of LTE networks. When NR network is introduced, the IPv4 network is still applicable, which has minimal impact on the transport network design. However, in some cases (for example, IPv4 address shortage), IPv6 is required for the NR SA network. For the SA-only gNodeB, it is easy to deploy IPv6-only network, since the SA-only gNodeB does not need to set up the IPv4-based interfaces toward the existing IPv4-based eNodeB and 5G EPC.

However, the gNodeB with both NR NSA and SA needs to use the mixture design of IPv4 and IPv6 addressing. Below are several design examples when IPv6 is introduced in the NR SA network, together with the existing IPv4-based LTE. In this case, the trusted MBH transport network supports both IPv4 and IPv6 capability. However, the untrusted MBH is not impacted, considering the outer IP address of IPsec still uses IPv4 only.

Below figure shows the example case of IPv6-only gNodeB in trusted MBH network. It is assumed that NR NSA network already uses IPv6 before the NR SA introduction. The NR SA network is built on IPv6 as well.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 58   Example Case of IPv6-only gNodeB in Trusted MBH

The following subnetworks are set up:

- S1 traffic uses IPv4.
- S1-U traffic uses IPv6 in dual-mode gNodeB supporting NR SA and NR NSA in one cell.
- NG traffic uses IPv6.
- X2 traffic between eNodeB and eNodeB uses IPv4.
- EN-DC X2 traffic between eNodeB and gNodeB uses IPv6.
- Xn traffic between gNodeB and gNodeB uses IPv6.

Below figure shows the example case of gNodeB with both IPv4 and IPv6 in trusted MBH network. It is assumed that the NR NSA network is based on IPv4, the same as LTE. The NR SA network is built on IPv6. This design is recommended, since it does not need to add IPv6 supporting in the existing LTE/EPC network.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 59   Example Case of gNodeB with Both IPv4 and IPv6 in Trusted MBH

The following subnetworks are set up:

- S1 traffic uses IPv4.
- S1-U traffic uses IPv4 in dual-mode gNodeB supporting NR SA and NR NSA in one cell.
- NG traffic uses IPv6.
- X2 traffic between eNodeB and eNodeB uses IPv4.
- EN-DC X2 traffic between eNodeB and gNodeB uses IPv4.
- Xn traffic between gNodeB and gNodeB uses IPv6.

Below figure shows the example case of gNodeB with both IPv4 and IPv6 inner address in untrusted MBH. It is assumed that the NR NSA network already deployed with IPv4 before the NR SA introduction and the NR SA network will be built on IPv6.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 60   Example Case of gNodeB with IPv6-only Inner Address in Untrusted MBH

The following subnetworks are set up:

- Untrusted outer network uses IPv4-based or IPv6-based transport network
- S1 traffic uses IPv4.
- S1-U traffic uses IPv6 in dual-mode gNodeB of NR SA and NR NSA.
- X2 traffic between eNodeB and eNodeB uses IPv4.
- EN-DC X2 traffic between eNodeB and gNodeB uses IPv6.
- Xn traffic between gNodeB and gNodeB uses IPv6.

Below figure shows the example case of gNodeB with both IPv4 and IPv6 inner address in untrusted MBH. It is assumed that the NR NSA network already deployed with IPv4 before the NR SA introduction and the NR SA network will be built on IPv6.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 61   Example Case of gNodeB with Both IPv4 and IPv6 Inner Address in Untrusted MBH

The following subnetworks are set up:

- Untrusted outer network uses IPv4-based or IPv6-based transport network.
- S1 traffic uses IPv4.
- S1-U traffic uses IPv4 in dual-mode gNodeB with both NR SA and NR NSA.
- X2 traffic between eNodeB and eNodeB uses IPv4.
- EN-DC X2 traffic between eNodeB and gNodeB uses IPv4.
- Xn traffic between gNodeB and gNodeB uses IPv6.

Below figure shows one example design of IPv6 introduction in 5GC, considering the interworking with IPv4-based EPC.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 62   Interworking of IPv4-based LTE and IPv6-based NR SA

As shown in the above Figure, the following networks are set up:

- EPC and eNodeB remain IPv4-based in LTE network.
- NG-C and NG-U are based on IPv6 in NR SA network.
- 5GC inside interfaces (for example, N11 and N4) is IPv4-based in NR SA network.
- IPv4 is used for the interworking interfaces (S5 and N26) between EPC and 5GC.
- Data session type is IPv4, IPv6, or IPv4v6.

### 2.17.10 Xn Cardinality

This improvement allows for increased number of connections between the gNodeBs. The maximum number of Xn connections that can be supported for each gNodeB is 256. Therefore, it enables a greater number of Xn handovers and lower number of call drops with the neighboring cells. It also provides the possibility to have denser NR deployments and introduce more frequency layers.

Below figure shows the Xn Cardinality MOM diagram.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 63   MOM Xn Cardinality

### 2.17.11 GTP-U Supervision support in SA

The GTP-U Supervision feature enables path monitoring towards peer nodes by specifying interface name and local IP addresses. Echo request and response messages are used for the GTP-U path supervision. GTP-U error indication is supported in gNodeB. GTP-U Supervision can be configured using existing GtpuSupervisionProfile MO. For more information, see GTP-U Supervision guideline.

#### 2.17.11.1 Examples of GTP-U Supervison MO configurations for SA use
        cases

Case A shows below figure of GTP-U supervision functionality MO to monitor all the interfaces under one specific EndpointResource, which could be referring to one slice or one MNO. NG-U and Xn-U interfaces are configured per slice (PLMN+SNSSAIlist).

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 64   GTP-U Supervision MO to monitor all interfaces under one EndpointResource

Note: Empty interfaceList means all interfaces under MOM EndpointResource being referred to.

Case B shows below figure of GTP-U supervision functionality to monitor Ng-U interface of all EndpointResource MOs referred by 3 slices defined under the same GNBCUUPFunction.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 65   GTP-U Supervision MO to monitor NG-U interface for all EndpointResource

### 2.17.12 TN Configuration Limit

The increase of system limits makes configuration more flexible. This allows the configuration of more Virtual Routers (VRs) in the node and other system-related limits ultimately. This supports the implementation of network designs based on traffic separation principle.

Below table shows the number of supported system configurations for the RAN Compute Groups.

| Configuration Items                     | Limits for RAN Compute Groups 4 or Higher   | Description                                                                      |
|-----------------------------------------|---------------------------------------------|----------------------------------------------------------------------------------|
| VR                                      | 60                                          | Maximum number of Routers MOs                                                    |
| Router supporting SCTP-based Interfaces | 12                                          | Number of routers supporting SCTP-based interfaces                               |
| Interface IP for IPv4 and IPv6          | 120                                         | Separate limit for IPv4 and IPv6                                                 |
| Address IP for IPv4 and IPv6            | 120                                         | Separate limit for IPv4 and IPv6                                                 |
| VLAN port                               | 120                                         | Support VLAN encapsulation for each IP Interface                                 |
| IPSec Tunnel                            | 60                                          | Maximum number of IPSec Tunnel MOs                                               |
| IPSec Policy                            | 120                                         | Maximum number of IPSec Policy MOs                                               |
| IPSec Proposal Profile                  | 60                                          | Maximum number of IPSec Proposal Profile MOs                                     |
| IKEv2 Policy Profile                    | 60                                          | Maximum number of IKEv2 Policy Profile MOs                                       |
| BFD Session IPv4 and IPv6               | 120                                         | Limit is shared between IPv4 and IPv6                                            |
| BFD Profile                             | 120                                         | Number of supported BfdProfile MOs defined under Transport MO or under Router MO |
| TWAMP Responder                         | 60                                          | Maximum number of TWAMP Responder MOs in node                                    |
| Supported PDU SDU Size                  | 2006 bytes                                  | Maximum number of PDCP SDUs length                                               |

For more information, see RAN Compute Groups in DU and Baseband Configurations and Capacity.

# 3 Network Elements

This section provides information on the network elements needed for NR SA deployment. For detailed capacity information of hardware units which are used in this Guideline, refer to the documents in CPI.

## 3.1 Baseband units

For information on the Baseband products of the NR SA network and their capacities, see the following documentation.

- DU and Baseband Configurations and Capacity
- Supported Capacity and Configurations for NR RAN

## 3.2 Radio units

For information on the radio products of the NR SA network and their capabilities, see the following documentation:

- Radio Configurations for NR
- Supported Radio Capabilities

## 3.3 Routers

Router 6000 is Ericsson's high performance and efficient router series which is designed for radio from all aspects. The Ericsson Router 6000 series deliver high performance connectivity for 5G applications as a cell site router, fronthaul gateway or an aggregation node. For more information, see Technical Product Descriptions in Ericsson R6000 library.

# 4 Example Network Designs

The potential deployment cases for an NR SA network are the following:

- NR SA integrated with an NR NSA network, providing the most flexibility
- NR SA integrated with an existing LTE network, also addressing coverage and service continuity aspects with EPS interworking procedures
- NR SA, addressing new capabilities of the 5GC and NR SA terminals

Note: This document focuses on the early introduction of NR SA. Usually, the deployment is either NR SA with LTE or NR SA with NR NSA. This is the basis for the example shown in below figure.

From the logical connectivity perspective, several VPNs are defined to provide the connectivity for different types of interfaces. This is to support all deployment alternatives.

Below figure shows high-level connectivity examples of how an NR SA network can be deployed.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 66   High-Level Logical Connectivity Examples

Note: LTE and NR RAN traffic can be carried in different MBH VPNs (for example, RAN\_LTE and RAN\_NR VPNs) independently, but this adds complexity.

5GC and EPC interworking traffic is carried in two main VPNs. Sig\_CN VPN is used for signaling related traffic, while Media\_CN VPN is for GTP protocol-based traffic. The RAN technology is independent from the transport technology. The designs described in this document are only examples.

Below figure demonstrates an example of a high-level representation of the transport network MOM structure in GNBCUCPFunction and GNBCUCPFunction.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 67   MOM Configuration of Transport Network in gNodeB Baseband

There are two ways to execute the transport network reference configuration for the RAN application interfaces. The default reference configuration is to associate the EndpointResource MO with all PLMNs or SNSSAIs defined under GNBCUCPFunction or the GNBCUCPFunction MO. Use the default reference configuration if no traffic separation is required per PLMN or S-NSSAI.

Another reference configuration is to associate the EndpointResource MO with a specific ResourcePartitionMember MO, which presents one dedicated PLMN (NSA) or PLMN+S-NSSAI(SA) network. When traffic separation is required per PLMN in RAN sharing case or PLMN+S-NSSAI in a SA network slicing scenario, the dedicated reference configuration must be used.

It is possible to use both default and dedicated reference configuration together, for example default reference configuration for one PLMN and dedicated reference configuration for another.

If both default reference and dedicated reference are configured for the same RAN traffic interfaces, the dedicated reference configuration overwrites the default reference configuration.

When using default reference configuration, NR NSA and NR SA can share one EndpointResource MO and one LocalIpEndpoint can be used for all interfaces.

When using dedicated reference configuration, separate ResourcePartitionMember MOs and EndpointResource MOs must be used for NR NSA and NR SA.

## 4.1 NR SA + LTE Scenario: C-RAN with Trusted L2 Access
    Network

This section describes an example of a C-RAN site, with NR SA and LTE networks. It is applicable for customers who operate an LTE network and plan to introduce an NR SA network without NSA option 3 support. The example design is a typical C-RAN case, which has an NR and an LTE baseband hub in the same location. The MBH network is trusted, and no additional IPsec VPN connection is used to protect the traffic from the baseband units to the core.

### 4.1.1 Physical Connectivity

In this example case, the 4G and 5G access networks are based on an L2 network. The 5G access network is newly built for the NR introduction.

Multiple NR and LTE baseband units are collocated. They are connected to the remote cell sites through the fronthaul network, and to the access network through the L2 switches.

Below figure shows the example RAN physical connectivity example of an NR SA and LTE deployment scenario.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 68   Physical Connectivity Example of NR SA and LTE Deployment Scenario

The NR SA and LTE scenario example has the following characteristics:

- Baseband NR is deployed for NR SA, and Baseband LTE is used for LTE.
- The multiplexer (MUX) and demultiplexer (DEMUX) devices are used for Wavelength Division Multiplexing (WDM) fronthaul that transports eCPRI between NR Baseband and AIR 6488.
- Direct fibers are used for the CPRI links between the LTE Baseband and the LTE radio.
- A GPS Signal Splitter is used in the RAN to split the GPS synchronization signal to each baseband unit. The GPS Signal Splitter has one single antenna input and offers two, four, or eight outputs. In the RAN site, multiple GPS Signal Splitters are provisioned for NR and LTE Baseband units. For other NR synchronization options, see Network Synchronization Solution Guideline.
- The NR Baseband units are connected to the 5G Access Network through the 10 GE fiber link. The LTE baseband units are connected to the 4G Access Network through the 1 GE or 10 GE fiber link.
- In the example in above figure, the 4G and 5G Access Networks are based on the L2 network with a distant aggregation router as the next hop.

Below tables show the port connections for NR and LTE Baseband unit.

| Interface (Port)   | To                         |
|--------------------|----------------------------|
| 10 GE              | 5G L2 Access Network       |
| eCPRI              | NR AIR (through fronthaul) |
| SYNC               | GNSS                       |

| Interface (Port)   | To                        |
|--------------------|---------------------------|
| 1 GE or 10 GE      | 4G L2 Access Network      |
| CPRI               | Radio (through fronthaul) |
| SYNC               | GNSS                      |

### 4.1.2 Logical Connectivity

Below figure shows the L2 and routing design.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 69   Logical Connectivity

Two VRs are configured in the NR and LTE Baseband unit. These are the VR\_RAN and the VR\_OAM. The VRs are used to separate the traffic and routing information between different IP domains.

VR\_RAN is used for user plane and control plane traffic, and VR\_OAM is used for OAM traffic.

In each Baseband unit, there are two VLANs. One is the RAN VLAN and the other is the OAM VLAN. The backhaul is the L2 network in the example, and the two VLANs cross the network from the Baseband to the aggregation routers. The aggregation routers are connected to the 5GC and EPC through the RAN VPN and the OAM VPN respectively.

Four IP subnetworks are provisioned. These are used for the following purposes:

- NR RAN
- LTE RAN
- NR OAM
- LTE OAM

Belw figure shows the MOM configuration of logical connectivity design in LTE.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 70   MOM Configuration of LTE Baseband

Below figure shows the MOM configuration of NR Baseband.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 71   MOM Configuration of NR Baseband

Four IPs are configured in the Baseband units and the aggregation routers in each IP subnetwork. The Virtual Router Redundancy Protocol (vRRP) runs between the aggregation routers to provide resilience. The vRRP IP address is the default gateway for each Baseband unit. Below tables show the IP interfaces defined in NR and LTE Baseband unit. The GNBCUCPFunction.EndpointResource and GNBCUUPFunction.EndpointResource are referenced by GNBCUCPFunction.endpointResourceRef and GNBCUUPFunction.endpointResourceRef respectively.

| VR   | IP Interface   | Type     | Reference by MO                                                                                       | Description               |
|------|----------------|----------|-------------------------------------------------------------------------------------------------------|---------------------------|
| RAN  | RAN/32         | Loopback | MO SctpEndpoint, referenced by MO GNBCUCPFunction.EndpointResource.LocalSctpEndpoint (set Enum to NG) | NG-C                      |
| RAN  | RAN/32         | Loopback | MO SctpEndpoint, referenced by MO GNBCUCPFunction.EndpointResource.LocalSctpEndpoint (set Enum to Xn) | Xn-C                      |
| RAN  | RAN/32         | Loopback | MO SctpEndpoint, referenced by MO GNBCUCPFunction.EndpointResource.LocalSctpEndpoint (set Enum to X2) | EN-DC X2-C                |
| RAN  | RAN/32         | Loopback | MO GNBCUUPFunction.EndpointResource.LocalIpEndpoint (set EnumList to NG, S1, Xn, X2)                  | NG-U, S1-U, Xn-U and X2-U |
| OAM  | OAM/32         | Loopback | OamAccessPoint.accessPoint                                                                            | OAM                       |

| VR   | IP Interface   | Type     | Reference by MO                        | Description               |
|------|----------------|----------|----------------------------------------|---------------------------|
| RAN  | RAN/32         | Loopback | ENodeBFunction.sctpref to SctpEndpoint | S1-C, X2-C and EN-DC X2-C |
| RAN  | RAN/32         | Loopback | EnodeBFunction.upIpAddressRef          | S1-U, X2-U and EN-DC X2-U |
| OAM  | OAM/32         | Loopback | OamAccessPoint.accessPoint             | OAM                       |

Below Tables show the configuration of the IP subnetworks.

| Mask                                       | Network Element                                | Description                                              |
|--------------------------------------------|------------------------------------------------|----------------------------------------------------------|
| /29 or larger (IPv4), /64 or larger (IPv6) | NR Baseband #(1..n)                            | IP address used for NR RAN traffic, including NG and Xn  |
| /29 or larger (IPv4), /64 or larger (IPv6) | Loopback IP address of two aggregation routers | vRRP IP address as Baseband IP next-hop                  |
| /29 or larger (IPv4), /64 or larger (IPv6) | Aggregation Router 1                           | IP address for NR RAN connection in Aggregation Router 1 |
| /29 or larger (IPv4), /64 or larger (IPv6) | Aggregation Router 2                           | IP address for NR RAN connection in Aggregation Router 2 |

| Mask                 | Network Element                                | Description                                               |
|----------------------|------------------------------------------------|-----------------------------------------------------------|
| /29 or larger (IPv4) | LTE Baseband #(1..m)                           | IP address used for LTE RAN traffic including S1 and X2   |
| /29 or larger (IPv4) | Loopback IP address of two aggregation routers | vRRP IP as Baseband IP next-hop                           |
| /29 or larger (IPv4) | Aggregation Router 1                           | IP address for LTE RAN connection in Aggregation Router 1 |
| /29 or larger (IPv4) | Aggregation Router 2                           | IP address for LTE RAN connection in Aggregation Router 2 |

| Mask                                       | Network Element                                | Description                                              |
|--------------------------------------------|------------------------------------------------|----------------------------------------------------------|
| /29 or larger (IPv4), /64 or larger (IPv6) | NR Baseband #(1..n) /64 or larger (IPv6)       | IP address used for NR OAM traffic                       |
| /29 or larger (IPv4), /64 or larger (IPv6) | Loopback IP address of two aggregation routers | vRRP IP address as Baseband IP next-hop                  |
| /29 or larger (IPv4), /64 or larger (IPv6) | Aggregation Router 1                           | IP address for NR OAM connection in Aggregation Router 1 |
| /29 or larger (IPv4), /64 or larger (IPv6) | Aggregation Router 2                           | IP address for NR OAM connection in Aggregation Router 2 |

| Mask                                       | Network Element                                | Description                                               |
|--------------------------------------------|------------------------------------------------|-----------------------------------------------------------|
| /29 or larger (IPv4), /64 or larger (IPv6) | /64 or larger (IPv6) LTE Baseband #(1..m)      | IP address used for LTE OAM traffic                       |
| /29 or larger (IPv4), /64 or larger (IPv6) | Loopback IP address of two aggregation routers | vRRP IP address as Baseband IP next-hop                   |
| /29 or larger (IPv4), /64 or larger (IPv6) | Aggregation Router 1                           | IP address for LTE OAM connection in Aggregation Router 1 |
| /29 or larger (IPv4), /64 or larger (IPv6) | Aggregation Router 2                           | IP address for LTE OAM connection in Aggregation Router 2 |

### 4.1.3 Routing

In the case of the C-RAN example, the access network is L2-based. For this reason, the static routing protocol is simpler than the dynamic routing protocol. Therefore, static routing is used in the example. Static routing entries are configured in each virtual router of a Baseband unit.

Below table shows the routes to the aggregation router in the case of NR and LTE Baseband units.

| VR of the Baseband   | IP Network   | Next Hop                                                                                                                                                                                                                                                                   | Description   |
|----------------------|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
| VR_RAN               | 0/0          | RAN vRRP IP address of the aggregation router for an NR or LTE Baseband. The MOM attribute NextHop.Ipv4UnicastAddressStr in the RouteTableIpv4Static branch and NextHop.Ipv6AddressStr in the RouteTableIPv6Static branch specifies the next hop IP address for the route  | Default route |
| VR_OAM               | 0/0          | OAM vRRP IP address of the aggregation router for an NR or LTE Baseband. The MOM attribute NextHop.Ipv4UnicastAddressStr in the RouteTableIpv4Static branch and NextHop.Ipv6AddressStr in the RouteTableIPv6Static branch specifies the next hop IP address for the route. | Default route |

Below table shows the routes to the Baseband unit in the case of an aggregation router.

| VR of the Aggregation Router   | IP Network                          | Description        |
|--------------------------------|-------------------------------------|--------------------|
| VR_RAN                         | RAN-NR_BB-to-Aggregation_Router IP  | Directly connected |
| VR_RAN                         | RAN-LTE_BB-to-Aggregation_Router IP | Directly connected |
| VR_OAM                         | OAM-NR_BB-to-Aggregation_Router IP  | Directly connected |
| VR_OAM                         | OAM-LTE_BB-to-Aggregation_Router IP | Directly connected |

### 4.1.4 Application Traffic Flow

A trusted NR and LTE backhaul is deployed in the reference case.

Below figure shows the application traffic flow in an NR SA and LTE scenario in the case of a C-RAN with a trusted L2 access network.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 72   RAN Application Traffic Flow of NR SA and LTE Scenario

## 4.2 NR SA + NR NSA + LTE Scenario: C-RAN with Baseband Hotel
    Router in Trusted Backhaul

This C-RAN deployment example aggregates multiple Baseband units at the same site in a trusted backhaul network.

### 4.2.1 Physical Connectivity

Below figure shows the physical connectivity of an NR NSA and an NR SA network.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 73   Physical Connectivity Example of NR NSA and NR SA Networks

The Baseband units and the Remote Radio Units are connected through a fronthaul network. The fronthaul network aggregates the eCPRI and CPRI links together at a Baseband hotel site. Different eCPRI and CPRI data streams are extracted and distributed to corresponding radio units at a remote radio site. The Baseband hotel site and the remote radio site are connected by a single fiber through the fronthaul network. Two baseband hotel routers are provided to protect against transport link failures. Each Baseband unit connects to the Baseband hotel routers.

For information related to site synchronization solution, refer to Site Synchronization Deployment Guideline.

Below table shows the connections between Baseband units, radio units, and Baseband hotel routers.

| Interface                   | Connects To       |
|-----------------------------|-------------------|
| 10-Gigabit Ethernet TN Port | Transport network |
| eCPRI                       | Radio unit        |

| Interface                                         | Connects To       |
|---------------------------------------------------|-------------------|
| 1-Gigabit Ethernet or 10-Gigabit Ethernet TN Port | Transport network |
| CPRI                                              | Radio unit        |

### 4.2.2 Logical Connectivity

Each Baseband unit connects to two Baseband hotel routers. If one router fails, the other router keeps working.

There are two virtual routers in each Baseband unit: the RAN virtual router and the OAM virtual router. The IP addresses of RAN traffic and OAM traffic are defined as loopback addresses to provide IP layer redundancy in case of link failures. The loopback addresses can be reached through two physical ports on the Baseband units.

Below figure shows the logical connectivity of the NR SA, NR NSA, and LTE networks.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 74   Logical Connectivity

For the MOM configuration of Baseband LTE and Baseband NR, refer to above scenario example: NR SA + LTE Scenario: C-RAN with Trusted L2 Access Network.

### 4.2.3 IP Addressing

Below tables show the loopback IP addresses for RAN and OAM traffic. The GNBCUCPFunction.EndpointResource and GNBCUUPFunction.EndpointResource are referenced by GNBCUCPFunction.endpointResourceRef and GNBCUUPFunction.endpointResourceRef respectively.

| VR   | IP Interface   | Type     | Reference by MO                                                                                       | Description               |
|------|----------------|----------|-------------------------------------------------------------------------------------------------------|---------------------------|
| RAN  | RAN/32         | Loopback | MO SctpEndpoint, referenced by MO GNBCUCPFunction.EndpointResource.LocalSctpEndpoint (set Enum to NG) | NG-C                      |
| RAN  | RAN/32         | Loopback | MO SctpEndpoint, referenced by MO GNBCUCPFunction.EndpointResource.LocalSctpEndpoint (set Enum to Xn) | Xn-C                      |
| RAN  | RAN/32         | Loopback | MO SctpEndpoint, referenced by MO GNBCUCPFunction.EndpointResource.LocalSctpEndpoint (set Enum to X2) | EN-DC X2-C                |
| RAN  | RAN/32         | Loopback | MO GNBCUUPFunction.EndpointResource.LocalIpEndpoint (set EnumList to NG, S1, Xn, X2)                  | NG-U, S1-U, Xn-U and X2-U |
| OAM  | OAM/32         | Loopback | OamAccessPoint.accessPoint                                                                            | OAM                       |

| VR   | IP Interface   | Type     | Reference by MO                        | Description               |
|------|----------------|----------|----------------------------------------|---------------------------|
| RAN  | RAN/32         | Loopback | ENodeBFunction.sctpref to SctpEndpoint | S1-C, X2-C and EN-DC X2-C |
| RAN  | RAN/32         | Loopback | EnodeBFunction.upIpAddressRef          | S1-U, X2-U and EN-DC X2-U |
| OAM  | OAM/32         | Loopback | OamAccessPoint.accessPoint             | OAM                       |

Below Tables show the different IP subnetworks for each link.

| IP Subnetwork or VLAN   | Mask                 | IP Interface                                                      |
|-------------------------|----------------------|-------------------------------------------------------------------|
| RAN-BBH1-to-NR_BB#n     | /30 or larger (IPv4) | /30 subnet on the link and the IP address on each end of the link |
| RAN-BBH1-to-LTE_BB#m    | /30 or larger (IPv4) | /30 subnet on the link and the IP address on each end of the link |
| OAM-BBH1-to-NR_BB#n     | /30 or larger (IPv4) | /30 subnet on the link and the IP address on each end of the link |
| OAM-BBH1-to-LTE_BB#m    | /30 or larger (IPv4) | /30 subnet on the link and the IP address on each end of the link |
| RAN-BBH2-to-NR_BB#n     | /30 or larger (IPv4) | /30 subnet on the link and the IP address on each end of the link |
| RAN-BBH2-to-LTE_BB#m    | /30 or larger (IPv4) | /30 subnet on the link and the IP address on each end of the link |
| OAM-BBH2-to-NR_BB#n     | /30 or larger (IPv4) | /30 subnet on the link and the IP address on each end of the link |
| OAM-BBH2-to-LTE_BB#m    | /30 or larger (IPv4) | /30 subnet on the link and the IP address on each end of the link |
| RAN-Inter-BBH           | /30 or larger (IPv4) | /30 subnet on the link and the IP address on each end of the link |
| OAM-Inter-BBH           | /30 or larger (IPv4) | /30 subnet on the link and the IP address on each end of the link |

### 4.2.4 Routing

Static routing is used between Baseband nodes and Baseband Hotel Routers. The Baseband Hotel Routers are connected to Backhaul PE routers with eBGP, and the dual Baseband Hotel Routers are connected to each other with iBGP.

The L3VPN is used to provide RAN VPN and OAM VPN over the backhaul. There are two BGP Autonomous Systems (AS), one AS is provisioned in the Baseband Hotel Router, and the other AS is provisioned in the backhaul network. Below figure shows an example of this.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 75   Routing Design

In this example, Baseband Hotel Router 1 and Baseband Hotel Router 2 are the Customer Edge (CE) routers in the Baseband Hotel Router AS. PE1 and PE2 are Provider Edge (PE) routers in the backhaul network AS. The iBGP session is established between CE1 and CE2 to exchange the RAN and OAM VPN route between two Baseband Hotel Routers. The eBGP session is established between CE routers and PE routers.

Only the NR Baseband is shown in this example, as the LTE Baseband uses the same routing domain definition.

Below table shows the summary of BGP sessions for both RAN and OAM VR.

| BGP Domain                               | BGP Session Type   |
|------------------------------------------|--------------------|
| BBH Router1 and PE1, OAM                 | eBGP               |
| BBH Router1 and PE1, RAN                 | eBGP               |
| BBH Router2 and PE2, OAM                 | eBGP               |
| BBH Router2 and PE2, RAN                 | eBGP               |
| BBH Router1 and BBH Router2, RAN, or OAM | iBGP               |

The Baseband nodes are connected to the Baseband Hotel Routers with static routing.

The following routing configurations are applied in the Baseband nodes:

- In Baseband RAN VR, two default static routes towards the core network are configured with different priority. One static route is primary and the other is secondary. The RoutingRuleIpv4.NextHop attribute, with configuration of NextHop.adminDistance attribute defines priority value. The NextHop.adminDistance attribute set to 1 is for primary route and NextHop.adminDistance attribute set to 2 is for secondary route.
- In Baseband OAM VR, two default static routes towards the ENM are configured with different priority. One static route is primary and the other is secondary. The NextHop.adminDistance attribute set to 1 is for primary route and NextHop.adminDistance attribute set to 2 is for secondary route.

Routing configurations that are applied in the Baseband Hotel Routers are the following:

- In the RAN VR of Baseband Hotel Routers, the static route towards the Baseband RAN loopback IP address is configured. The Bidirectional Forwarding Detection (BFD) configuration monitors the route reachability during the process. Depending on the status of the BFD session, the static route is added to or removed from the routing table. In the BGP routing domain, this static route towards the Baseband RAN loopback IP is redistributed into the BGP. It is recommended to deploy the BGP routing filter in Baseband Hotel Router 1 or Baseband Hotel Router 2 to avoid the RAN loopback IP advertised into the eBGP peer PE1 or PE2. If the static route to RAN loopback IP is removed from the routing table because of BFD session failure, the iBGP route to the RAN loopback is also retrieved in Baseband Hotel Router 1 or Baseband Hotel Router 2. This way the routing loop is prevented between Baseband Hotel Router1 and Baseband Hotel Router2 when the connection from Baseband to both Baseband Hotel Router1 and Baseband Hotel Router2 is down or when the Baseband fails.
- In the OAM VR of Baseband Hotel Routers, the static route towards the Baseband OAM loopback IP address is configured, with BFD configuration to monitor the route reachability. In the BGP routing domain, this static route towards the Baseband OAM loopback IP is redistributed into the BGP. It is recommended to deploy the BGP routing filter in Baseband Hotel Router 1 or Baseband Hotel Router 2 to avoid the OAM loopback IP advertised into the eBGP peer PE1 or PE2. BFD is used to prevent the routing loop between Baseband Hotel Router 1 and Baseband Hotel Router 2 with same mechanism.
- In the BGP domain, the aggregated IP subnetwork of the baseband RAN loopback IP addresses is advertised into the RAN VR BGP routing protocol of the Baseband Hotel Routers.
- In the BGP domain, the aggregated IP subnetwork of the baseband OAM loopback IP addresses is advertised into the OAM VR BGP routing protocol of the Baseband Hotel Routers.

Below tables shows the Routes in NR and LTE Baseband

| IP Network    | Next Hop               | Description                                         |
|---------------|------------------------|-----------------------------------------------------|
| 0/0 in RAN VR | RAN-BBH1-to-NR_BB#n.C1 | Primary default route (NextHop.adminDistance = 1)   |
| 0/0 in RAN VR | RAN-BBH2-to-NR_BB#n.D1 | Secondary default route (NextHop.adminDistance = 2) |
| 0/0 in OAM VR | OAM-BBH1-to-NR_BB#n.C2 | Primary default route (NextHop.adminDistance = 1)   |
| 0/0 in OAM VR | OAM-BBH2-to-NR_BB#n.D2 | Secondary default route (NextHop.adminDistance = 2) |

| IP Network    | Next Hop               | Description                                         |
|---------------|------------------------|-----------------------------------------------------|
| 0/0 in RAN VR | RAN-BBH1-to-NR_BB#n.C4 | Primary default route (NextHop.adminDistance = 1)   |
| 0/0 in RAN VR | RAN-BBH2-to-NR_BB#n.D4 | Secondary default route (NextHop.adminDistance = 2) |
| 0/0 in OAM VR | OAM-BBH1-to-NR_BB#n.C3 | Primary default route (NextHop.adminDistance = 1)   |
| 0/0 in OAM VR | OAM-BBH2-to-NR_BB#n.D3 | Secondary default route (NextHop.adminDistance = 2) |

Below table shows the Routes in Baseband Hotel Routers

| IP Network                        | Next Hop                | Description          |
|-----------------------------------|-------------------------|----------------------|
| RAN loopback IP of NR Baseband#n  | RAN-BBH1-to-NR_BB#n.A1  | Primary static route |
| RAN loopback IP of NR Baseband#n  | RAN-Inter-BBH.D5        | Secondary iBGP route |
| RAN loopback IP of LTE Baseband#m | RAN-BBH1-to-LTE_BB#m.B1 | Primary static route |
| RAN loopback IP of LTE Baseband#m | RAN-Inter-BBH.D5        | Secondary iBGP route |
| Core Network IP subnetworks       | RAN-BBH1-to-PE#1.E1     | Primary static route |
| Core Network IP subnetworks       | RAN-Inter-BBH.D5        | Secondary iBGP route |
| OAM loopback IP of NR Baseband#n  | OAM-BBH1-to-NR_BB#n.A2  | Primary static route |
| OAM loopback IP of NR Baseband#n  | OAM-Inter-BBH.D6        | Secondary iBGP route |
| OAM loopback IP of LTE Baseband#m | OAM-BBH1-to-LTE_BB#m.B2 | Primary static route |
| OAM loopback IP of LTE Baseband#m | OAM-Inter-BBH.D6        | Secondary iBGP route |
| ENM IP subnetworks                | OAM-BBH1-to-PE#1.E3     | Primary static route |
| ENM IP subnetworks                | OAM-Inter-BBH.D6        | Secondary iBGP route |

| IP Network                        | Next Hop                | Description          |
|-----------------------------------|-------------------------|----------------------|
| RAN loopback IP of NR Baseband#n  | RAN-BBH2-to-NR_BB#n.A4  | Primary static route |
| RAN loopback IP of NR Baseband#n  | RAN-Inter-BBH.C5        | Secondary iBGP route |
| RAN loopback IP of LTE Baseband#m | RAN-BBH2-to-LTE_BB#m.B4 | Primary static route |
| RAN loopback IP of LTE Baseband#m | RAN-Inter-BBH.C5        | Secondary iBGP route |
| Core Network IP subnetworks       | RAN-BBH2-to-PE#2.E2     | Primary static route |
| Core Network IP subnetworks       | RAN-Inter-BBH.C5        | Secondary iBGP route |
| OAM loopback IP of NR Baseband#n  | OAM-BBH2-to-NR_BB#n.A3  | Primary static route |
| OAM loopback IP of NR Baseband#n  | OAM-Inter-BBH.C6        | Secondary iBGP route |
| OAM loopback IP of LTE Baseband#m | OAM-BBH2-to-LTE_BB#m.B3 | Primary static route |
| OAM loopback IP of LTE Baseband#m | OAM-Inter-BBH.C6        | Secondary iBGP route |
| ENM IP subnetworks                | OAM-BBH2-to-PE#2.E4     | Primary static route |
| ENM IP subnetworks                | OAM-Inter-BBH.C6        | Secondary iBGP route |

The above two tables list the route table entries in the VRs of the different nodes.

### 4.2.5 Application Traffic Flow

In this example design, the backhaul network is trusted, and there is no SEG used in the application traffic flow.

Below figure shows the application traffic flow in an NR SA, NR NSA, and LTE scenario in the case of a C-RAN with CSR in the trusted backhaul.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 76   RAN Application Traffic Flow of NR SA, NR NSA, and LTE Scenario

## 4.3 NR SA + NR NSA + LTE Scenario: C-RAN Network with RAN
    Processor 6672

This section presents the deployment of C-RAN for NR SA, NR NSA, and LTE networks using high-capacity RAN Processor 6672 units, these units offer greater capacity compared to legacy Baseband units, resulting in a more efficient and cost-effective network configuration.

### 4.3.1 C-RAN with RAN Processor 6672 Overview

At each radio site, there are NR TDD AIR units and NR LTE FDD radio units. The AIR units are connected to baseband through the fronthaul network using eCPRI, whereas the FDD radio units use CPRI links for connection. The figure below shows an example of a C-RAN network that offers both eCPRI and CPRI connections between the C-RAN hub site and the radio site.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 77   C-RAN Hub Site and Radio Site Connection

At each radio site, the AIR and radio units coexist:

- eCPRI NR AIR: The NR AIR units serve NR FR1 TDD cells and are connected to the RAN Processor 6672 at the C-RAN hub site using eCPRI links.
- CPRI NR and LTE Radio: These radio units support NR or LTE FR1 FDD cells and connect to the network through CPRI links, while the RAN Processor 6672 at the hub utilizes eCPRI. To facilitate the interconnection between the radio units and the RAN Processor 6672, the conversion from eCPRI to CPRI is performed.

At the C-RAN hub site, the RAN Processor 6672 units can be configured in the following ways:

- RAN Processor 6672 units for NR FR1 TDD: These units are dedicated for NR FR1 TDD cells by aggregating and processing signals from the eCPRI connected AIR units.
- RAN Processor 6672 units for NR and LTE FR1 FDD: These units are for NR and LTE FR1 FDD cells and connect to CPRI linked radio units.

Fronthaul networks ensure connectivity between Baseband units and radio units without affecting radio performance. Two fronthaul deployment scenarios are available: Dense Wavelength Division Multiplexing (DWDM) Fronthaul and Ethernet Fronthaul.

### 4.3.2 C-RAN Network with DWDM Fronthaul

The below figure shows C-RAN network based on DWDM fronthaul.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 78   C-RAN Network with RAN Processor 6672, DWDM Fronthaul

In this C-RAN network, the fronthaul network is implemented using DWDM technology with the Fronthaul 6587 and Fronthaul 6689 deployed in radio site and hub site respectively. The DWDM fronthaul supports high-performance end-to-end solutions for low-latency transport of CPRI or eCPRI links between radio site and hub site.

For detail of DWDM fronthaul, see NR Optical Fronthaul Solution Guideline.

#### 4.3.2.1 eCPRI to eCPRI Point-to-point for RAN Processor 6672 and
        AIR Unit

With eCPRI to eCPRI point-to-point connectivity, an RI port on the RAN Processor 6672 unit can connect to one RI port on one AIR unit with eCPRI link through the DWDM fronthaul.

The below figure shows the eCPRI to eCPRI point-to-point connectivity between RAN Processor 6672 and NR AIR units, with the corresponding RiPort and RiLink MO configurations represented in the figure.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 79   RAN Processor 6672 and NR AIR eCPRI to eCPRI Point-to-point Connectivity

The below table shows example configuration for each C-RAN network nodes.

| Network Element    | Description                                                                                                                                                    |
|--------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Fronthaul Units    | Fronthaul units are deployed at both the C-RAN hub site and the radio site, interconnected with each other.                                                    |
| RAN Processor 6672 | The RAN Processor 6672 is configured in NR single mode to accommodate 48 NR FR1 TDD cells, with its 12 RI ports connected to NR AIR units via 25G eCPRI links. |
| eCPRI NR AIR       | 4 carriers per NR AIR and operates with a 25G eCPRI link speed.                                                                                                |

#### 4.3.2.2 eCPRI to eCPRI Point-to-multipoint for RAN Processor 6672
        and AIR Unit

The eCPRI to eCPRI point-to-multipoint connection between RAN Processor 6672 and AIR units is an alternative option. In this example the RAN Processor 6672 is configured in NR single mode to handle a total of 48 NR TDD carriers. It utilizes 12 RI ports in a point-to-multipoint connection, supporting 24 NR AIR units, with each AIR unit managing 2 carriers. For point-to-multipoint connectivity see Point-to-Multipoint Packet Fronthaul.

The below figure shows the eCPRI to eCPRI point-to-multipoint connectivity between RAN Processor 6672 and NR AIR units, with the corresponding RiPort, RiLink and RiNetwork MO configurations represented in the figure.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 80   RAN Processor 6672 and NR AIR eCPRI to eCPRI Point-to-multipoint Connectivity

The below table shows example configuration for each C-RAN network element.

| Network Element    | Description                                                                                                                                                          |
|--------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Fronthaul Units    | Fronthaul units are deployed at both the C-RAN hub site and the radio site, interconnected with each other.                                                          |
| RAN Processor 6672 | The RAN Processor 6672 is configured in NR single mode for 48 NR FR1 TDD cells, with 12 RI ports utilized for eCPRI connections to NR AIR units at a 25G link speed. |
| Router 6673        | eCPRI to eCPRI Point-to-multipoint splitting and switching, converting 1 RI port's eCPRI link into 2 separate eCPRI connections.                                     |
| eCPRI NR AIR       | 2 carriers per NR AIR and operates with a 25G eCPRI link speed. (1)                                                                                                  |

Note(1): The figure shows a 25G eCPRI link rate auto-negotiated for connections from the RAN Processor 6672 to each AAS unit, while in this example, 10G rate is used per AAS for NR cell bandwidth and MIMO dimensioning to prevent over-dimensioning.

#### 4.3.2.3 eCPRI to CPRI Conversion for RAN Processor 6672 and Radio
        Unit

The below figure shows the eCPRI to CPRI conversion for RAN Processor 6672 and radio units connectivity. At the C-RAN hub site, Router 6673 provide split function converting from the eCPRI link into four separate CPRI links in this example.

The below figure shows the eCPRI to CPRI conversion connectivity between RAN Processor 6672 and radio units. At the C-RAN hub site, Router 6673 splits 1 eCPRI link into 4 separate CPRI links.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 81   RAN Processor 6672 and Radio eCPRI to CPRI Conversion Connectivity

The below table shows example configuration for each C-RAN network element.

| Network Element                  | Description                                                                                                                                                                                        |
|----------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Fronthaul Units                  | Fronthaul units are deployed at both the C-RAN hub site and the radio site, interconnected with each other.                                                                                        |
| RAN Processor 6672               | The RAN Processor 6672 is configured in mixed mode for 48 NR and LTE FR1 FDD cells, with 6 RI ports connecting to Router 6673 via one 25Gbps eCPRI link, and it manages a total of 24 radio units. |
| Router 6673 with LC-05 line card | eCPRI to CPRI conversion converts 1 eCPRI link into 4 separate CPRI connections. (1)                                                                                                               |
| CPRI NR LTE Radio                | One NR carrier and one LTE carrier per NR LTE radio unit, utilizing one CPRI link connection per one radio unit.                                                                                   |

Note(1): In this example, 1 eCPRI link is converted to 4 CPRI links. To determine the capacity, including the number of carriers and bandwidth supported by this eCPRI link, see CPRI and eCPRI Capacity.

### 4.3.3 C-RAN Network with Ethernet Fronthaul

The below figure shows the Ethernet Fronthaul based C-RAN network with multiple high-capacity RAN Processor 6672 units.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 82   C-RAN Network Example with RAN Processor 6672, Ethernet Fronthaul

In this C-RAN network example, the fronthaul network is implemented using Ethernet Fronthaul technology, with Router 6673 and Router 6678 deployed in both radio site and hub site respectively. Router 6678 units provide redundancy to ensure reliability in the event of a link or node failure, Router 6673 unit are dedicated to each radio site for converting eCPRI link to eCPRI or CPRI links.

For detail of the Ethernet Fronthaul, see Ethernet Fronthaul Solution Guideline.

#### 4.3.3.1 eCPRI to eCPRI Point-to-multipoint for RAN Processor 6672
        and NR AIR Unit

For the eCPRI to eCPRI Point-to-multipoint connection the RAN Processor 6672 is configured in NR single mode, which can support 48 NR TDD carriers. For example, if the 12 RI ports of the RAN Processor 6672 are used to establish point-to-multipoint connections, with each RI port connected to two NR AIR units, the system supports 24 NR AIR units, with each AIR unit handling 2 carriers.

The below figure shows the eCPRI to eCPRI point-to-multipoint connectivity between RAN Processor 6672 and NR AIR units, with the corresponding RiPort, RiLink and RiNetwork MO configurations represented in the figure.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 83   RAN Processor 6672 and NR AIR eCPRI to eCPRI Point-to-multipoint Connectivity

The below table shows example configuration for each C-RAN network element.

| Network Element          | Description                                                                                                                                                                                  |
|--------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Ethernet Fronthaul Units | Router 6678 and Router 6673 are deployed at both the C-RAN hub site and the radio site, interconnected with each other.                                                                      |
| RAN Processor 6672       | The RAN Processor 6672 is configured in NR single mode to support NR FR1 TDD cells, accommodating 48 NR TDD carriers, with six RI ports connected via 25G eCPRI links.                       |
| Router 6678              | Router 6678 serves as a packet gateway at the C-RAN hub site, connecting to RAN Processor 6672 units.                                                                                        |
| Router 6673              | The eCPRI to eCPRI point-to-multipoint splitting and switching converts a single eCPRI link into two separate eCPRI connections, facilitating connections to NR AIR units at the radio site. |
| eCPRI NR AIR             | 4 carriers per NR AIR and operates at a 25G eCPRI link speed. (1)                                                                                                                            |

Note(1): In the C-RAN network, eCPRI connections to NR AIR units operate at a 25G link speed. However, the two NR AIR units share a maximum bandwidth of 25Gbps because of the limitations of the eCPRI RI port on the RAN Processor 6672.

#### 4.3.3.2 eCPRI to CPRI Conversion for RAN Processor 6672 and Radio
        Unit

The below figure shows the eCPRI to CPRI conversion for RAN Processor 6672 and NR AIR units. At radio site, Router 6673 provide split function converting from the eCPRI link into 4 separate CPRI links.

The below figure shows the eCPRI to CPRI conversion connectivity between RAN Processor 6672 and NR AIR units, with the corresponding RiPort, RiLink and RiNetwork MO configurations represented in the figure.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 84   RAN Processor 6672 and Radio eCPRI to CPRI Conversion Connectivity

In this example, the Router 6673 in radio site convert eCPRI traffic to CPRI traffic, converting 1 eCPRI link from the RAN Processor 6672 into 4 separate CPRI links.

The below table shows example configuration for each C-RAN network element.

| Network Element                  | Description                                                                                                                                                                             |
|----------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Ethernet Fronthaul Units         | Router 6678 and Router 6673 are deployed at both the C-RAN hub site and the radio site, interconnected with each other.                                                                 |
| RAN Processor 6672               | The RAN Processor 6672 is configured in mixed mode to support NR and LTE FR1 FDD cells, accommodating 48 NR FDD and LTE FR1 FDD cells, with six RI ports connected via 25G eCPRI links. |
| Router 6678                      | Router 6678 acts as a packet gateway at the C-RAN hub site, connecting to RAN Processor 6672 units there.                                                                               |
| Router 6673 with LC-05 line card | The Router 6673 performs eCPRI to CPRI conversion, transforming one eCPRI link into four separate CPRI links, and connects to radio units at the radio site.                            |
| CPRI NR LTE Radio                | 1 NR carrier and 1 LTE carrier per NR LTE Radio, utilizing one CPRI link per unit.                                                                                                      |

## 4.4 NR SA + NR NSA + LTE Scenario: D-RAN with Untrusted
    Backhaul

In this example of a D-RAN site, the NR Baseband supports NR NSA and NR SA simultaneously under the same cell. It is applicable for customers who have an NR NSA network and want to introduce NR SA option 2.

The example design is a typical D-RAN case with three NR cells supported on each Baseband. LTE and NR Baseband units are co-located with a CSR that aggregates the traffic from and to the RAN site. The MBH network is untrusted, and IPsec is used to protect the traffic.

### 4.4.1 Physical Connectivity

Below figure shows an example of the physical connectivity of the NR SA, NR NSA, and LTE scenario with untrusted MBH.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 85   Physical Connectivity of Untrusted Mobile Backhaul

The physical connectivity diagram is based on the following principles:

- Baseband NR is to deploy NR, while Baseband LTE refers to any Baseband unit acting as the eNodeB and capable of supporting NR NSA option 3x (EN-DC).
- The direct fibers are used for the CPRI or eCPRI links between Baseband units and radios. The number of CPRI or eCPRI links depends on dimensioning.
- GNSS and APTS as assisting reference are used for time and phase synchronization connected to both baseband units.
- The NR and LTE Baseband units are connected to the CSR, which aggregates the traffic to the untrusted transport backhaul.

Below table shows the port connections for NR and LTE Baseband units.

| Interface     | Connects To   |
|---------------|---------------|
| 10 GE TN port | CSR           |
| eCPRI         | AIR unit      |
| SYNC          | GNSS          |

| Interface             | Connects To   |
|-----------------------|---------------|
| 1 GE or 10 GE TN Port | CSR           |
| CPRI                  | Radio unit    |

### 4.4.2 Logical Connectivity

Because of the untrusted MBH network, IPsec VPN connections are designed to protect the RAN traffic and the OAM traffic.

In Baseband NR, the following IPsec VPNs are required towards the SEG:

- One IPsec VPN connection to protect NG, S1-U, EN-DC X2 and Xn traffic.
- One IPsec VPN connection to protect the OAM traffic.

In the Baseband LTE, the following IPsec VPN connections are required towards the SEG:

- One IPsec VPN connection to protect S1 and X2 traffic.
- One IPsec VPN connection to protect the OAM traffic.

Between Ericsson Baseband units Direct IPsec VPN connections can be established to protect X2 and Xn traffic.

In a Baseband unit configuration for IPsec, three different networks are used: one outer network and two inner networks.

The outer network provides the untrusted transport to or from the Baseband unit. The inner networks are trusted (IPsec protected) and carry RAN and OAM traffic. Separating the inner and outer networks into different VRs is recommended to provide each network with its own addressing and routing.

Below figure shows the design recommendations for the logical connectivity of the untrusted MBH in the case of the NR SA, NR NSA, and LTE scenario.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 86   RAN Logical Connectivity of Untrusted MBH

### 4.4.3 IP Addressing

Each Baseband unit has three VRs (inner RAN VR, inner OAM VR, and outer VR). The RAN and OAM applications are bound to an IP interface on the corresponding inner VRs. One IP interface on the outer VR is used to communicate with remote SEGs as IPsec VPN connection endpoints.

Below tables show the IP interfaces in inner VRs. The GNBCUCPFunction.EndpointResource and GNBCUUPFunction.EndpointResource are referenced by GNBCUCPFunction.EndpointResource and GNBCUUPFunction.EndpointResource respectively.

| VR   | IP Interface   | Type      | Reference by MO                                                                                       | Description   |
|------|----------------|-----------|-------------------------------------------------------------------------------------------------------|---------------|
| RAN  | RAN/32         | IPSEC VPN | MO SctpEndpoint, referenced by MO GNBCUCPFunction.EndpointResource.LocalSctpEndpoint (set Enum to NG) | NG-C          |
| RAN  | RAN/32         | IPSEC VPN | MO SctpEndpoint, referenced by MO GNBCUCPFunction.EndpointResource.LocalSctpEndpoint (set Enum to Xn) | Xn-C          |
| RAN  | RAN/32         | IPSEC VPN | MO SctpEndpoint, referenced by MO GNBCUCPFunction.EndpointResource.LocalSctpEndpoint (set Enum to X2) | Xn-C          |
| RAN  | RAN/32         | IPSEC VPN | MO GNBCUUPFunction.EndpointResource.LocalIpEndpoint (set EnumList to NG, S1, Xn, X2)                  | Xn-C          |
| OAM  | OAM/32         | IPSEC VPN | OamAccessPoint.accessPoint                                                                            | OAM           |

| VR   | IP Interface   | Type      | Reference by MO                        | Description   |
|------|----------------|-----------|----------------------------------------|---------------|
| RAN  | RAN/32         | IPSEC VPN | ENodeBFunction.sctpref to SctpEndpoint | S1-C, X2-C    |
| RAN  | RAN/32         | IPSEC VPN | EnodeBFunction.upIpAddressRef          | S1-U, X2-U    |
| OAM  | OAM/32         | IPSEC VPN | OamAccessPoint.accessPoint             | OAM           |

A VLAN is used for the IP subnetwork setup between the Baseband and the CSR. It is used for carrying all the traffic through the outer VR.

Below table shows the IP subnetwork configuration. The GNBCUCPFunction.EndpointResource and GNBCUUPFunction.EndpointResource are referenced by GNBCUCPFunction.EndpointResource and GNBCUUPFunction.EndpointResource respectively.

| Network Element   | VR       | IP Interface         | Type                     | Reference by MO                                                             | Description                                               |
|-------------------|----------|----------------------|--------------------------|-----------------------------------------------------------------------------|-----------------------------------------------------------|
| Baseband NR       | Outer VR | TN-Untrust-NR.A1/30  | VLAN-based encapsulation | MO GNBCUUPFunction.EndpointResource.LocalIpsecEndpoint (set EnumList to X2) | Direct IPsec VPN connection with EN-DC X2 eNodeB neighbor |
| Baseband LTE      | Outer VR | TN-Untrust-LTE.A1/30 | VLAN-based encapsulation | ENodeBFunction.IpsecEndcEpAddressRef                                        | Direct IPsec VPN connection with EN-DC X2 gNodeB neighbor |

### 4.4.4 Routing

There are two different types of network in the Baseband unit: one outer network and two inner networks. The outer network and the inner network are separated and use different routing mechanisms.

The transport of the inner traffic over the outer network is done through an IPsec VPN connection. There is one local endpoint in the outer VR and one remote endpoint in the SEG.

The outer VR is the IP routing domain and the Untrust\_VRF in the CSR.

Below two tables show the different routes in the VRs, connected to different nodes.

| VR           | Destination Network   | Next Hop                                                                                                                                                                                                                     | Description                                                                                                                                                            |
|--------------|-----------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Inner RAN VR | 0/0                   | IPsec VPN Interface as next hop. The NextHop.reference MO attribute specifies the tunnel InterfaceIPv4 or InterfaceIPv6 MO in the inner network. The MOs are specified as a next hop rather as addresses of a default router | Default route to the SEG connected to the core site. The static route is used to route traffic from the inner network through the IPsec VPN connection through the SEG |
| Inner OAM VR | 0/0                   | IPsec VPN Interface as next hop. The NextHop.reference MO attribute specifies the tunnel InterfaceIPv4 or InterfaceIPv6 MO in the inner network. The MOs are specified as a next hop rather as addresses of a default router | Default route to the SEG connected to the ENM. The static route is used to route traffic from the inner network through the IPsec VPN connection through the SEG       |

| VR                       | Destination Network   | Next Hop              | Description   |
|--------------------------|-----------------------|-----------------------|---------------|
| Outer VR of Baseband NR  | 0/0                   | (TN-Untrust-NR).B1    | Default route |
| Outer VR of Baseband LTE | 0/0                   | (TN-Untrust-NR)LTE.B2 | Default route |

### 4.4.5 Application Traffic Flow

Below figure shows the application traffic flow in an NR SA, NR NSA, and LTE scenario in the case of a D-RAN with untrusted backhaul.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 87   RAN Application Traffic Flow of the Untrusted MBH

The RAN traffic of each Baseband unit is protected through one IPsec VPN connection toward the SEG. OAM traffic is protected in another IPsec VPN connection in the SEG.

## 4.5 NR SA + NR NSA + LTE Scenario: D-RAN with Mixed Mode Baseband
    in Trusted MBH

This example is a typical D-RAN site in trusted MBH. The NR and LTE RATs are collocated in the site. Both NR NSA and NR SA run simultaneously under the same cell. This design introduces Mixed Mode Baseband supporting LTE and NR RATs. The Mixed Mode Baseband can simplify the network setup and reduce hardware cost. However, the anchored LTE is in a dedicated baseband for easy operation. It is applicable for the scenario where the Mixed Mode Baseband meets the capacity requirements.

### 4.5.1 Physical Connectivity

Below figure shows the example physical connectivity in RAN site.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 88   Physical Connectivity

The Mixed Mode Baseband supports both NR and LTE RATs. The NR RAT supports both the NR SA and NR NSA networks. The LTE baseband is non-anchored for NR NSA in the Mixed Mode Baseband. The Mixed Mode Baseband is connected to a Mixed Mode Radio through CPRI links.

The Anchored Baseband LTE is used for another LTE frequency band, which is the Anchored Baseband LTE for the NR NSA network. The Anchored Baseband LTE is connected to LTE RU through CPRI links. Both the Anchored Baseband LTE and the Mixed Mode Baseband NR + LTE are connected to a cell site router. The cell site router is responsible for the traffic of the RAN site.

The SYNC ports are connected to a GNSS receiver in both Mixed Mode Baseband and LTE node. GNSS and APTS as assisting reference is used for time and phase synchronization.

Below tables show the port connections for baseband units.

| Interface             | Connects To   |
|-----------------------|---------------|
| 1 GE or 10 GE TN port | CSR           |
| CPRI                  | Radio unit    |
| SYNC                  | GNSS          |

| Interface             | Connects To   |
|-----------------------|---------------|
| 1 GE or 10 GE TN Port | CSR           |
| CPRI                  | Radio unit    |

### 4.5.2 Logical Connectivity

From a logical connectivity perspective, RAN application traffic and OAM traffic needs to be separated. Two separated VPNs of OAM and RAN are created to carry the OAM traffic and the RAN traffic respectively.

The RAN VPN is further split to RAN\_LTE and RAN\_NR VPNs. Between the Baseband and CSR, VLAN-based IP subnets are defined.

Below figure shows the example logical connectivity.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 89   Logical Connectivity

In the Mixed Mode Baseband NR + LTE, the following virtual routers are defined:

VR RAN\_LTE The VR RAN\_LTE is used for the eNodeB function traffic, such as S1 and X2. One IP interface of RAN\_LTE is defined in the VR RAN\_LTE. This interface is encapsulated in the VLAN of BH-MMLTE between CSR and Baseband.

VR RAN\_NR The VR RAN\_NR is used for the following gNodeB traffic for both NR SA and NR NSA:

- NG
- Xn
- S1-U
- ENDC-X2

One IP interface of RAN\_NR is defined in the VR RAN\_NR. This interface is encapsulated in the VLAN of BH-MMNR between CSR and Baseband.

VR OAM The VR OAM is used for the management traffic of the Baseband, such as NETCONF and SNMP. One IP interface of OAM is defined in the VR OAM. This interface is encapsulated in the VLAN of OAM-MM between CSR and Baseband.

Below figure shows the related MOM configurations of the Mixed Mode Baseband and the relation of RAN traffic to the transport network.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 90   MOM Configuration of Mixed Mode Baseband

In the anchored Baseband LTE, the following virtual routers are defined:

VR RAN The VR RAN is used for the following RAN traffic:

- S1
- X2
- ENDC X2

One IP interface of RAN is defined and encapsulated in the VLAN of BH-LTE between CSR and Baseband.

VR OAM The VR OAM is used for the management traffic of the Baseband, such as NETCONF and SNMP. One IP interface of OAM is defined and encapsulated in the VLAN of OAM-LTE between CSR and Baseband.

Below figure shows the related MOM configurations of the Anchored Baseband LTE and the relation of RAN traffic to the transport network.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 91   MOM Configuration of Anchored Baseband LTE

### 4.5.3 IP Addressing

Below table summarizes the IP addressing design in the Baseband units.

The encapsulations are based on the VLAN subnet. Both IPv4 and IPv6 are supported. The subnet mask needs to meet the minimal requirement of the number of IP addresses in the RAN site.

In the cell site router, it is necessary to consider the IP addressing on the subnets that are connected to the Baseband units. It is also necessary to consider the IP addressing towards the mobile backhaul network.

| VR      | IP Interface   | Type               | Address or Mask                  | Description                                  |
|---------|----------------|--------------------|----------------------------------|----------------------------------------------|
| RAN_LTE | RAN_LTE        | VLAN Encapsulation | A1 / 30 (IPv4) or A1 / 64 (IPv6) | Paired IP address of C1 in VR RAN of the CSR |
| RAN_NR  | RAN_NR         | VLAN Encapsulation | A2 / 30 (IPv4) or A2 / 64 (IPv6) | Paired IP address of C2 in VR RAN of the CSR |
| OAM     | OAM            | VLAN Encapsulation | A3 / 30 (IPv4) or A3 / 64 (IPv6) | Paired IP address of D1 in VR OAM of the CSR |

| VR   | IP Interface   | Type               | Address or Mask                  | Description                                  |
|------|----------------|--------------------|----------------------------------|----------------------------------------------|
| RAN  | RAN            | VLAN Encapsulation | B1 / 30 (IPv4) or B1 / 64 (IPv6) | Paired IP address of C3 in VR RAN of the CSR |
| OAM  | OAM            | VLAN Encapsulation | B2 / 30 (IPv4) or B2 / 64 (IPv6) | Paired IP address of D2 in VR OAM of the CSR |

### 4.5.4 Routing

Static routing method is used in the baseband. In each VR of the baseband, one default route is configured with CSR as the next hop. In the CSR, the packet is forwarded to the baseband following the connected route. The routes to the Baseband units must be distributed to the RAN VPN and OAM VPN connected to the cell site router, for example, by using BGP.

Below tables show the routes in the baseband units and CSR.

| VR      | IP Network   | Next Hop                          | Description          |
|---------|--------------|-----------------------------------|----------------------|
| RAN_LTE | 0/0          | C1 interface of VR RAN in the CSR | Default static route |
| RAN_NR  | 0/0          | C2 interface of VR RAN in the CSR | Default static route |
| OAM     | 0/0          | D1 interface of VR OAM in the CSR | Default static route |

| VR   | IP Network   | Next Hop                          | Description          |
|------|--------------|-----------------------------------|----------------------|
| OAM  | 0/0          | D2 interface of VR OAM in the CSR | Default static route |
| RAN  | 0/0          | C3 interface of VR RAN in the CSR | Default static route |

| VR   | IP Network   | Next Hop             | Description     |
|------|--------------|----------------------|-----------------|
| RAN  | A1/30        | VLAN-based IP subnet | Connected route |
| RAN  | A2/30        | VLAN-based IP subnet | Connected route |
| RAN  | B1/30        | VLAN-based IP subnet | Connected route |
| OAM  | A3/30        | VLAN-based IP subnet | Connected route |
| OAM  | B2/30        | VLAN-based IP subnet | Connected route |

### 4.5.5 Application Traffic Flow

Below figure shows the E2E application traffic flow of the example scenario.

The Mixed Mode Baseband is used for NR SA, NR NSA and LTE.

The Anchored Baseband LTE is for normal LTE and anchored LTE traffic. The X2 traffic and the ENDC X2 traffic between the Mixed Mode Baseband and the Anchored Baseband LTE are handled locally in the cell site router.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 92   Application Traffic Flow

## 4.6 NR SA + NR NSA + LTE Scenario: D-RAN with RAN Processor
    6672

This example is a high capacity D-RAN site in a trusted MBH with NR, and LTE RATs. The NR NSA and NR SA operating simultaneously under the same cell. To address high capacity scenarios, the RAN Processor 6672 unit is used to serve as the primary baseband node to support NR SA, NSA and LTE, the baseband 6621 is utilized to support NR and LTE.

Note: RAN Processor 6655 can effectively replace RAN Processor 6672 as the baseband unit for a D-RAN site, particularly if the site's capacity demands are not excessively high.

Below figure shows the physical connectivity of the D-RAN example with Baseband 6621 cascaded to RAN Processor 6672.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 93   Physical Connectivity of D-RAN Network Example with RAN Processor 6672

The RAN Processor 6672 offers significantly higher capacity and supports mixed mode operation, enabling both NR SA, NR NSA and LTE. RAN Processor 6672 provides higher capacity, which allows for handling more traffic with fewer units. This D-RAN site example reduced the number of baseband and fewer cable connections, leading to simplifies network architecture, high capacity, and maintains operational flexibility while enhancing energy efficiency.

The D-RAN network example has the following characteristics:

- The mixed mode baseband configuration of the RAN Processor 6672 support both NR and LTE carriers. For mixed mode configurations for RAN Processor 6672, see DU and Baseband Configurations and Capacity.
- The RAN Processor 6672 unit is connected to AIR and Radio with eCPRI links and CPRI links.
- The RAN Processor 6672 connects to the CSR router, the connection rate is determined according to D-RAN site dimensions.
- The Baseband 6621 are cascaded to the RAN Processor 6672, and Baseband 6621 is used for additional NR and LTE carriers.

Below table shows the connections between Baseband units, radio units, and CSR router.

| Baseband           | Interface         | Traffic Type     | Connects To        |
|--------------------|-------------------|------------------|--------------------|
| RAN Processor 6672 | 25G Ethernet TN C | Backhaul traffic | CSR                |
| RAN Processor 6672 | 25G Ethernet TN D | Backhaul traffic | Baseband 6621      |
| Baseband 6621      | 25G Ethernet TN C | Backhaul traffic | RAN Processor 6672 |

| Baseband           | Interface   | Traffic Type      | Connects To   |
|--------------------|-------------|-------------------|---------------|
| RAN Processor 6672 | RI A/B/C    | Fronthaul traffic | NR AIR        |
| RAN Processor 6672 | RI D/E/F    | Fronthaul traffic | NR LTE Radio  |
| Baseband 6621      | RI A/B/C    | Fronthaul traffic | NR LTE Radio  |

Note: The RAN Processor 6672 with 18 RI ports support maximum of 18 Radio or NR AIR units directly through eCPRI or CPRI connections. If the D-RAN site requires support for more than 18 Radio or NR AIR units, Router 6673 with LC-05 line card can be deployed to extend the number of connections.

## 4.7 NR SA+ NR NSA+LTE Scenario: IPv4-based NSA + IPv6-based
    SA

In this section, an example design of gNodeB with IPv4-based NSA and IPv6-based SA is given. This design is applicable when IPv6 is introduced in NR SA network. This example is based on D-RAN site in trusted MBH.

### 4.7.1 Physical Connectivity

Below figure shows the example of physical connectivity of IPv4-based NSA and IPv6-based SA. Another section describes the RAN site physical connectivity in detail.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 94   Physical Connectivity of IPv4 NSA and IPv6 SA

### 4.7.2 Logical Connectivity

In pure IPv4 network scenario, two separated VPNs of OAM and RAN are created to carry the OAM traffic and the RAN traffic respectively. However, it is recommended to set up one more RAN\_IPv6 VPN to carry the IPv6-based NR SA traffic, as shown in below figure. The benefits of introducing IPv6-based VPN are:

1. No dependency on the support of dual-stack IPv4v6 VPN in transport network
2. Ease of OAM thanks to the clean IP version design

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 95   Logical Connectivity of IPv4 NSA and IPv6 SA

In the Baseband NR, the following virtual routers are defined:

VR RAN\_IPv6 It is used for the NR SA traffics, including NG-C, NG-N, Xn-C, and Xn-U. One IPv6 interface of A1 is defined in the VR RAN\_IPv6. The A1 interface is encapsulated in the VLAN of BH-RAN-IPv6 between CSR and Baseband.

VR RAN It is used for the NR NSA traffics including S1-U, X2-C, and X2-U. One IPv4 interface of A2 is defined in the VR RAN. The A2 interface is encapsulated in the VLAN of BH-RAN between CSR and Baseband.

VR OAM The VR OAM is used for the management traffic of the Baseband, such as NETCONF and SNMP. One IPv4 interface of A3 is defined in the VR OAM. The interface A3 is encapsulated in the VLAN of BH-OAM between CSR and Baseband.

Below figure shows the related MOM configurations of the Baseband NR and the relation of RAN traffic to the transport network.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 96   MOM Configuration in Baseband NR with IPv4 NSA and IPv6 SA

In the Anchored Baseband LTE, the following virtual routers are defined:

VR RAN It is used for the NR NSA traffics including S1-C, S1-U, X2-C, and X2-U. One IPv4 interface of B1 is defined in the VR RAN. The B1 interface is encapsulated in the VLAN of BH-LTE between CSR and Baseband.

VR OAM The VR OAM is used for the management traffic of the Baseband, such as NETCONF and SNMP. One IPv4 interface of B2 is defined in the VR OAM. The interface B2 is encapsulated in the VLAN of OAM-LTE between CSR and Baseband.

Below figure shows the related MOM configurations of the Baseband LTE and the relation of RAN traffic to the transport network.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 97   MOM Configuration in the Anchored Baseband LTE

### 4.7.3 IP Addressing

Below tables summarize the IP addressing design in the Baseband units. The encapsulations are based on the VLAN subnet. IPv4 is used for LTE and NR NSA traffics, while IPv6 is used for NR SA traffics.

| VR       | IP Interface   | Type               | Address or Mask   | Description                                  |
|----------|----------------|--------------------|-------------------|----------------------------------------------|
| OAM      | OAM            | VLAN Encapsulation | A3/30             | Paired IP address of C4 in VR OAM of the CSR |
| RAN      | RAN            | VLAN Encapsulation | A2/30             | Paired IP address of C2 in VR OAM of the CSR |
| RAN-IPv6 | RAN-IPv6       | VLAN Encapsulation | A1/64             | Paired IP address of C1 in VR RAN of the CSR |

| VR   | IP Interface   | Type               | Address or Mask   | Description                                  |
|------|----------------|--------------------|-------------------|----------------------------------------------|
| RAN  | RAN            | VLAN Encapsulation | B1/30             | Paired IP address of C3 in VR RAN of the CSR |
| OAM  | OAM            | VLAN Encapsulation | B2/30             | Paired IP address of C5 in VR OAM of the CSR |

In the cell site router, it is necessary to consider the IP addressing on the subnets that are connected to the Baseband units. It is also necessary to consider the IP addressing towards the mobile backhaul network.

### 4.7.4 Routing

Static routing method is used in the Baseband. In each VR of the Baseband, one default route is configured with CSR as the next hop. In the CSR, the packet is forwarded to the Baseband following the connected route. The routes to the Baseband units must be distributed to the RAN VPN, RAN-IPV6 VPN, and OAM VPN connected to the cell site router, for example, by using BGP.

Below tables show the routes in the Baseband units and CSR.

| VR       | IP Network   | Next Hop                               | Description               |
|----------|--------------|----------------------------------------|---------------------------|
| RAN-IPv6 | ::/0         | C1 interface of VR RAN-IPv6 in the CSR | Default IPv6 static route |
| RAN      | 0.0.0.0/0    | C2 interface of VR RAN in the CSR      | Default IPv4 static route |
| OAM      | 0.0.0.0/0    | C4 interface of VR OAM in the CSR      | Default IPv4 static route |

| VR   | IP Network   | Next Hop                          | Description               |
|------|--------------|-----------------------------------|---------------------------|
| OAM  | 0.0.0.0/0    | C5 interface of VR OAM in the CSR | Default IPv4 static route |
| RAN  | 0.0.0.0/0    | C3 interface of VR RAN in the CSR | Default IPv4 static route |

| VR       | IP Network   | Next Hop                         | Description     |
|----------|--------------|----------------------------------|-----------------|
| RAN      | B1/30        | BH-LTE VLAN-based IP subnet      | Connected route |
| RAN      | A2/30        | BH-RAN VLAN-based IP subnet      | Connected route |
| OAM      | A3/30        | BH-OAM VLAN-based IP subnet      | Connected route |
| OAM      | B2/30        | OAM-LTE VLAN-based IP subnet     | Connected route |
| RAN-IPv6 | A1/64        | BH-RAN-IPv6 VLAN-based IP subnet | Connected route |

### 4.7.5 Application Traffic Flow

Below figure shows the E2E application traffic flow of the example scenario: IPv4-based NSA and IPv6-based SA. In the Baseband NR, the NSA traffics of S1-U and EN-DC X2 go through the IPv4-based MBH network, while the SA traffics of NG and Xn go through the IPv6-based MBH. In this example, OAM traffic of the Baseband NR goes through the IPv4-based MBH network. It is assumed that the existing ENM manages both NR and LTE network at the same time.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 98   Application Traffic Flow of IPv4 NSA and IPv6 SA

## 4.8 NR SA + NR NSA + LTE Scenario: Traffic Separation with
    Different IP Addresses Over the Same VLAN

In this section, a connectivity design example of traffic separation with different IP addresses over one VLAN is described. This design example can be used in NR SA, NR NSA, and LTE network scenarios, in which Mixed Mode Baseband is deployed. In the RAN site, NR SA, NR NSA and LTE traffic is separated with different IP addresses, but is carried over one same VLAN.

### 4.8.1 Physical Connectivity

For an example on physical connectivity, see Physical Connectivity in the NR SA + NR NSA + LTE Scenario: D-RAN with Mixed Mode Baseband in Trusted MBH section.

### 4.8.2 Logical Connectivity

Below figure shows the logical connectivity design. In the MBH network, RAN application traffic and OAM traffic are separated from each other with two VPNs of OAM and RAN. In CSR and Baseband units, two corresponding VRs are defined for OAM traffic and RAN traffic separately. The VLAN-based IP subnets are used for the connectivity between Baseband units and CSR.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 99   Logical Connectivity of Multiple IP Addresses over the Same VLAN

In the Mixed Mode Baseband NR+LTE, the following virtual routers are defined:

'VR RAN It is used for all the RAN traffics of NR SA, NR NSA, and LTE. One IP interface named RAN is defined in the VR RAN. This IP interface is encapsulated in the BH-MM VLAN between the CSR and the MM Baseband. Three IP addresses, A1, A2, and A3 are defined for the IP interface RAN. These three IP addresses belong to the same IP subnet, to which IP address of C1 also belongs in CSR.

VR OAM It is used for the management traffic of the Mixed Mode Baseband. One IP interface named OAM is defined in the VR OAM. This IP interface of OAM is encapsulated in the OAM-MM VLAN between the CSR and the Baseband. IP address A4 is defined for the IP interface of OAM.

Note: Up to four IPv4 or IPv6 addresses can be configured per VLAN with the same or different non-overlapping subnets. This case shows IPv4-based scenario for simplicity.

Below figure shows the MO configurations of logical connectivity design in the Mixed Mode Baseband.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 100   MO Configurations of Multiple IP Addresses over the Same VLAN

For information on the connectivity design of the anchored Baseband LTE, see Logical Connectivity of the NR SA + NR NSA + LTE Scenario: D-RAN with Mixed Mode Baseband in Trusted MBH network design example.

Note: There are small IP addressing differences between the two example designs.

### 4.8.3 IP Addressing

Below tables summarize the IP addressing design in Mixed Mode Baseband and anchored Baseband. The encapsulations are based on the VLAN subnet. Only IPv4 is supported in Mixed Mode Baseband NR+LTE. Both IPv4 and IPv6 are supported in the anchored Baseband LTE. In total, the Mixed Mode Baseband needs four IP addresses, while the anchored Baseband LTE needs two IP addresses.

| VR   | IP Interface   | Type               | IP Address                   | Description                                  |
|------|----------------|--------------------|------------------------------|----------------------------------------------|
| RAN  | RAN            | VLAN Encapsulation | A1 / 29, A2 / 29, or A3 / 29 | Paired IP address of C1 in VR RAN of the CSR |
| OAM  | OAM            | VLAN Encapsulation | A4 / 30                      | Paired IP address of C3 in VR OAM of the CSR |

| VR   | IP Interface   | Type               | IP Address   | Description                                  |
|------|----------------|--------------------|--------------|----------------------------------------------|
| RAN  | RAN            | VLAN Encapsulation | B1 / 30      | Paired IP address of C2 in VR RAN of the CSR |
| OAM  | OAM            | VLAN Encapsulation | B2 / 30      | Paired IP address of C4 in VR OAM of the CSR |

### 4.8.4 Routing

Below tables show the routes in the Baseband units and the CSR. The static routing method is used in this example. In each VR of the Baseband units, the default route is configured with the interface of the CSR as the next hop. In the CSR, packets are forwarded to the Baseband following the connected routes. The IP addresses of the Baseband units must be distributed to the RAN VPN and OAM VPN connected to the CSR, for example, by using BGP.

| VR   | IP Network   | Next Hop                          | Description          |
|------|--------------|-----------------------------------|----------------------|
| RAN  | 0/0          | C1 interface of VR RAN in the CSR | Default static route |
| OAM  | 0/0          | C3 interface of VR OAM in the CSR | Default static route |

| VR   | IP Network   | Next Hop                          | Description          |
|------|--------------|-----------------------------------|----------------------|
| RAN  | 0/0          | C2 interface of VR RAN in the CSR | Default static route |
| OAM  | 0/0          | C4 interface of VR OAM in the CSR | Default static route |

| VR   | IP Network   | Next Hop                     | Description     |
|------|--------------|------------------------------|-----------------|
| RAN  | A1/29        | BH-MM VLAN-based IP subnet   | Connected route |
| RAN  | B1/30        | BH-LTE VLAN-based IP subnet  | Connected route |
| OAM  | A4/30        | OAM-MM VLAN-based IP subnet  | Connected route |
| OAM  | B2/30        | OAM-LTE VALN-based IP subnet | Connected route |

### 4.8.5 Application Traffic Flow

For an example on application traffic flow, see Application Traffic Flow in the NR SA + NR NSA + LTE Scenario: D-RAN with Mixed Mode Baseband in Trusted MBH section.

## 4.9 NR-NR Dual Connectivity (NR-DC) + EN-DC Scenario: D-RAN with
    Trusted Backhaul

This example is designed for NR-NR Dual connectivity feature, which introduces support for Frequency Range 1 (FR1) and Frequency Range 2 (FR2) dual connectivity for NR SA UE connected to 5G Core Network. Similarly as EN-DC option 3x principle, in NR-DC deployment, UE connects to one anchor gNodeB acts as Master Node (MN) and another gNodeB acts as Secondary Node (SN), MN provides MCG over FR1, SN provides SCG over FR2. The control signaling is only carried through MN, while the user-plane data can be carried through both MN and SN in either fast-switch mode or aggregation mode for both UL and DL.

This reference solution introduces an example that NR-DC(FR1+FR2) is added over an EN-DC(FR1+FR2)+SA(FR1) network. Below figure shows the roles for FR1 gNodeB and FR2 gNodeB, and the gNodeB can take different roles depending on the capability of the UE, coverage of served nodes and Radio Resource Management(RRM) strategy.

Three roles can be taken by FR1 anchor gNodeB node:

- gNodeB for NR SA UE
- SN for EN-DC UE
- MN for NR-DC UE

Two roles can be taken by FR2 HB gNodeB node:

- SN for EN-DC UE
- SN for NR-DC UE

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 101   MO Configurations of Multiple IP Addresses over the Same VLAN

Two connectivity example designs are introduced as following sub-charters, both are based on trusted backhaul, one LTE+NR Mixed Mode Baseband is used to carry LTE anchor and NR FR1 anchor carriers, the other NR Single Mode Baseband is used to carry NR FR2 carriers.

- D-RAN Use Case (UC): The first use case is to show the scenario that both baseband units are connected to CSR, X2 and Xn traffic flows between these two baseband units go through CSR.
- D-RAN with direct cable UC in Co-site Scenario: The second use case is recommended in co-site scenario, where in addition to the connections to CSR for both baseband units, there is a local direct link existing in between, so the local X2 and Xn traffic flows go through direct cable, rather than CSR, considering the high traffic volume for NR-DC UCs over Xn.

### 4.9.1 D-RAN

#### 4.9.1.1 Physical Connectivity

Below figure shows the physical connectivity of D-RAN use case. Two baseband units can be either co-located or neighbored:

- Three High-band AIR units connect to one Single Mode Baseband with maximal 800 MHz IBW*2 layers per AIR.
- Three NR FR1 AAS and three LTE AAS connect to one LTE+NR Mixed Mode Baseband.

In such example design, the GNSS connects to the CSR to provision time and phase synchronization, which both EN-DC and NR-DC are required.

This reference solution introduces the example design that NR-DC is introduced over an EN-DC(FR1+FR2)+SA(FR1) network, during the migration, there can be no new baseband to be added, but only some configuration changes are needed as following:

- Configurations of Xn or NG interfaces are added in NR Single Mode Baseband.
- Configurations of Xn towards NR Single Mode Baseband are added in LTE+NR Mixed Mode Baseband.
- NR-DC related configurations are needed including NR neighbor relationship between NR FR1 anchor cells and NR FR2 cells in both NR Single Mode Baseband and LTE+NR Mixed Mode Baseband.

For more information, see NR-NR Dual Connectivity.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 102   Physical Connectivity of D-RAN NR-DC

#### 4.9.1.2 Logical Connectivity

In this use case, the NR-DC traffic over Xn between Single Mode Baseband and Mixed Mode Baseband goes through CSR as solid orange line shown in below figure.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 103   Logical Connectivity of D-RAN NR-DC

The VR configurations for each baseband unit are the following:

- OAM VR: one IP interface is configured in OAM VR, and one IP address is defined under such IP interface to carry OAM traffic.
- RAN VR:
    - LTE+NR Mixed Mode Baseband works in LTE+ NSA+SA multi-mode with the same IP version, one IP interface is configured in RAN VR, and two IP addresses are defined within the same subnet under such IP interface, so they can share the same VLAN:
        - LTE RAN IP works as LTE termination of traffic flows for S1-C/U and X2-C/U in LTE UCs and NR NSA UCs.
        - NR RAN IP works as NR termination of traffic flows for:
            - X2-C/U and S1-U in NR NSA UCs
            - F1-U (MN termination of NR-DC traffic), Xn-C/U and NG-C/U in NR FR1 SA or NR-DC UCs
    - NR Single Mode Baseband works in NSA+SA dual-mode with the same IP version, one IP interface is configured in RAN VR, and one IP address is defined under such IP interface and works as NR termination of traffic flows for:
        - X2-C/U and S1-U in NR NSA UCs
        - Xn-C/U and NG-U in NR-DC UCs

For IPv4 for NSA and IPv6 for SA configuration, see the related information in NR SA+ NR NSA+LTE Scenario: IPv4-based NSA + IPv6-based SA.

#### 4.9.1.3 IP Addressing

Below tables show the IP addressing design, both IPv4 and IPv6 are supported.

| VR                 | IP Interface                                     | Type of Interface Encapsulation   | IP Address /Mask                               | Description                                                    |
|--------------------|--------------------------------------------------|-----------------------------------|------------------------------------------------|----------------------------------------------------------------|
| VLAN Encapsulation | LTE RAN IP / 29 (IPv4) or LTE RAN IP / 64 (IPv6) | IP address for LTE termination    |                                                |                                                                |
| RAN                | RAN                                              | VLAN Encapsulation                | NR RAN IP / 29 (IPv4) or NR RAN IP / 64 (IPv6) | IP address for NR termination of both NSA and SA traffic flows |
| OAM                | OAM                                              | VLAN Encapsulation                | OAM IP / 30 (IPv4) or OAM IP / 64 (IPv6)       | IP address for OAM termination of OAM traffic flow             |

| VR   | IP Interface   | Type of Interface Encapsulation   | IP Address /Mask                            | Description                                                    |
|------|----------------|-----------------------------------|---------------------------------------------|----------------------------------------------------------------|
| RAN  | RAN            | VLAN Encapsulation                | RAN IP / 30 (IPv4) or NR RAN IP / 64 (IPv6) | IP address for NR termination of both NSA and SA traffic flows |
| OAM  | OAM            | VLAN Encapsulation                | OAM IP / 30 (IPv4) or OAM IP / 64 (IPv6)    | IP address for OAM termination of OAM traffic flow             |

Note: Considering multiple IP addresses on the same VLAN is enabled in IP interface 'RAN' in LTE+NR Mixed Mode Baseband, /29 netmask is used than other IP interfaces.

#### 4.9.1.4 Routing

Below tables show the routing design.

| Dst (VR)   | Next Hop   | Description          |
|------------|------------|----------------------|
| 0/0 (RAN)  | B3         | Default static route |
| 0/0 (OAM)  | B4         | Default static route |

| Dst (VR)   | Next Hop   | Description          |
|------------|------------|----------------------|
| 0/0 (RAN)  | B2         | Default static route |
| 0/0 (OAM)  | B1         | Default static route |

#### 4.9.1.5 Application Traffic Flow

Below figure shows the application traffic flow.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 104   Application Traffic Flow for D-RAN NR-DC

### 4.9.2 D-RAN with Direct Cable

In co-site deployment scenario, one direct link can be added between NR Single Mode Baseband and LTE+NR Mixed Mode Baseband to make sure local X2 and Xn traffic flows through such local direct link.

#### 4.9.2.1 Physical Connectivity

Below figure shows the physical connectivity of D-RAN with direct cable use case. The example design is trusted backhaul based example.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 105   Physical Connectivity of D-RAN with Direct Cable

#### 4.9.2.2 Logical Connectivity

In this use case, the NR-DC traffic over Xn between NR Single Mode Baseband and LTE+NR Mixed Mode Baseband goes through local direct link as solid orange line shown in below figure.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 106   Logical Connectivity of D-RAN with Direct Cable

- OAM VR: one IP interface is configured in OAM VR, and one IP address is defined under such IP interface to carry OAM traffic.
- RAN VR:
    - LTE+NR Mixed Mode Baseband works in LTE+ NSA+SA multi-mode with the same IP version, two IP interfaces are defined:
        - 1st IP interface is configured as 'RAN', two IP addresses are defined within the same subnet under such IP interface, so they can share the same VLAN:
            - 'LTE RAN IP' works as LTE termination of traffic flows for S1-C/U and X2-C/U in LTE UCs and NR NSA UCs.
            - 'NR RAN IP' works as NR termination of traffic flows for:
                - X2-C/U and S1-U in NR NSA UCs
                - F1-U (MN termination of NR-DC traffic), Xn-C/U and NG-C/U in NR FR1 SA or NR-DC UCs
        - 2nd IP interface is configured as 'Local', one IP address 'A2' is defined as nexthop IP for local X2/Xn traffic in static route.
    - NR Single Mode Baseband works in NSA+SA dual-mode with the same IP version, two IP interfaces are defined:
        - 1st IP interface is configured as 'RAN', one IP address is defined under such IP interface and works as NR termination of traffic flows for:
            - X2-C/U and S1-U in NR NSA UCs
            - Xn-C/U and NG-U in NR-DC UCs
        - 2nd IP interface is configured as 'Local', one IP address 'A1' is defined as nexthop IP for local X2/Xn traffic in static route.

Note: IP addresses 'A1' and 'A2' are only used as 'nexthop' in static routes between NR Single Mode Baseband and LTE+NR Mixed Mode Baseband, will not be exposed in external IP networks, consequently, the same IP addresses can be reused in all pairs of co-site LTE+NR Mixed Mode Baseband and NR Single Mode Baseband.

#### 4.9.2.3 IP Addressing

Below tables show the IP addressing design, both IPv4 and IPv6 are supported.

| VR   | IP Interface   | Type               | IP Address /Mask                                 | Description                                                    |
|------|----------------|--------------------|--------------------------------------------------|----------------------------------------------------------------|
| RAN  | RAN            | VLAN Encapsulation | LTE RAN IP / 29 (IPv4) or LTE RAN IP / 64 (IPv6) | IP address for LTE termination of traffic flows                |
| RAN  | RAN            | VLAN Encapsulation | NR RAN IP / 29 (IPv4) or NR RAN IP / 64 (IPv6)   | IP address for NR termination of both NSA and SA traffic flows |
| RAN  | Local          | VLAN Encapsulation | A2 / 32 (IPv4) or A2 /128 (IPv6)                 | IP local endpoint for local X2/Xn traffic route                |
| OAM  | OAM            | VLAN Encapsulation | OAM IP / 30 (IPv4) or OAM IP / 64 (IPv6)         | IP address for OAM termination of OAM traffic flows            |

| VR   | IP Interface   | Type               | IP Address /Mask                               | Description                                                    |
|------|----------------|--------------------|------------------------------------------------|----------------------------------------------------------------|
| RAN  | RAN            | VLAN Encapsulation | NR RAN IP / 30 (IPv4) or NR RAN IP / 64 (IPv6) | IP address for NR termination of both NSA and SA traffic flows |
| RAN  | Local          | VLAN Encapsulation | A1/32 (IPv4) or A1/128 (IPv6)                  | IP local endpoint for local X2/Xn traffic route                |
| OAM  | OAM            | VLAN Encapsulation | OAM IP / 30 (IPv4) or OAM IP / 64 (IPv6)       | IP address for OAM termination of OAM traffic flows            |

Note: Considering multiple IP addresses on the same VLAN is enabled in IP interface 'RAN' in LTE+NR Mixed Mode Baseband, /29 netmask is used than other IP interfaces.

#### 4.9.2.4 Routing

Below tables show the routing design.

| Dst (VR)                      | Next Hop   | Description                                                     |
|-------------------------------|------------|-----------------------------------------------------------------|
| 0/0 (RAN)                     | B3         | Default static route                                            |
| RAN IP/32 or RAN IP/128 (RAN) | A1         | Static route for local X2/Xn traffic through local direct cable |
| 0/0 (OAM)                     | B4         | Default static route                                            |

| Dst (VR)                              | Next Hop   | Description                                            |
|---------------------------------------|------------|--------------------------------------------------------|
| 0/0 (RAN)                             | B2         | Default static route                                   |
| LTE RAN IP/32 or LTE RAN IP/128 (RAN) | A2         | Static route for local X2 traffic through direct cable |
| NR RAN IP/32 or NR RAN IP/128 (RAN)   | A2         | Static route for local Xn traffic through direct cable |
| 0/0 (RAN)                             | B1         | Default static route                                   |

#### 4.9.2.5 Application Traffic Flow

Below figure shows the application traffic flow.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 107   Application Traffic Flow of D-RAN with Direct Cable

## 4.10 NR-DC + Direct IPsec VPN for Xn

This example shows when IPsec is enabled, how NR-NR Dual Connectivity (NR-DC) traffic over Xn can be protected by Direct IPsec VPN for Xn.

Below figure shows a UE connected to one gNodeB acting as the Master Node (MN) and another gNodeB acting as the Secondary Node (SN). Direct IPsec VPN for Xn is established between gNodeBs. Xn GTP-U tunnel is established between IP1 and IP2 for for data forwarding of NR-DC SN terminated split bearer.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 108   NR-DC Traffic Flows Overview

Note: To have NR-DC traffic flow be protected by Direct IPsec VPN for Xn, the F1-U IP address reference under GNBDUFunction and Xn-U IP address reference under GNBCUUPFunction in MN node must refer the same IP address as shown in below figure.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 109   MO Instance of MN Node

## 4.11 NR SA Network Slicing Examples

### 4.11.1 NR SA Network Slicing Example: D-RAN with Untrusted Mobile
      Backhaul

A connectivity design example of network slicing is provided in this section. This design example covers two network slices: MBB and IOT in untrusted MBH. The MBB slice is the basis service, while the IOT slice is value-added service. In this example, only NR SA network aspects are considered from solution design point view.

#### 4.11.1.1 Physical Connectivity

Below figure shows the example physical connectivity of two network slices in untrusted MBH network.

Baseband NR is connected to NR AIRs through eCPRI ports. The TN port of the Baseband is used to carry the traffic to or from the MBH network. The link between the Baseband and the CSR is recommended to use 10GE port rate to reduce the traffic congestion among the different network slices.

SEG is used to protect the traffic of NG, Xn and OAM, considering that the MBH is untrusted. In each CN slice site, there is one SEG together with PCC and PCG products. Specially, AMF and ENM are in the MBB site.

Note: The physical connectivity design inside 5GC site is not covered this document.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 110   Physical Connectivity

| Interface                   | Connects To      |
|-----------------------------|------------------|
| 10-Gigabit Ethernet TN Port | Cell Site Router |
| eCPRI                       | Radio unit       |

Logical Connectivity

IPsec VPN connections are set up between Baseband NR and SEGs. There are three IPsec VPN connections to protect the traffic from or to the RAN site as show in below figure.

The first IPsec VPN connection (blue one) is used to protect the O&amp;M traffic between the Baseband NR and the ENM. The second IPsec VPN connection (green one) is set up between the Baseband NR and the SEG in MBB site. It protects the following three types of the RAN traffic:

- NG-C toward the default AMF
- NG-U traffic towards UPF of MBB slice
- Xn traffic between the Baseband units

The third IPsec VPN connection (orange one) is for the NG-U traffic of the IoT slice.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 111   Physical Connectivity

One outer VR and two inner VRs are defined in the Baseband NR. The outer VR provides the traffic transport to or from the Baseband in non-secured way. The inner networks are trusted with IPsec VPN connection protected. The inner OAM VR and the inner RAN VR carry OAM and RAN traffic respectively. Separating the inner and outer networks into different VRs is recommended to provide each network with its own addressing and routing.

In the RAN inner VR, there are two IPsec VPN interfaces to separate the traffic between MBB slice and IoT slice, by using the addresses of the SEG (for example, IP address of D1 or C1 in above figure) associated with IPsecTunnel MO class. One loopback IP interface is used for all the RAN applications, which ensures one single gNodeB IP address towards different CN site. If adding or deleting one network slice, it does not change the IP addressing in the Baseband.

In Cell Site Router, one Untrusted VRF is defined to route the traffic to or from the RAN site. This untrusted VRF links the outer network of the Baseband NR and the untrusted MBH.

#### 4.11.1.2 IP Addressing

In the Baseband NR, the OAM applications are bounded to the IPsec VPN interface with one IP address allocated in the inner OAM VR. The RAN applications are bound to the loopback interface with one IP address allocated in the inner RAN VR. It is not necessary to allocate IP addresses to the IPsec VPNl interfaces in the inner RAN VR. In the outer VR of the Baseband NR, one IP interface is used to communicate with remote SEGs.

Below tables show the IP interfaces in inner VRs of Baseband NR. The RAN\_IF interface is used for NG-C, NG-U, Xn-C, and Xn-U applications. The OAM\_IF is used for OAM applications. The MBB\_IF and IOT\_IF are two IPsec VPN interfaces without IP addressing. They are used for traffic steering in Inner RAN VR. The GNBCUCPFunction.EndpointResource and GNBCUUPFunction.EndpointResource are referenced by GNBCUCPFunction.endpointResourceRef and GNBCUUPFunction.endpointResourceRef respectively.

| IP Interface             | Type                | Reference by MO                                                                                       | Description                                                |
|--------------------------|---------------------|-------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
| RAN_IF/32                | Loopback            | MO SctpEndpoint, referenced by MO GNBCUCPFunction.EndpointResource.LocalSctpEndpoint (set Enum to NG) | NG-C                                                       |
| RAN_IF/32                | Loopback            | MO SctpEndpoint, referenced by MO GNBCUCPFunction.EndpointResource.LocalSctpEndpoint (set Enum to Xn) | Xn-C                                                       |
| RAN_IF/32                | Loopback            | MO GNBCUUPFunction.EndpointResource.LocalIpEndpoint (set EnumList to NG, Xn)                          | NG-U and Xn-U                                              |
| MBB_IF(No IP Addressing) | IPsec VPN Interface | N/A                                                                                                   | Used for forwarding NG traffic of MBB slice and Xn traffic |
| IOT_IF(No IP Addressing) | IPsec VPN Interface | N/A                                                                                                   | Used for forwarding NG-U traffic of IoT slice              |

| IP Interface   | Type                | Reference by MO            | Description              |
|----------------|---------------------|----------------------------|--------------------------|
| OAM_IF/32      | IPsec VPN Interface | OamAccessPoint.accessPoint | Used for OAM application |

One VLAN-based IP subnet is configured between the Baseband NR and the CSR. Two IP addresses are allocated in this IP subnet. Another VLAN-based IP subnet is also used for the connectivity to the untrusted MBH in this example. Below table shows the IP address of the IP Subnet in RAN site.

| IP Subnetwork or VLAN   | Network Element   | VR/VRFType   | IP Interface         | Description                                         |
|-------------------------|-------------------|--------------|----------------------|-----------------------------------------------------|
| TN-Untrust-NR           | Baseband NR       | Outer        | TN-Untrust-NR.A1/30  | Communication between CSR and Baseband NR           |
| TN-Untrust-NR           | CSR               | Untrusted    | TN-Untrust-NR.A2/30  | Communication between CSR and Baseband NR           |
| TN-Untrust-MBH          | CSR               | Untrusted    | TN-Untrust-MBH.B1/30 | Communication between CSR and untrusted MBH network |

#### 4.11.1.3 Routing

Each VR has its own routing table in the Baseband NR. These routing tables are separated from each other. The transport of the inner traffic over the outer network is done through the IPsec VPN interface connection. In Baseband NR, static routing mechanism is recommended for easy operation. Below table shows the different routes in the VRs in the Baseband NR.

| VR           | Destination Network         | Next Hop         | Description                                            |
|--------------|-----------------------------|------------------|--------------------------------------------------------|
| Inner RAN VR | 0/0                         | MBB_IF           | Default route to the 5GC applications in the MBB site  |
| Inner RAN VR | IP address of UPF in IoT CN | IOT_IF           | Route to the 5GC application connected to the IoT site |
| Inner OAM VR | 0/0                         | OAM_IF           | Default route to the ENM application                   |
| Outer VR     | 0/0                         | TN-Untrust-NR.A2 | Default route for the traffic from the Baseband        |

In the Inner RAN VR, all the packets are routed to the MBB CN network through the IPsec VPN interface of MBB\_IF by default. If the destination of the packet is the UPF in IoT CN, it is routed to the IoT CN through the IPsec VPN interface of IOT\_IF. For the OAM traffic in the Inner OAM VR, the default route is defined by IPsec VPN interface of OAM\_IF as next hop. For the traffic in the Outer VR, the default next hop is pointed to the CSR though the IP subnet of TN-Untrust-NR.

In the CSR, the traffic packet to the baseband is forwarded based on the connected route in the subnet of (TN-Untrust-NR) VLAN. eBGP mechanism is used to exchange the route between the CSR and the MBH network in this case. On one hand, the subnet of TN-Untrust-NR needs to be distributed into the MBH network. On the other hand, the IP address of the SEG must be learned by the CSR.

Below table shows the summarized routes in the CSR for Untrusted VR.

| Destination Network   | Next Hop          | Description                     |
|-----------------------|-------------------|---------------------------------|
| TN-Untrust-NR         | N/A               | Connected route                 |
| TN-Untrust-MBH        | N/A               | Connected route                 |
| Subnet of D1          | TN-Untrust-MBH.B2 | Learns from eBGP neighbor of B2 |
| Subnet of C1          | TN-Untrust-MBH.B2 | Learns from eBGP neighbor of B2 |
| Subnet of C3          | TN-Untrust-MBH.B2 | Learns from eBGP neighbor of B2 |

#### 4.11.1.4 Slice Logical Design

There are two network slices in this example. They belong to different slice type categories. The S-NSSAI values are designed as shown in Table 42. These two S-NSSAI values are configured on NRCellDU and GNBCUCPFunction MO classes in gNodeB. The supported S-NSSAIs information is exchanged with the AMF through NG-C interface, and with neighbor gNodeBs through Xn-C interface.

| Network Slice   |   S-NSSAI (SST) |   S-NSSAI (SD) | Description                |
|-----------------|-----------------|----------------|----------------------------|
| MBB             |               1 |              1 | Mobile Subscriber service  |
| IoT             |               3 |              1 | Smart Surveillance service |

Below figure describes the example of network slice logical design. Each UE only access one network slice and has one PDU session. In MBB slice, the internet service is provided through Data Network Name (DNN) of Internet. The voice service is fallback to VoLTE because of that VoNR is not ready. In the IoT slice, one DNN named Edgenet is set up for the IoT devices, which is mainly for the data computing of sensors.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 112   Slice Logical Design

In this example, one shared AMF is used by both MBB and IoT slices. The shared AMF is configured as default AMF in the TermPointToAmf MO in gNodeB. This default AMF is responsible for the NG-C traffic of both MBB and IoT slices. The AMF is connected to the gNodeB through the SEG in the MBB site. However, it is not necessary to configure UPF address/subnet in gNodeB. The IP address of the UPF is sent to gNodeB by the AMF during PDU session setup phase. In this example, the address/subnet of IoT UPF is used as IPsec VPN connection selection in 'Inner RAN VR'.

#### 4.11.1.5 Transport QoS

Following the E2E QoS guideline, 5QI value of 7 is used for living streaming service in IoT slice. The default QoS mapping table is recommended since QoS types are different between the IoT slice and the MBB slice. Below Table gives one design example of QoS setting for each slice in gNodeB. It is noted that the 5QIs of the voice service is used for EPS fallback trigger although there is no real voice traffic in the MBB slice.

| Network Slice   |   5QI Value | Resource Type   | QoS Mapping Method   |   DSCP Value | Description         |
|-----------------|-------------|-----------------|----------------------|--------------|---------------------|
| IoT             |           7 | Non-GBR         | Default              |           10 | Streaming Video     |
| MBB             |           1 | GBR             | Default              |           46 | Conversation Voice  |
| MBB             |           5 | Non-GBR         | Default              |           40 | IMS signaling Voice |
| MBB             |           9 | Non-GBR         | Default              |           14 | Internet Service    |

##### 4.11.1.5.1 QoS Enhancement

Below figure shows the traffic packets to or from the gNodeB. The IPsec VPN indicates the outer network information, including SEG and BB outer IP addresses and DSCP value. The IPsec VPN information is used by the transport nodes. The GTP tunnel indicates the inner network information, including UPF and BB inner IP address and DSCP value. The DSCP is the same for both IPsec VPN and GTP tunnel. Because of the ESP encapsulation, the GTP tunnel information is not visible by the transport nodes between gNodeB and SEG. Hence, the CSR can only recognize the information of IPsec VPN.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 113   Packet Identifier in Untrusted MBH

If different behaviors are expected between the IoT traffic and the MBB traffic, packet classification is done with IPsec VPN information in CSR. In this design example, each slice is associate with one dedicated IP address of the SEG. It means that the traffic can be classified based on the source IP address in downlink, and the destination IP address in uplink respectively.

Policy ACL (Access Control List) function is used to classify the slice traffic. Below table gives an example of Policy ACL design. It defines the QoS behaviors against the MBB and IoT slice traffic. The MBB traffic is mapped to internal QoS priority of 1, which is associated with Transport Class of 6. While the IoT traffic is mapped to one higher priority of 2.

| Traffic Flow   | Criteria: IP Protocol   |   QoS Priority |   TC | Description                    |
|----------------|-------------------------|----------------|------|--------------------------------|
| MBB_DL         | Src=C1, Dst=Any         |              1 |    6 | Downlink traffic from MBB site |
| MBB_UL         | Src=Any, Dst=C1         |              1 |    6 | Uplink traffic to MBB site     |
| IOT_DL         | Src=D1, Dst=Any         |              2 |    5 | Downlink traffic from IOT site |
| IOT_UL         | Src=Any, Dst=D2         |              2 |    5 | Uplink traffic to IOT site     |

Furthermore, the address of SEG can be used for transport resource partition (for example, VPN) in the untrusted MBH. The DSCP value can be used for traffic classification within each transport resource portioning. The enhancement can be performed in Provider Edge (PE) router.

#### 4.11.1.6 Application Traffic Flow

Below figure shows the application traffic flows of two network slices in untrusted MBH.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 114   Application Traffic Flow of Multiple Network Slice

The NG-C, Xn-C, NG-U and Xn-U of MBB and OAM traffic flows through SEG in MBB site. The NG-U and Xn-U traffic flows of IoT goes through the SEG in IoT site.

### 4.11.2 NR SA Network Slicing Example: Traffic Separation with IP
      VPNs

#### 4.11.2.1 Physical Connectivity

In this case, AIR units connect to the NR baseband through eCPRI links, 10 GE TN port is recommended to carry the traffic from and to CSR. There are two traffic slices, MBB slice and enterprise slice. MBB is the default slice, the AMF is located only in the MBB slice, while the SMF and UPF exist in both slices. From transport perspective, baseband works as Customer Edge (CE) device, while CSR works as Provider Edge (PE) router. Below figure shows the physical connectivity. Router 6000 can be used as CSR and Aggregation Router.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 115   Physical Connectivity of Slice Traffic Separation

#### 4.11.2.2 Logical Connectivity

In this case, there are two logical connectivity options.

Separate VPNs Used for MBB Slice and ENT Slice in CSR

In CSR, the L3VPN over Segment Routing is implemented between CSR Router and Aggregation Router. Three VRs are configured in the baseband, slice traffic is separated with different VPNs, each slice uses one dedicated VR for separation. The VRs in the baseband are defined as following:

- VR OAM: this VR is used for management traffic of baseband. One IP interface of OAM is defined in the VR OAM, it is encapsulated in the VLAN of BH-OAM between CSR and baseband.
- VR MBB: used for control plane traffic (VPN NG-C MBB) and MBB user plane traffic (VPN NG-U MBB), the control plane (VPN NG-C MBB) is applied for both MBB slice and Enterprise slice. One IP interface A2 is defined in the VR MBB, it is encapsulated in the VLAN of BH-MBB between CSR and baseband.
- VR ENT: used for Enterprise user plane traffic (VPN NG-U ENT), one IP interface A3 is defined in the VR ENT, it is encapsulated in the VLAN of BH-ENT between CSR and baseband.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 116   Logical Connectivity of Separate VPNs in CSR

Data packets are forwarded from CSR to aggregation router by using segment routing, following options can be applied:

- If Traffic Engineering is required, it is recommended to configure Segment Routing-Traffic Engineering (SR-TE) Label-Switched Paths (LSP) with PCE integrated within ENM. Path Computation Element (PCE) can supply label and next hop information to Path Computation Client (PCC) by using Path Computation Element Protocol (PCEP). LSP is set up or updated by PCC, and it defines the path for data packets.
- If no Traffic Engineering is required, Segment Routing with OSPF or IS-IS can be used.
- Static Segment Routing (SR-Static) can also be applied with manual configuration.

For more details about L3VPN over Segment Routing, see Segment Routing in Ericsson R6000 library.

The Same VPN Used for MBB Slice and ENT Slice in CSR

In the legacy configuration on CSR, usually two VRs are configured, one is for OAM traffic, the other is for RAN traffic. In this case, two VRs are set up on the CSR which is consistent with the legacy configuration, no need to create one new slice VR for simplicity. Figure 98 shows the logical connectivity that the same VPN applied in CSR.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 117   Logical Connectivity of the Same VPN in CSR

#### 4.11.2.3 IP Addressing

Below table summarizes the IP addressing design in the Baseband units.

The encapsulations are based on the VLAN subnet. Both IPv4 and IPv6 are supported. In this case, IPv4 is supported. The subnet mask needs to meet the minimal requirement of the number of IP addresses in the RAN site.

| VR   | IP Interface   | Type               | Address or Mask   | Description                                    |
|------|----------------|--------------------|-------------------|------------------------------------------------|
| OAM  | OAM            | VLAN Encapsulation | A1/30             | OAM of the CSR                                 |
| MBB  | MBB            | VLAN Encapsulation | A2/30             | User plane of MBB and control plane of MBB+ENT |
| ENT  | ENT            | VLAN Encapsulation | A3/30             | User plane of ENT                              |

#### 4.11.2.4 QoS

In MBB slice and Enterprise slice, the same 5QI and DSCP-mapping values are applied. Below Table shows the QoS setting for both slices. For details, refer to E2E QoS Guideline.

|   5QI Value | Resource Type   | QoS Mapping Method   |   DSCP Value | Description      |
|-------------|-----------------|----------------------|--------------|------------------|
|           7 | Non-GBR         | Default              |           10 | Streaming Video  |
|           8 | Non-GBR         | Default              |           12 | Internet service |
|           9 | Non-GBR         | Default              |           14 | Internet service |

#### 4.11.2.5 Application Traffic Flow

Below figure shows the application traffic flow, MBB slice, and ENT slice share control plane traffic of Xn-C and NG-C, but have separate user plane traffic of Xn-U and NG-U.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 118   Application Traffic Flow

### 4.11.3 NR EN-DC + SA Network Slicing Example: D-RAN with trusted
      Backhaul - Traffic Separation with Mapping between S-NSSAI and
      VLAN ID

An example of network slicing connectivity design is provided in this section. This design example considers two example network slices: MBB and IoT. To meet different SLAs of MBB slice and IoT slice, it is needed to separate the MBB traffic from IoT traffic in RAN, Transport, and Core domains. In this example, S-NSSAI is the traffic identified in RAN and Core domains, as defined in 3GPP, while the VLAN ID is used to be slice identified in transport domain. In this example, it assumes a purely NR SA network for simplicity.

#### 4.11.3.1 Physical Connectivity

Below figure depicts one example physical connectivity with slice traffic separation. It is a typical D-RAN case.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 119   Physical Connectivity with Slice Traffic Separation

The physical connectivity diagram is based on the following principles:

- Baseband NR is configured as coexistence of NR SA and NR NSA gNodeB.
- The eCPRI links are used between Baseband NR and AIR radios, CPRI links are used between Baseband LTE and LTE radios.
- GNSS synchronization is received in both Baseband LTE and NR for time and phase synchronization.
- The Baseband NR and LTE is connected to the CSR, which is responsible for traffic separation according to the VLAN IDs.

Below two tables show the port connections for Baseband NR and Baseband LTE units.

| Interface     | Connects To   |
|---------------|---------------|
| 10 GE TN port | CSR           |
| eCPRI         | AIR unit      |
| SYNC          | GNSS          |

| Interface     | Connects To   |
|---------------|---------------|
| 10 GE TN port | CSR           |
| CPRI          | LTE Radio     |

#### 4.11.3.2 Logical Connectivity

This case shows the coexistence of NR NSA and NR SA in the same gNodeB, the gNodeB can support NR EN-DC RAN slicing per SPID and NR SA RAN slicing per S-NSSAI simultaneously.

There are two connectivity options for traffic separation between NR NSA and NR SA, one is the traffic separation with dedicated VR, the other is traffic separation with shared VR:

- As logical connectivity 1 shown, traffic separation is done with dedicated VR: VR RAN is for legacy MBB traffic from both EN-DC and SA NR UEs, VR IoT is for new introduced SA IoT traffic flows. The traffic separation in RAN, Transport, and Core domains are used to meet different SLAs. S-NSSAI is the traffic identifier for SA traffic flows in RAN and Core domains, as defined in 3GPP, while the VLAN ID is used to be traffic identifier in transport domain.
- As logical connectivity 2 shown, traffic separation is done with shared VR but different IP version: in the RAN VR which is located in the coexisted NR NSA and NR SA gNodeB, one IPv4 interface is configured for NR NSA, the other IPv6 interface is configured for SA MBB and SA IOT.

For more details about RAN network slicing, refer to NR SA Network Slicing Guideline.

##### 4.11.3.2.1 Logical Connectivity 1

This case can be assumed when gNodeB is in NR NSA+SA MBB mode, one IP A3 is configured on the VR MBB SA+NSA for NSA+SA MBB traffic. Then SA IoT slice is introduced, IP A2 is configured on VR IOT.

Below figure describes the logical connectivity design for the slice traffic separation. Baseband NR maps the traffic to the IP/VLAN ID sets according to the configured associations between S-NSSAIs and IP interfaces. The CSR switches the traffic to different L2 VPN according to VLAN IDs. The L2 domain is terminated by the MBH GW, which is the IP gateway towards Core network and NMS applications.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 120   Logical Connectivity 1

In the Baseband NR, the following virtual routers are defined:

VR OAM The VR OAM is used for the management traffic of the Baseband, such as NETCONF and SNMP. One IP interface of OAM is defined in the VR OAM. This interface is encapsulated in the VLAN of BH-OAM between CSR and Baseband.

VR IOT The VR IOT is used for the following user plane traffic of the Network slice SNSSAI\_2:

- NG-U
- Xn-U

One IP interface A2 is defined in the VR IOT. This interface is encapsulated in the VLAN of BH-IOT between CSR and Baseband.

VR MBB SA+NSA On one hand, the VR MBB SA+NSA is used for the user plane traffic:

- NG-U for SA MBB
- Xn-U for SA MBB
- S1-U for NSA EN-DC
- EN-DC X2-U for NSA EN-DC

On the other hand, the VR MBB SA+NSA is also used for the control plane traffic:

- NG-C for SA MBB, SA IOT
- Xn-C for SA MBB, SA IOT
- EN-DC X2-C for NSA EN-DC

One IP interface A3 is defined in the VR MBB SA+NSA. This interface is encapsulated in the VLAN of BH-RAN between CSR and Baseband.

Below figure shows the related MOM configuration of slice traffic separation. For the control plane, the default reference method of EndpoinResource MO is used. For the SA IOT user plane, the dedicated reference method of EndpoinResource MO is used.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 121   MOM Structure of Logical Connectivity 1

##### 4.11.3.2.2 Logical Connectivity 2

Below figure describes the logical connectivity that NR NSA and NR SA are combined in the same RAN VR, this case can be seen as the NR SA deployed on the basis on NR NSA. When gNodeB is in NR NSA mode, one IPv4 IP address A2 is configured on VR RAN for NSA MBB only, when gNodeB migrated to coexistence of NR NSA(IPv4) and NR SA(IPv6) mode, one IPv6 IP address A3 is added on the same VR RAN, for both SA MBB and SA IOT traffic. In this example, as one IPv6 address is configured for both SA MBB and SA IOT slices, while in 5GC, there are two dedicated UPFs: UPF1 and UPF2 to handle MBB and IoT traffic respectively, as the result, two separate EP\_NgU MO can be still achievable for per slice observability.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 122   Logical Connectivity 2

In the coexisted NR NSA and NR SA Baseband NR, two VRs are defined:

VR OAM The VR OAM is used for the management traffic of the Baseband, such as NETCONF and SNMP. One IP interface of OAM is defined in the VR OAM. This interface is encapsulated in the VLAN of BH-OAM between CSR and Baseband.

VR RAN The VR RAN is used for the following user plane traffic:

- NG-U for SA MBB, SA IOT- IPv6
- Xn-U for SA MBB, SA IOT - IPv6
- S1-U for NSA EN-DC -IPv4
- EN-DC X2-U for NSA EN-DC -IPv4

The VR RAN is also used for the following control plane traffic:

- NG-C for SA MBB, SA IOT - IPv6
- Xn-C for SA MBB, SA IOT - IPv6
- EN-DC X2-C for NSA EN-DC - IPv4

Two IP interfaces A2 and A3 are defined in the RAN VR, IPv4 A2 and IPv6 A3 within the same RAN VR are encapsulated in the VLAN of BH-RAN between CSR and Baseband.

Below figure shows the MOM configuration for NR NSA and NR SA traffic combined in one VR.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 123   MOM Structure of Logical Connectivity 2

#### 4.11.3.3 IP Addressing

Below table summarizes the IP addressing design in the Baseband units for logical connectivity 1.

The encapsulations are based on the VLAN subnet. Both IPv4 and IPv6 are supported. In this case, IPv4 is supported. The subnet mask needs to meet the minimal requirement of the number of IP addresses in the RAN site.

| VR         | IP Interface   | Type               | Address or Mask   | Description                                                     |
|------------|----------------|--------------------|-------------------|-----------------------------------------------------------------|
| OAM        | OAM            | VLAN Encapsulation | A1/30             | OAM of the CSR                                                  |
| IOT        | IOT            | VLAN Encapsulation | A2/30             | User plane interface of IOT                                     |
| MBB SA+NSA | MBB            | VLAN Encapsulation | A3/30             | User plane of MBB and ENDC, Control plane of IOT, MBB and EN-DC |

Below table summarizes the IP addressing design in Baseband NR for Logical connectivity 2.

| VR   | IP Interface   | Type               | Address or Mask   | Description                             |
|------|----------------|--------------------|-------------------|-----------------------------------------|
| OAM  | OAM            | VLAN Encapsulation | A1/30             | OAM of the CSR                          |
| RAN  | ENDC-IPv4      | VLAN Encapsulation | A2/30             | User and control plane interface of NSA |
| RAN  | SA- IPv6       | VLAN Encapsulation | A3/64             | User and control plane interface of SA  |

#### 4.11.3.4 IP Routing

In this example design, VLAN-based L2 tunnel is used in MBH domain. The traffic of Baseband should be forwarded from/to the MBH gateway routers. For simplicity, the static routing protocol is used in the example. Static routing entries are configured in each virtual router of a Baseband unit.

Below table shows the routes configured in Baseband NR of logical connectivity 1.

| VR of the Baseband   | IP Network   | Next Hop      | Description   |
|----------------------|--------------|---------------|---------------|
| VR OAM               | 0/0          | B1 in the CSR | Default route |
| VR IOT               | 0/0          | B2 in the CSR | Default route |
| VR MBB SA+NSA        | 0/0          | B3 in the CSR | Default route |

Below table shows the routes configuration in coexisted NR NSA&amp; NR SA Baseband NR of Logical connectivity 2.

| VR of the Baseband   | IP Network   | Next Hop      | Description        |
|----------------------|--------------|---------------|--------------------|
| OAM VR               | 0/0          | B1 in the CSR | OAM Default route  |
| RAN VR               | 0/0          | B2 in the CSR | IPv4 Default route |
| RAN VR               | ::/0         | B3 in the CSR | IPv6 Default route |

#### 4.11.3.5 Application Flow

Below figure shows the traffic flow of slice traffic separation. Both slice 1 and slice 2 share the same control plane traffic flow of Xn-C and NG-C. Each slice has its own dedicated user plane traffic flow of Xn-U and NG-U. Only application flow of Logical connectivity 1 is shown for simplicity.

![Image](../images/339_22112-IPM10141_100Uen.BZ/additional_3_CP.png)

Figure 124   Application Flow of Slice Traffic Separation

# 5 Solution Guideline Change History

This section summarizes the major changes introducted in recent document release.

| Revision   | Main Changes                                                                                                                                                                        |
|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 25.Q1      | C-RAN and D-RAN example use cases with RAN processor 6672 added                                                                                                                     |
| 24.Q4      | Interface Latency Requirements are updated, multiple AMFs Deployment Updated                                                                                                        |
| 24.Q3      | Remove G2 Baseband related contents                                                                                                                                                 |
| 24.Q2      | Increased number of GTP-U connections in section 2. Addition of Router 6671 in section 3                                                                                            |
| 24.Q1      | New system limits updated in TN Configuration Limit topic in section 2. Configurable cellState Handling details updated in NR NSA and NR SA within the same Cell topic in section 2 |
| 23.Q4      | NG-C Connection Setup with AMF FQDN topic updated in section 2                                                                                                                      |
| 23.Q3      | NR Multiple TNLA topic updated in section 2. GTP-U supervision support for Xn interface added in section 2. Introducing Router 6676 in section 3                                    |
| 23.Q2      | Synchronization chapter updated in section 2                                                                                                                                        |
| 23.Q1      | TN Configuration Limit and Pdu size consideration topics added in section 2. Ospf connectivity solution example removal in section 4                                                |
| 22.Q4      | Xn Cardinality limit increase, GTP-U Supervision topic addded and Outgoing NR IRAT Handover feature updated in section 2. NR-DC+Direct IPsec for Xn overview added in section 4     |
| 22.Q3      | ANR for IRAT Mobility topic added in section 2. Example Design added for NR-NR(NR-DC)+EN-DC Scenario in section 4                                                                   |